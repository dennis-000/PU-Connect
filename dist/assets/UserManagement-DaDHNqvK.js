const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/arkesel-BIW7qUn3.js","assets/index-CcOhh2SE.js","assets/query-vendor-CC_3ftG1.js","assets/react-vendor-Bsfkyusf.js","assets/i18n-vendor-CQdsz7qV.js","assets/supabase-vendor-C3liu3n-.js","assets/index-1ug13H_y.css"])))=>i.map(i=>d[i]);
import{_ as he}from"./supabase-vendor-C3liu3n-.js";import{j as e}from"./query-vendor-CC_3ftG1.js";import{u as ge,r as n}from"./react-vendor-Bsfkyusf.js";import{u as je,s as x,N as ke,g as ve}from"./index-CcOhh2SE.js";import{a as we}from"./useConversations-g8fwN2cl.js";import"./i18n-vendor-CQdsz7qV.js";function Ue(){const U=ge(),{profile:v,loading:L}=je();n.useEffect(()=>{if(console.log("ðŸ›¡ï¸ UserManagement Component Mounted"),console.log("ðŸ‘¤ Current Profile:",v),!L&&v&&v.role!=="admin"&&v.role!=="super_admin"){console.warn("â›” Access Denied: User is not an admin. Role:",v.role),U("/dashboard");return}},[v,L,U]);const{mutate:Q}=we(),z=t=>{Q({otherUserId:t},{onSuccess:s=>{U(`/messages?conversationId=${s}`)},onError:()=>{alert("Failed to start conversation")}})},[h,w]=n.useState([]),[O,q]=n.useState(!0),[F,B]=n.useState(!1),[K,W]=n.useState(0),[X,Z]=n.useState(!0),[ee,M]=n.useState(0),_=20,[c,te]=n.useState(""),[u,se]=n.useState("all"),[H,S]=n.useState(null),[i,P]=n.useState(null),[ae,C]=n.useState(!1),[le,A]=n.useState(!1),[re,ne]=n.useState(new Set),[o,g]=n.useState({email:"",password:"",fullName:"",department:"",faculty:"",phone:"",role:"buyer"}),[r,N]=n.useState({full_name:"",role:"",department:"",faculty:"",student_id:"",phone:"",email:"",created_at:"",last_sign_in_at:""}),[D,y]=n.useState(!1),[ie,b]=n.useState(!1);n.useEffect(()=>{const t=setTimeout(()=>{E(0,!0),$()},400);return()=>clearTimeout(t)},[c,u]),n.useEffect(()=>{const t=x.channel("public:profiles").on("postgres_changes",{event:"*",schema:"public",table:"profiles"},()=>{$()}).subscribe(),s=x.channel("online-presence");return s.on("presence",{event:"sync"},()=>{const a=s.presenceState(),l=new Set;Object.values(a).flat().forEach(d=>{d.id&&l.add(d.id)}),ne(l)}).subscribe(),()=>{x.removeChannel(t),x.removeChannel(s)}},[]);const $=async()=>{const t=localStorage.getItem("sys_admin_bypass")==="true",s=localStorage.getItem("sys_admin_secret");try{if(t&&s){const{data:a,error:l}=await x.rpc("admin_get_profiles_count",{secret_key:s,p_search:c,p_role:u});!l&&a!==null&&M(a)}else{let a=x.from("profiles").select("*",{count:"exact",head:!0});u!=="all"&&(a=a.eq("role",u)),c&&(a=a.or(`full_name.ilike.%${c}%,email.ilike.%${c}%,student_id.ilike.%${c}%`));const{count:l,error:d}=await a;!d&&l!==null&&M(l)}}catch(a){console.error("Error fetching count:",a)}},oe=async t=>{const s=localStorage.getItem("sys_admin_bypass")==="true",a=localStorage.getItem("sys_admin_secret");if(s&&a){const{error:l}=await x.rpc("admin_hide_all_products",{target_user_id:t,secret_key:a});return{error:l}}return await x.from("products").update({is_active:!1}).eq("seller_id",t)},E=async(t=0,s=!1)=>{try{s?q(!0):B(!0);const a=localStorage.getItem("sys_admin_bypass")==="true",l=localStorage.getItem("sys_admin_secret");let d;if(a&&l)console.log("Using System Admin RPC for fetching users"),d=x.rpc("admin_get_profiles",{secret_key:l,p_limit:_,p_offset:t*_,p_search:c,p_role:u});else{let f=x.from("profiles").select("*").order("created_at",{ascending:!1});u!=="all"&&(f=f.eq("role",u)),c&&(f=f.or(`full_name.ilike.%${c}%,email.ilike.%${c}%,student_id.ilike.%${c}%`)),d=f.range(t*_,(t+1)*_-1)}const{data:p,error:j}=await d;if(j)throw j;w(s?p||[]:f=>[...f,...p||[]]),Z((p||[]).length===_),W(t)}catch(a){console.error("Error fetching users:",a),alert("Failed to load users. Please check your permissions.")}finally{q(!1),B(!1)}},de=()=>{!F&&X&&E(K+1)},R=async(t,s)=>{const a=localStorage.getItem("sys_admin_bypass")==="true",l=localStorage.getItem("sys_admin_secret");if(a&&l){console.log("Using System Admin RPC for update");const{data:d,error:p}=await x.rpc("admin_update_profile",{target_id:t,new_data:s,secret_key:l});return{error:p}}else return await x.from("profiles").update(s).eq("id",t)},ce=async(t,s)=>{w(h.map(a=>a.id===t?{...a,is_active:!s}:a)),i?.id===t&&P(a=>a?{...a,is_active:!s}:null);try{const{error:a}=await R(t,{is_active:!s});if(a)throw w(h.map(l=>l.id===t?{...l,is_active:s}:l)),a;await E(),S(null),alert(`User ${s?"suspended":"activated"} successfully`)}catch(a){console.error("Error updating user status:",a),alert(`Failed to update user status: ${a.message}`)}},V=async t=>{if(t===v?.id){alert("You cannot delete your own account.");return}if(!confirm("Are you sure you want to PERMANENTLY delete this user? This will remove their profile AND their authentication account, allowing them to sign up again if needed. This action cannot be undone."))return;const s=[...h];w(h.filter(a=>a.id!==t));try{const a=localStorage.getItem("sys_admin_bypass")==="true",l=localStorage.getItem("sys_admin_secret"),{data:d,error:p}=await x.rpc("admin_delete_user",{target_user_id:t,secret_key:a?l:null});if(p)throw p;if(d&&!d.success)throw new Error(d.error||"Failed to delete user");S(null),b(!0),setTimeout(()=>b(!1),3e3),M(j=>j-1)}catch(a){console.error("Error deleting user:",a),w(s),alert(`Failed to delete user: ${a.message||"System error."}`)}},xe=async t=>{t.preventDefault(),y(!0);try{const{data:s,error:a}=await x.functions.invoke("register-user",{body:o});if(a||!s?.success)throw new Error(a?.message||s?.error||"Failed to create account");if(o.role!=="buyer"){const{error:l}=await R(s.userId,{role:o.role});l&&console.error("Failed to update role:",l)}A(!1),g({email:"",password:"",fullName:"",department:"",faculty:"",phone:"",role:"buyer"}),b(!0),setTimeout(()=>b(!1),3e3),E(0,!0),$()}catch(s){console.error("Add User error:",s),alert(s.message||"Failed to create user. Check if Edge Functions are enabled.")}finally{y(!1)}},J=t=>{P(t),N({full_name:t.full_name,role:t.role,department:t.department||"",faculty:t.faculty||"",student_id:t.student_id||"",phone:t.phone||"",email:t.email,created_at:t.created_at,last_sign_in_at:t.last_sign_in_at||""}),C(!0),S(null)},ue=async t=>{if(window.confirm("This will deactivate all products listed by this user. Continue?")){y(!0);try{const{error:s}=await oe(t);if(s)throw s;b(!0),setTimeout(()=>b(!1),3e3),alert("All products for this user have been hidden")}catch(s){alert("Failed to hide products: "+s.message)}finally{y(!1)}}},me=async()=>{if(i){y(!0);try{w(h.map(s=>s.id===i.id?{...s,full_name:r.full_name,role:r.role,department:r.department,faculty:r.faculty,student_id:r.student_id,phone:r.phone}:s));const{error:t}=await R(i.id,{full_name:r.full_name,role:r.role,department:r.department,faculty:r.faculty,student_id:r.student_id,phone:r.phone});if(t)throw t;if(i.role!==r.role&&r.phone)try{const{sendSMS:s}=await he(async()=>{const{sendSMS:d}=await import("./arkesel-BIW7qUn3.js");return{sendSMS:d}},__vite__mapDeps([0,1,2,3,4,5,6])),l=`Hi ${(i.full_name||"User").split(" ")[0]}, your role on Campus Connect has been updated to "${r.role.replace("_"," ")}".`;await s([r.phone],l),b(!0)}catch(s){console.error("Failed to send role update SMS:",s),alert(`Role updated, but SMS failed: ${s.message||"Check Arkesel settings"}`)}E(0,!0),C(!1),P(null),b(!0),setTimeout(()=>b(!1),3e3)}catch(t){console.error("Error updating profile:",t),alert(`Failed to update user profile: ${t.message||"Permission denied"}`)}finally{y(!1)}}},[pe,T]=n.useState(!1),[m,Y]=n.useState({format:"csv",columns:{email:!0,full_name:!0,department:!0,faculty:!0,role:!0,status:!0,joined:!0,phone:!1}}),be=async()=>{let t=h;if(u!=="all"&&(t=h.filter(l=>l.role===u)),c&&(t=t.filter(l=>(l.email||"").toLowerCase().includes(c.toLowerCase())||(l.full_name||"").toLowerCase().includes(c.toLowerCase()))),t.length===0){alert("No data to export based on current filters.");return}const s=[],a=[];if(m.columns.full_name&&(s.push("Full Name"),a.push("full_name")),m.columns.email&&(s.push("Email"),a.push("email")),m.columns.phone&&(s.push("Phone"),a.push("phone")),m.columns.role&&(s.push("Role"),a.push("role")),m.columns.department&&(s.push("Department"),a.push("department")),m.columns.faculty&&(s.push("Faculty"),a.push("faculty")),m.columns.status&&(s.push("Status"),a.push("is_active")),m.columns.joined&&(s.push("Joined Date"),a.push("created_at")),m.format==="csv"){const l=[s.join(","),...t.map(f=>a.map(I=>{let k=f[I];return I==="created_at"&&(k=new Date(k).toLocaleDateString()),I==="is_active"&&(k=k?"Active":"Suspended"),k==null&&(k=""),`"${k}"`}).join(","))].join(`
`),d=new Blob([l],{type:"text/csv"}),p=window.URL.createObjectURL(d),j=document.createElement("a");j.href=p,j.download=`users_export_${new Date().toISOString().split("T")[0]}.csv`,j.click()}else alert("PDF Export is temporarily unavailable. Please use CSV export.");T(!1)},G=h,fe=t=>!t||!t.id?!1:re.has(t.id);return e.jsxs("div",{className:"min-h-screen bg-slate-50 dark:bg-slate-900 bg-african-pattern transition-colors duration-300 pb-20 font-sans relative overflow-hidden",children:[e.jsx(ke,{}),e.jsxs("div",{className:"pt-28 pb-12 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-end justify-between gap-6 mb-10",children:[e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center gap-2 mb-2",children:e.jsx("span",{className:"px-3 py-1 rounded-full bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 text-[10px] font-bold uppercase tracking-widest border border-blue-200 dark:border-blue-800",children:"System Admin"})}),e.jsx("h1",{className:"text-3xl md:text-5xl font-black text-slate-900 dark:text-white tracking-tight mb-2",children:"Users"}),e.jsxs("p",{className:"text-slate-500 dark:text-slate-400 font-medium",children:["Manage platform accounts, permissions, and view user details (",ee," total)"]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{onClick:()=>U("/admin/dashboard"),className:"px-5 py-2.5 bg-white dark:bg-slate-800 text-slate-700 dark:text-slate-200 border border-slate-200 dark:border-slate-700 rounded-xl text-xs font-bold uppercase tracking-wide hover:bg-slate-50 dark:hover:bg-slate-700 transition-colors shadow-sm cursor-pointer",children:[e.jsx("i",{className:"ri-arrow-left-line mr-2"}),"Dashboard"]}),e.jsxs("button",{onClick:()=>A(!0),className:"px-5 py-2.5 bg-slate-900 dark:bg-white text-white dark:text-slate-900 rounded-xl text-xs font-bold uppercase tracking-wide hover:shadow-xl transition-all cursor-pointer flex items-center gap-2",children:[e.jsx("i",{className:"ri-user-add-line text-lg"}),"Add User"]}),e.jsx("div",{className:"relative",children:e.jsxs("button",{onClick:()=>T(!0),className:"px-5 py-2.5 bg-white dark:bg-slate-800 text-slate-700 dark:text-slate-200 border border-slate-200 dark:border-slate-700 rounded-xl text-xs font-bold uppercase tracking-wide hover:bg-slate-50 dark:hover:bg-slate-700 transition-colors shadow-sm cursor-pointer flex items-center gap-2",children:[e.jsx("i",{className:"ri-download-line text-lg"}),"Export"]})})]})]}),pe&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-in fade-in duration-200",children:e.jsxs("div",{className:"bg-white dark:bg-slate-900 w-full max-w-lg rounded-3xl shadow-2xl p-8 border border-slate-100 dark:border-slate-800",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-black text-slate-900 dark:text-white",children:"Export Data"}),e.jsx("p",{className:"text-sm text-slate-500 font-medium",children:"Select columns and format"})]}),e.jsx("button",{onClick:()=>T(!1),className:"w-10 h-10 rounded-full bg-slate-100 dark:bg-slate-800 flex items-center justify-center text-slate-500 hover:bg-slate-200 transition-colors",children:e.jsx("i",{className:"ri-close-line text-xl"})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold uppercase tracking-wide text-slate-500 mb-3 block",children:"Columns to Include"}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:Object.entries(m.columns).map(([t,s])=>e.jsxs("label",{className:"flex items-center gap-3 p-3 rounded-xl border border-slate-100 dark:border-slate-800 hover:bg-slate-50 dark:hover:bg-slate-800 transition-colors cursor-pointer select-none",children:[e.jsx("div",{className:`w-5 h-5 rounded-md border-2 flex items-center justify-center ${s?"bg-blue-600 border-blue-600 text-white":"border-slate-300 dark:border-slate-600"}`,children:s&&e.jsx("i",{className:"ri-check-line"})}),e.jsx("input",{type:"checkbox",className:"hidden",checked:s,onChange:()=>Y(a=>({...a,columns:{...a.columns,[t]:!s}}))}),e.jsx("span",{className:"text-sm font-bold text-slate-700 dark:text-slate-300 capitalize",children:t.replace("_"," ")})]},t))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold uppercase tracking-wide text-slate-500 mb-3 block",children:"Export Format"}),e.jsx("div",{className:"flex gap-4",children:["csv","pdf"].map(t=>e.jsxs("button",{onClick:()=>Y(s=>({...s,format:t})),className:`flex-1 p-4 rounded-xl border-2 font-bold uppercase tracking-widest text-xs transition-all flex items-center justify-center gap-2 ${m.format===t?"border-blue-600 bg-blue-50 dark:bg-blue-900/20 text-blue-600":"border-slate-100 dark:border-slate-800 text-slate-400 hover:border-slate-300"}`,children:[e.jsx("i",{className:t==="csv"?"ri-file-excel-2-line text-lg":"ri-file-pdf-line text-lg"}),t]},t))})]}),e.jsx("div",{className:"pt-4",children:e.jsx("button",{onClick:be,className:"w-full py-4 bg-slate-900 dark:bg-white text-white dark:text-slate-900 rounded-xl font-black uppercase tracking-widest text-sm hover:scale-[1.02] active:scale-95 transition-all shadow-xl",children:"Download Export"})})]})]})}),e.jsx("div",{className:"bg-white dark:bg-slate-800 rounded-2xl p-6 mb-8 border border-slate-100 dark:border-slate-700 shadow-sm",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("i",{className:"ri-search-line absolute left-4 top-1/2 -translate-y-1/2 text-slate-400"}),e.jsx("input",{type:"text",value:c,onChange:t=>te(t.target.value),placeholder:"Search users by name, email, or ID...",className:"w-full pl-11 pr-4 py-3 bg-slate-50 dark:bg-slate-900 border-none rounded-xl focus:ring-2 focus:ring-blue-500/20 font-medium text-sm text-slate-900 dark:text-white outline-none"})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:u,onChange:t=>se(t.target.value),className:"w-full pl-4 pr-10 py-3 bg-slate-50 dark:bg-slate-900 border-none rounded-xl focus:ring-2 focus:ring-blue-500/20 font-medium text-sm text-slate-900 dark:text-white outline-none appearance-none cursor-pointer",children:[e.jsx("option",{value:"all",children:"All Roles"}),e.jsx("option",{value:"buyer",children:"Buyers"}),e.jsx("option",{value:"seller",children:"Sellers"}),e.jsx("option",{value:"publisher_seller",children:"Publisher & Seller"}),e.jsx("option",{value:"admin",children:"Admins"})]}),e.jsx("i",{className:"ri-filter-3-line absolute right-4 top-1/2 -translate-y-1/2 text-slate-400 pointer-events-none"})]})]})}),e.jsx("div",{className:"bg-white dark:bg-slate-800 rounded-[2rem] border border-slate-100 dark:border-slate-700 shadow-sm overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-slate-50/50 dark:bg-slate-800/50 border-b border-slate-100 dark:border-slate-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-8 py-5 text-left text-[10px] font-bold text-slate-400 uppercase tracking-widest leading-relaxed",children:"User Profile"}),e.jsx("th",{className:"px-8 py-5 text-left text-[10px] font-bold text-slate-400 uppercase tracking-widest leading-relaxed",children:"Status"}),e.jsx("th",{className:"px-8 py-5 text-left text-[10px] font-bold text-slate-400 uppercase tracking-widest leading-relaxed",children:"Role"}),e.jsx("th",{className:"px-8 py-5 text-right text-[10px] font-bold text-slate-400 uppercase tracking-widest leading-relaxed",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100 dark:divide-slate-700",children:G.length===0&&!O?e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"px-8 py-20 text-center text-slate-500 font-medium",children:"No users found matching your filters."})}):O?e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"px-8 py-20 text-center",children:e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx("i",{className:"ri-loader-4-line text-4xl text-blue-500 animate-spin"}),e.jsx("span",{className:"text-sm font-bold text-slate-400 uppercase tracking-widest",children:"Hydrating User Data..."})]})})}):e.jsxs(e.Fragment,{children:[G.map(t=>{if(!t||!t.id)return null;const s=fe(t),a=t.full_name||"Unnamed User",l=t.email||"No email";return e.jsxs("tr",{className:"hover:bg-slate-50/50 dark:hover:bg-slate-700/30 transition-colors",children:[e.jsx("td",{className:"px-8 py-4",children:e.jsxs("div",{className:"flex items-center gap-4 cursor-pointer",onClick:()=>J(t),children:[e.jsxs("div",{className:"relative",children:[t.avatar_url?e.jsx("img",{src:t.avatar_url,alt:"",className:"w-10 h-10 rounded-xl object-cover border border-slate-100 dark:border-slate-700"}):e.jsxs("div",{className:"w-10 h-10 bg-slate-100 dark:bg-slate-700 rounded-xl flex items-center justify-center font-bold text-slate-500 dark:text-slate-400 relative overflow-hidden",children:[e.jsx("i",{className:"ri-user-3-fill absolute text-3xl opacity-10 translate-y-1"}),e.jsx("span",{className:"relative z-10",children:a.charAt(0).toUpperCase()})]}),s&&e.jsx("span",{className:"absolute -bottom-1 -right-1 w-3 h-3 bg-emerald-500 border-2 border-white dark:border-slate-800 rounded-full"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-sm text-slate-900 dark:text-white",children:a}),e.jsx("div",{className:"text-xs text-slate-500",children:l})]})]})}),e.jsx("td",{className:"px-8 py-4",children:e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsxs("span",{className:`inline-flex items-center gap-1.5 px-2 py-0.5 rounded text-[10px] font-bold uppercase tracking-wide w-fit ${t.is_active?"bg-emerald-100 text-emerald-700":"bg-rose-100 text-rose-700"}`,children:[e.jsx("span",{className:`w-1.5 h-1.5 rounded-full ${t.is_active?"bg-emerald-500":"bg-rose-500"}`}),t.is_active?"Active":"Suspended"]}),e.jsx("span",{className:"text-[10px] text-slate-400 font-medium",children:s?"Online Now":"Offline"})]})}),e.jsx("td",{className:"px-8 py-4",children:e.jsx("span",{className:"px-2 py-1 bg-slate-100 dark:bg-slate-700 text-slate-600 dark:text-slate-300 rounded text-[10px] font-bold uppercase tracking-wider border border-slate-200 dark:border-slate-600",children:t.role})}),e.jsxs("td",{className:"px-8 py-4 text-right",children:[e.jsx("button",{onClick:()=>S(H===t.id?null:t.id),className:"p-2 text-slate-400 hover:text-blue-600 transition-colors",children:e.jsx("i",{className:"ri-more-2-fill text-xl"})}),H===t.id&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>S(null)}),e.jsxs("div",{className:"absolute right-8 mt-2 w-48 bg-white dark:bg-slate-800 shadow-xl rounded-xl z-20 border border-slate-100 dark:border-slate-700 py-1 text-left",children:[e.jsx("button",{onClick:()=>z(t.id),className:"block w-full text-left px-4 py-2 text-xs font-bold text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-900/20",children:"Message User"}),e.jsx("button",{onClick:()=>J(t),className:"block w-full text-left px-4 py-2 text-xs font-bold text-slate-700 dark:text-slate-200 hover:bg-slate-50 dark:hover:bg-slate-700",children:"View Details / Edit"}),e.jsx("button",{onClick:()=>V(t.id),className:"block w-full text-left px-4 py-2 text-xs font-bold text-rose-600 hover:bg-rose-50 dark:hover:bg-rose-900/20",children:"Delete User"})]})]})]})]},t.id)}),X&&c===""&&u==="all"&&e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"px-8 py-8 text-center",children:e.jsx("button",{onClick:de,disabled:F,className:"px-6 py-2 bg-slate-100 dark:bg-slate-700 text-slate-600 dark:text-slate-300 rounded-xl font-bold text-xs uppercase tracking-widest hover:bg-slate-200 transition-all disabled:opacity-50",children:F?e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("i",{className:"ri-loader-4-line animate-spin"}),"Loading..."]}):"Load More Users"})})})]})})]})})})]}),ae&&i&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-in fade-in duration-200",children:e.jsxs("div",{className:"bg-white dark:bg-slate-900 w-full max-w-2xl rounded-3xl shadow-2xl max-h-[90vh] overflow-y-auto outline-none border border-slate-100 dark:border-slate-800 flex flex-col",children:[e.jsxs("div",{className:"px-8 py-6 border-b border-slate-100 dark:border-slate-800 flex items-center justify-between sticky top-0 bg-white/95 dark:bg-slate-900/95 backdrop-blur z-10",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-black text-slate-900 dark:text-white tracking-tight",children:"User Details"}),e.jsx("p",{className:"text-sm text-slate-500 font-medium",children:"View and manage user profile information"})]}),e.jsx("button",{onClick:()=>C(!1),className:"w-10 h-10 rounded-full bg-slate-100 dark:bg-slate-800 flex items-center justify-center text-slate-500 hover:bg-slate-200 transition-colors",children:e.jsx("i",{className:"ri-close-line text-xl"})})]}),e.jsxs("div",{className:"p-8 space-y-8",children:[e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-950 rounded-2xl p-6 border border-slate-100 dark:border-slate-800 flex flex-col sm:flex-row gap-6 items-center sm:items-start",children:[e.jsx("div",{className:"w-20 h-20 rounded-2xl bg-white dark:bg-slate-800 shadow-sm flex items-center justify-center text-3xl font-bold text-slate-300 uppercase shrink-0 relative overflow-hidden",children:i.avatar_url?e.jsx("img",{src:ve(i.avatar_url,160,160),alt:"",className:"w-full h-full object-cover"}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"ri-user-3-fill absolute text-[8rem] opacity-5 translate-y-4"}),e.jsx("span",{className:"relative z-10 text-slate-400",children:(r.full_name||"U").charAt(0)})]})}),e.jsx("div",{className:"flex-1 text-center sm:text-left space-y-2 w-full",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] uppercase font-bold text-slate-400",children:"User ID"}),e.jsx("p",{className:"text-xs font-mono text-slate-600 dark:text-slate-300 truncate w-full",title:i.id,children:i.id})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] uppercase font-bold text-slate-400",children:"Email Address"}),e.jsx("p",{className:"text-sm font-bold text-slate-900 dark:text-white truncate",children:r.email})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] uppercase font-bold text-slate-400",children:"Joined On"}),e.jsx("p",{className:"text-sm font-medium text-slate-600 dark:text-slate-300",children:new Date(r.created_at).toLocaleDateString()})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] uppercase font-bold text-slate-400",children:"Status"}),e.jsx("span",{className:`inline-flex px-2 py-0.5 rounded text-[10px] font-bold uppercase tracking-wide ${i.is_active?"bg-emerald-100 text-emerald-700":"bg-rose-100 text-rose-700"}`,children:i.is_active?"Active":"Suspended"})]})]})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("h4",{className:"text-sm font-black text-slate-900 dark:text-white uppercase tracking-widest border-b border-slate-100 dark:border-slate-800 pb-2",children:"Profile Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold uppercase tracking-wide text-slate-500 mb-2 block",children:"Full Name"}),e.jsx("input",{type:"text",value:r.full_name,onChange:t=>N({...r,full_name:t.target.value}),className:"w-full px-4 py-3 bg-slate-50 dark:bg-slate-800 rounded-xl border-none focus:ring-2 focus:ring-blue-500/50 outline-none font-medium"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold uppercase tracking-wide text-slate-500 mb-2 block",children:"Phone Number"}),e.jsx("input",{type:"tel",value:r.phone,onChange:t=>N({...r,phone:t.target.value}),className:"w-full px-4 py-3 bg-slate-50 dark:bg-slate-800 rounded-xl border-none focus:ring-2 focus:ring-blue-500/50 outline-none font-medium"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold uppercase tracking-wide text-slate-500 mb-2 block",children:"Student ID"}),e.jsx("input",{type:"text",value:r.student_id,onChange:t=>N({...r,student_id:t.target.value}),className:"w-full px-4 py-3 bg-slate-50 dark:bg-slate-800 rounded-xl border-none focus:ring-2 focus:ring-blue-500/50 outline-none font-medium"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold uppercase tracking-wide text-slate-500 mb-2 block",children:"Department"}),e.jsx("input",{type:"text",value:r.department,onChange:t=>N({...r,department:t.target.value}),className:"w-full px-4 py-3 bg-slate-50 dark:bg-slate-800 rounded-xl border-none focus:ring-2 focus:ring-blue-500/50 outline-none font-medium"})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-black text-slate-900 dark:text-white uppercase tracking-widest border-b border-slate-100 dark:border-slate-800 pb-2 mb-4",children:"Role Assignment"}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-3",children:["buyer","seller","news_publisher","publisher_seller","admin"].map(t=>e.jsxs("div",{onClick:()=>N({...r,role:t}),className:`cursor-pointer px-4 py-3 rounded-xl border-2 transition-all flex flex-col items-center justify-center gap-2 text-center ${r.role===t?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-slate-100 dark:border-slate-800 hover:border-slate-300"}`,children:[e.jsx("div",{className:`w-5 h-5 rounded-full border-2 flex items-center justify-center ${r.role===t?"border-blue-500":"border-slate-300"}`,children:r.role===t&&e.jsx("div",{className:"w-2.5 h-2.5 rounded-full bg-blue-500"})}),e.jsx("span",{className:"text-xs font-bold text-slate-700 dark:text-slate-200 capitalize",children:t.replace("_"," ")})]},t))})]}),e.jsxs("div",{className:"space-y-6 pt-6 border-t border-slate-100 dark:border-slate-800",children:[e.jsxs("h4",{className:"text-sm font-black text-slate-900 dark:text-white uppercase tracking-widest flex items-center gap-2",children:[e.jsx("i",{className:"ri-shield-flash-line text-rose-500"}),"Account Management"]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("button",{onClick:()=>z(i.id),className:"flex items-center justify-center gap-3 p-5 rounded-2xl border-2 border-blue-100 bg-blue-50 text-blue-700 hover:bg-blue-100 dark:bg-blue-900/10 dark:border-blue-900/20 transition-all font-bold text-xs uppercase tracking-widest active:scale-95",children:[e.jsx("i",{className:"ri-chat-3-line text-lg"}),"Send Message"]}),e.jsxs("button",{onClick:()=>ce(i.id,i.is_active),className:`flex items-center justify-center gap-3 p-5 rounded-2xl border-2 transition-all font-bold text-xs uppercase tracking-widest active:scale-95 ${i.is_active?"border-amber-100 bg-amber-50 text-amber-700 hover:bg-amber-100 dark:bg-amber-900/10 dark:border-amber-900/20":"border-emerald-100 bg-emerald-50 text-emerald-700 hover:bg-emerald-100 dark:bg-emerald-900/10 dark:border-emerald-900/20"}`,children:[e.jsx("i",{className:i.is_active?"ri-user-forbid-line text-lg":"ri-user-follow-line text-lg"}),i.is_active?"Suspend Account":"Activate Account"]}),e.jsxs("button",{onClick:()=>ue(i.id),className:"flex items-center justify-center gap-3 p-5 rounded-2xl border-2 border-slate-100 bg-slate-50 text-slate-700 hover:bg-slate-100 dark:bg-slate-800 dark:border-slate-700 dark:text-slate-200 transition-all font-bold text-xs uppercase tracking-widest active:scale-95",children:[e.jsx("i",{className:"ri-eye-off-line text-lg"}),"Hide products"]}),e.jsxs("button",{onClick:async()=>{await V(i.id),C(!1)},className:"flex items-center justify-center gap-3 p-5 rounded-2xl border-2 border-rose-100 bg-rose-50 text-rose-700 hover:bg-rose-100 dark:bg-rose-900/10 dark:border-rose-900/20 transition-all font-bold text-xs uppercase tracking-widest active:scale-95",children:[e.jsx("i",{className:"ri-delete-bin-line text-lg"}),"Delete Profile"]})]}),e.jsxs("p",{className:"text-[10px] text-slate-400 font-bold uppercase tracking-widest leading-relaxed px-1",children:[e.jsx("i",{className:"ri-information-line mr-1 text-blue-500"}),"Suspending blocks access while keeping data. Deleting permanently removes the profile."]})]})]}),e.jsxs("div",{className:"p-6 border-t border-slate-100 dark:border-slate-800 flex gap-4 sticky bottom-0 bg-white dark:bg-slate-900 z-10",children:[e.jsx("button",{onClick:()=>C(!1),className:"flex-1 py-4 bg-slate-100 dark:bg-slate-800 text-slate-700 dark:text-slate-300 font-bold rounded-xl hover:bg-slate-200 transition-colors uppercase tracking-widest text-xs",children:"Cancel"}),e.jsxs("button",{onClick:me,disabled:D,className:"flex-[2] py-4 bg-slate-900 dark:bg-white text-white dark:text-slate-900 font-bold rounded-xl hover:shadow-lg transition-all flex items-center justify-center gap-2 uppercase tracking-widest text-xs",children:[D?e.jsx("i",{className:"ri-loader-4-line animate-spin"}):e.jsx("i",{className:"ri-save-line"}),"Save Changes"]})]})]})}),le&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-in fade-in duration-200",children:e.jsxs("div",{className:"bg-white dark:bg-slate-900 w-full max-w-2xl rounded-3xl shadow-2xl max-h-[90vh] overflow-y-auto outline-none border border-slate-100 dark:border-slate-800 flex flex-col",children:[e.jsxs("div",{className:"px-8 py-6 border-b border-slate-100 dark:border-slate-800 flex items-center justify-between sticky top-0 bg-white/95 dark:bg-slate-900/95 backdrop-blur z-10",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-black text-slate-900 dark:text-white tracking-tight",children:"Create User"}),e.jsx("p",{className:"text-sm text-slate-500 font-medium",children:"Add a new user to the platform (Auto-confirm email)"})]}),e.jsx("button",{onClick:()=>A(!1),className:"w-10 h-10 rounded-full bg-slate-100 dark:bg-slate-800 flex items-center justify-center text-slate-500 hover:bg-slate-200 transition-colors",children:e.jsx("i",{className:"ri-close-line text-xl"})})]}),e.jsxs("form",{onSubmit:xe,className:"p-8 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold uppercase tracking-wide text-slate-500 mb-2 block",children:"Full Name"}),e.jsx("input",{required:!0,type:"text",value:o.fullName,onChange:t=>g({...o,fullName:t.target.value}),className:"w-full px-4 py-3 bg-slate-50 dark:bg-slate-800 rounded-xl border-none focus:ring-2 focus:ring-blue-500/50 outline-none font-medium",placeholder:"John Doe"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold uppercase tracking-wide text-slate-500 mb-2 block",children:"Email Address"}),e.jsx("input",{required:!0,type:"email",value:o.email,onChange:t=>g({...o,email:t.target.value}),className:"w-full px-4 py-3 bg-slate-50 dark:bg-slate-800 rounded-xl border-none focus:ring-2 focus:ring-blue-500/50 outline-none font-medium",placeholder:"user@example.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold uppercase tracking-wide text-slate-500 mb-2 block",children:"Password"}),e.jsx("input",{required:!0,type:"password",value:o.password,onChange:t=>g({...o,password:t.target.value}),className:"w-full px-4 py-3 bg-slate-50 dark:bg-slate-800 rounded-xl border-none focus:ring-2 focus:ring-blue-500/50 outline-none font-medium",placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold uppercase tracking-wide text-slate-500 mb-2 block",children:"Phone Number"}),e.jsx("input",{required:!0,type:"tel",value:o.phone,onChange:t=>g({...o,phone:t.target.value}),className:"w-full px-4 py-3 bg-slate-50 dark:bg-slate-800 rounded-xl border-none focus:ring-2 focus:ring-blue-500/50 outline-none font-medium",placeholder:"024XXXXXXX"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold uppercase tracking-wide text-slate-500 mb-2 block",children:"Faculty"}),e.jsxs("select",{required:!0,value:o.faculty,onChange:t=>g({...o,faculty:t.target.value}),className:"w-full px-4 py-3 bg-slate-50 dark:bg-slate-800 rounded-xl border-none focus:ring-2 focus:ring-blue-500/50 outline-none font-medium",children:[e.jsx("option",{value:"",children:"Select Faculty"}),e.jsx("option",{value:"Faculty of Business",children:"Faculty of Business"}),e.jsx("option",{value:"Faculty of Science & Computing",children:"Faculty of Science & Computing"}),e.jsx("option",{value:"Faculty of Nursing & Midwifery",children:"Faculty of Nursing & Midwifery"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold uppercase tracking-wide text-slate-500 mb-2 block",children:"Department"}),e.jsx("input",{type:"text",value:o.department,onChange:t=>g({...o,department:t.target.value}),className:"w-full px-4 py-3 bg-slate-50 dark:bg-slate-800 rounded-xl border-none focus:ring-2 focus:ring-blue-500/50 outline-none font-medium",placeholder:"e.g. IT"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold uppercase tracking-wide text-slate-500 mb-4 block",children:"Initial Role"}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3",children:["buyer","seller","admin","news_publisher"].map(t=>e.jsx("div",{onClick:()=>g({...o,role:t}),className:`cursor-pointer px-4 py-3 rounded-xl border-2 transition-all flex flex-col items-center justify-center gap-2 text-center ${o.role===t?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-slate-100 dark:border-slate-800"}`,children:e.jsx("span",{className:"text-xs font-bold text-slate-700 dark:text-slate-200 capitalize",children:t.replace("_"," ")})},t))})]}),e.jsxs("div",{className:"pt-6 flex gap-4",children:[e.jsx("button",{type:"button",onClick:()=>A(!1),className:"flex-1 py-4 bg-slate-100 dark:bg-slate-800 text-slate-700 dark:text-slate-300 font-bold rounded-xl hover:bg-slate-200 transition-colors uppercase tracking-widest text-xs",children:"Cancel"}),e.jsxs("button",{type:"submit",disabled:D,className:"flex-[2] py-4 bg-slate-900 dark:bg-white text-white dark:text-slate-900 font-bold rounded-xl hover:shadow-lg transition-all flex items-center justify-center gap-2 uppercase tracking-widest text-xs",children:[D?e.jsx("i",{className:"ri-loader-4-line animate-spin text-lg"}):e.jsx("i",{className:"ri-user-add-line text-lg"}),"Create User Account"]})]})]})]})}),ie&&e.jsxs("div",{className:"fixed top-24 right-4 z-50 animate-bounce px-6 py-4 rounded-2xl bg-emerald-500 text-white shadow-xl flex items-center gap-3",children:[e.jsx("i",{className:"ri-checkbox-circle-fill text-xl"}),e.jsx("span",{className:"font-bold",children:"Profile Updated!"})]})]})}export{Ue as default};
//# sourceMappingURL=UserManagement-DaDHNqvK.js.map

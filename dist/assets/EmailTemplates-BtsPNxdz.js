import{j as t}from"./query-vendor-CC_3ftG1.js";import{u as K,r as f}from"./react-vendor-Bsfkyusf.js";import{u as M,N as V,s as S}from"./index-BpkOjQCb.js";import"./i18n-vendor-CQdsz7qV.js";import"./supabase-vendor-C3liu3n-.js";class v{constructor(s=0,r="Network Error"){this.status=s,this.text=r}}const D=()=>{if(!(typeof localStorage>"u"))return{get:e=>Promise.resolve(localStorage.getItem(e)),set:(e,s)=>Promise.resolve(localStorage.setItem(e,s)),remove:e=>Promise.resolve(localStorage.removeItem(e))}},i={origin:"https://api.emailjs.com",blockHeadless:!1,storageProvider:D()},T=e=>e?typeof e=="string"?{publicKey:e}:e.toString()==="[object Object]"?e:{}:{},q=(e,s="https://api.emailjs.com")=>{if(!e)return;const r=T(e);i.publicKey=r.publicKey,i.blockHeadless=r.blockHeadless,i.storageProvider=r.storageProvider,i.blockList=r.blockList,i.limitRate=r.limitRate,i.origin=r.origin||s},E=async(e,s,r={})=>{const n=await fetch(i.origin+e,{method:"POST",headers:r,body:s}),o=await n.text(),d=new v(n.status,o);if(n.ok)return d;throw d},P=(e,s,r)=>{if(!e||typeof e!="string")throw"The public key is required. Visit https://dashboard.emailjs.com/admin/account";if(!s||typeof s!="string")throw"The service ID is required. Visit https://dashboard.emailjs.com/admin";if(!r||typeof r!="string")throw"The template ID is required. Visit https://dashboard.emailjs.com/admin/templates"},Y=e=>{if(e&&e.toString()!=="[object Object]")throw"The template params have to be the object. Visit https://www.emailjs.com/docs/sdk/send/"},R=e=>e.webdriver||!e.languages||e.languages.length===0,B=()=>new v(451,"Unavailable For Headless Browser"),$=(e,s)=>{if(!Array.isArray(e))throw"The BlockList list has to be an array";if(typeof s!="string")throw"The BlockList watchVariable has to be a string"},J=e=>!e.list?.length||!e.watchVariable,W=(e,s)=>e instanceof FormData?e.get(s):e[s],H=(e,s)=>{if(J(e))return!1;$(e.list,e.watchVariable);const r=W(s,e.watchVariable);return typeof r!="string"?!1:e.list.includes(r)},U=()=>new v(403,"Forbidden"),z=(e,s)=>{if(typeof e!="number"||e<0)throw"The LimitRate throttle has to be a positive number";if(s&&typeof s!="string")throw"The LimitRate ID has to be a non-empty string"},G=async(e,s,r)=>{const n=Number(await r.get(e)||0);return s-Date.now()+n},I=async(e,s,r)=>{if(!s.throttle||!r)return!1;z(s.throttle,s.id);const n=s.id||e;return await G(n,s.throttle,r)>0?!0:(await r.set(n,Date.now().toString()),!1)},A=()=>new v(429,"Too Many Requests"),Q=async(e,s,r,n)=>{const o=T(n),d=o.publicKey||i.publicKey,u=o.blockHeadless||i.blockHeadless,c=o.storageProvider||i.storageProvider,y={...i.blockList,...o.blockList},h={...i.limitRate,...o.limitRate};return u&&R(navigator)?Promise.reject(B()):(P(d,e,s),Y(r),r&&H(y,r)?Promise.reject(U()):await I(location.pathname,h,c)?Promise.reject(A()):E("/api/v1.0/email/send",JSON.stringify({lib_version:"4.4.1",user_id:d,service_id:e,template_id:s,template_params:r}),{"Content-type":"application/json"}))},X=e=>{if(!e||e.nodeName!=="FORM")throw"The 3rd parameter is expected to be the HTML form element or the style selector of the form"},Z=e=>typeof e=="string"?document.querySelector(e):e,ee=async(e,s,r,n)=>{const o=T(n),d=o.publicKey||i.publicKey,u=o.blockHeadless||i.blockHeadless,c=i.storageProvider||o.storageProvider,y={...i.blockList,...o.blockList},h={...i.limitRate,...o.limitRate};if(u&&R(navigator))return Promise.reject(B());const w=Z(r);P(d,e,s),X(w);const a=new FormData(w);return H(y,a)?Promise.reject(U()):await I(location.pathname,h,c)?Promise.reject(A()):(a.append("lib_version","4.4.1"),a.append("service_id",e),a.append("template_id",s),a.append("user_id",d),E("/api/v1.0/email/send-form",a))},te={init:q,send:Q,sendForm:ee,EmailJSResponseStatus:v},se="service_rhy606j",ae="template_campus_connect",L="YOUR_PUBLIC_KEY",re=async e=>{try{if(L==="YOUR_PUBLIC_KEY")return console.warn("âš ï¸ EmailJS keys not configured in src/lib/email.ts"),console.log("ðŸ“§ SIMULATED EMAIL SEND:",e),await new Promise(n=>setTimeout(n,1500)),{status:200,text:"Simulated OK"};const s={to_email:e.to_email,to_name:e.to_name||"User",from_name:"Campus Connect",subject:e.subject,heading:e.heading,message:e.body,cta_text:e.cta_text,cta_link:e.cta_link,image_url:e.image_url,reply_to:"support@pentvars.edu.gh"};return await te.send(se,ae,s,L)}catch(s){throw console.error("Email Send Error:",s),s}};function de(){const{profile:e}=M();K();const[s,r]=f.useState("breaking_news"),[n,o]=f.useState(!1),[d,u]=f.useState(!1),[c,y]=f.useState("me"),[h,w]=f.useState("");f.useEffect(()=>{e?.email&&w(e.email)},[e]);const[a,k]=f.useState({subject:"Breaking News: Campus Connect Launch! ðŸš€",preheader:"You don't want to miss this update...",heading:"Big Things Are Happening",body:"We are excited to announce major updates to the platform. Students can now trade faster, safer, and easier than ever before. Login today to see what is new!",ctaText:"Check it Out",ctaLink:"https://campusconnect.com/login",imageUrl:"https://images.unsplash.com/photo-1523240795612-9a054b0db644?auto=format&fit=crop&w=800&q=80"}),F=f.useMemo(()=>({breaking_news:{id:"breaking_news",name:"Breaking News",description:"Urgent announcements and major updates.",generateHtml:l=>"..."},general_blast:{id:"general_blast",name:"General Blast",description:"Standard newsletter for varied content.",generateHtml:l=>"..."},welcome:{id:"welcome",name:"Welcome Series",description:"Onboarding email for new users.",generateHtml:l=>"..."}}),[a]),O=async()=>{F[s];let l=0,j=[];if(c==="me"){if(!h){alert("Please enter a test email.");return}j=[h],l=1}else{if(!confirm(`âš ï¸ CAUTION: You are about to send this email to ${c.toUpperCase()} users. Reliable delivery requires a verified domain. Continue?`))return;u(!0);try{const p=localStorage.getItem("sys_admin_bypass")==="true",N=localStorage.getItem("sys_admin_secret")||"pentvars-sys-admin-x892";let m=[];if(c==="subscribers")if(p){const{data:b,error:x}=await S.rpc("sys_get_subs_list",{secret_key:N});if(x)throw x;m=b.map(g=>g.email)}else{const{data:b,error:x}=await S.from("newsletter_subscribers").select("email").eq("is_active",!0);if(x)throw x;m=b.map(g=>g.email)}else if(p){const b=c==="sellers"?"sellers":null,{data:x,error:g}=await S.rpc("sys_get_profiles_emails",{secret_key:N,role_filter:b});if(g)throw g;m=x.map(C=>C.email)}else{let b=S.from("profiles").select("email");c==="sellers"&&(b=b.in("role",["seller","publisher_seller"]));const{data:x,error:g}=await b;if(g)throw g;m=x?.map(C=>C.email)||[]}if(m.length===0){alert("No recipients found."),u(!1);return}const _=20;if(m.length>_){if(!confirm(`Audience size (${m.length}) exceeds browser safety limit (${_}). Sending to first ${_} only?`)){u(!1);return}j=m.slice(0,_).filter(Boolean)}else j=m.filter(Boolean);l=j.length}catch(p){console.error(p),alert("Failed to fetch recipients."),u(!1);return}}u(!0);try{let p=0;for(const N of j)await re({to_email:N,subject:a.subject,heading:a.heading,body:a.body,cta_text:a.ctaText,cta_link:a.ctaLink,image_url:a.imageUrl}),p++,await new Promise(m=>setTimeout(m,500));alert(`âœ… Campaign sent successfully to ${p} recipients from "Campus Connect"!`)}catch(p){console.error(p),alert("Failed to send campaign. Please check console to configure EmailJS keys.")}finally{u(!1)}};return t.jsxs("div",{className:"min-h-screen bg-slate-50 dark:bg-slate-900 transition-colors duration-300 pb-20 font-sans",children:[t.jsx(V,{}),t.jsxs("div",{className:"pt-32 md:pt-40 pb-12 box-border max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[t.jsx("div",{className:"flex flex-col md:flex-row md:items-end justify-between gap-6 mb-10",children:t.jsxs("div",{children:[t.jsx("div",{className:"flex items-center gap-2 mb-2",children:t.jsx("span",{className:"px-3 py-1 rounded-full bg-indigo-100 dark:bg-indigo-900/30 text-indigo-700 dark:text-indigo-300 text-[10px] font-bold uppercase tracking-widest border border-indigo-200 dark:border-indigo-800",children:"Marketing Tools"})}),t.jsx("h1",{className:"text-3xl md:text-5xl font-black text-slate-900 dark:text-white tracking-tight mb-2",children:"Email Composer"}),t.jsx("p",{className:"text-slate-500 dark:text-slate-400 font-medium",children:'Send updates from "Campus Connect".'})]})}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-8 min-h-[600px]",children:[t.jsxs("div",{className:"lg:col-span-4 space-y-6",children:[t.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-3xl p-6 border border-slate-200 dark:border-slate-700 shadow-sm",children:[t.jsx("h3",{className:"font-bold text-slate-900 dark:text-white mb-4",children:"1. Select Audience"}),t.jsxs("div",{className:"space-y-3",children:[t.jsx("div",{className:"flex gap-2 p-1 bg-slate-100 dark:bg-slate-900 rounded-xl",children:["me","all","sellers","subscribers"].map(l=>t.jsx("button",{onClick:()=>y(l),className:`flex-1 py-2 rounded-lg text-xs font-bold uppercase tracking-wide transition-all ${c===l?"bg-white dark:bg-slate-800 shadow-sm text-blue-600":"text-slate-500 hover:text-slate-700"}`,children:l==="me"?"Test (Me)":l==="all"?"Everyone":l==="subscribers"?"Newsletter":"Sellers"},l))}),c==="me"&&t.jsx("input",{type:"email",value:h,onChange:l=>w(l.target.value),placeholder:"Enter test email...",className:"w-full px-4 py-3 bg-slate-50 dark:bg-slate-900 border-none rounded-xl text-sm font-medium"})]})]}),t.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-3xl p-6 border border-slate-200 dark:border-slate-700 shadow-sm space-y-4",children:[t.jsx("h3",{className:"font-bold text-slate-900 dark:text-white mb-2",children:"2. Compose Email"}),t.jsxs("div",{children:[t.jsx("label",{className:"text-xs font-bold uppercase tracking-wide text-slate-500 mb-1 block",children:"Subject Line"}),t.jsx("input",{type:"text",value:a.subject,onChange:l=>k({...a,subject:l.target.value}),className:"w-full px-4 py-2 bg-slate-50 dark:bg-slate-900 border-none rounded-xl focus:ring-2 focus:ring-blue-500/20 font-medium text-sm outline-none"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-xs font-bold uppercase tracking-wide text-slate-500 mb-1 block",children:"Heading"}),t.jsx("input",{type:"text",value:a.heading,onChange:l=>k({...a,heading:l.target.value}),className:"w-full px-4 py-2 bg-slate-50 dark:bg-slate-900 border-none rounded-xl focus:ring-2 focus:ring-blue-500/20 font-medium text-sm outline-none"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-xs font-bold uppercase tracking-wide text-slate-500 mb-1 block",children:"Message Body"}),t.jsx("textarea",{value:a.body,onChange:l=>k({...a,body:l.target.value}),className:"w-full px-4 py-3 bg-slate-50 dark:bg-slate-900 border-none rounded-xl focus:ring-2 focus:ring-blue-500/20 font-medium text-sm min-h-[150px] outline-none resize-y",placeholder:"Type your message here..."})]}),t.jsxs("div",{className:"pt-2 border-t border-slate-100 dark:border-slate-700",children:[t.jsx("p",{className:"text-[10px] text-slate-400 mb-2",children:"Optional:"}),t.jsx("input",{type:"text",value:a.imageUrl,onChange:l=>k({...a,imageUrl:l.target.value}),className:"w-full mb-3 px-4 py-2 bg-slate-50 dark:bg-slate-900 border-none rounded-xl text-xs",placeholder:"Image URL..."}),t.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[t.jsx("input",{type:"text",value:a.ctaText,onChange:l=>k({...a,ctaText:l.target.value}),className:"w-full px-4 py-2 bg-slate-50 dark:bg-slate-900 border-none rounded-xl text-xs",placeholder:"Btn Text"}),t.jsx("input",{type:"text",value:a.ctaLink,onChange:l=>k({...a,ctaLink:l.target.value}),className:"w-full px-4 py-2 bg-slate-50 dark:bg-slate-900 border-none rounded-xl text-xs",placeholder:"Btn Link"})]})]})]})]}),t.jsxs("div",{className:"lg:col-span-8 flex flex-col gap-6",children:[t.jsxs("div",{className:"bg-slate-200 dark:bg-slate-900 rounded-3xl p-4 md:p-8 flex flex-col border border-slate-300 dark:border-slate-800 flex-1 relative overflow-hidden min-h-[500px]",children:[t.jsx("h3",{className:"text-center font-bold text-slate-500 mb-4 opacity-50 uppercase tracking-widest text-xs",children:"Live Preview (Campus Connect Template)"}),t.jsxs("div",{className:"bg-white rounded-xl shadow-lg flex-1 p-8 max-w-2xl mx-auto w-full flex flex-col items-center text-center",children:[t.jsx("h1",{className:"text-2xl font-black text-slate-900 mb-6 uppercase tracking-widest text-blue-600",children:"Campus Connect"}),a.imageUrl&&t.jsx("img",{src:a.imageUrl,className:"w-full h-48 object-cover rounded-xl mb-6",alt:""}),t.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-4",children:a.heading}),t.jsx("p",{className:"text-slate-600 leading-relaxed mb-8 text-left whitespace-pre-wrap",children:a.body}),a.ctaText&&t.jsx("a",{href:a.ctaLink,className:"inline-block px-8 py-3 bg-blue-600 text-white font-bold rounded-lg uppercase tracking-wide text-xs hover:bg-blue-700 transition-colors",children:a.ctaText}),t.jsxs("div",{className:"mt-auto pt-8 border-t border-slate-100 w-full text-center text-xs text-slate-400 mt-8",children:["Â© ",new Date().getFullYear()," Campus Connect. All rights reserved."]})]})]}),t.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-3xl p-6 border border-slate-200 dark:border-slate-700 shadow-sm flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"font-bold text-slate-900 dark:text-white",children:"Ready to send?"}),t.jsxs("p",{className:"text-sm text-slate-500",children:["Sender: ",t.jsx("span",{className:"font-bold text-blue-600",children:"Campus Connect"})," â€¢ Recipient: ",t.jsx("span",{className:"font-bold",children:c==="me"?h:c.toUpperCase()})]})]}),t.jsxs("button",{onClick:O,disabled:d,className:"px-8 py-4 bg-emerald-500 text-white rounded-xl font-black uppercase tracking-widest text-sm hover:bg-emerald-600 transition-all shadow-lg shadow-emerald-500/20 active:scale-95 flex items-center gap-2",children:[d?t.jsx("i",{className:"ri-loader-4-line animate-spin"}):t.jsx("i",{className:"ri-send-plane-fill"}),d?"Sending...":"Send Email"]})]})]})]})]})]})}export{de as default};
//# sourceMappingURL=EmailTemplates-BtsPNxdz.js.map

import{j as e}from"./query-vendor-Cpskl8RO.js";import{u as S,r as d,L as o}from"./react-vendor-Bsfkyusf.js";import{u as $,s as m,N as A}from"./index-4BAF1yr7.js";import"./i18n-vendor-CQdsz7qV.js";import"./supabase-vendor-C3liu3n-.js";function R(){const{profile:s}=$(),c=S(),[h,w]=d.useState({published:0,drafts:0,totalViews:0}),[b,j]=d.useState([]),[N,p]=d.useState(!0),[r,g]=d.useState(null);d.useEffect(()=>{if(!["news_publisher","admin","super_admin","publisher_seller"].includes(s?.role||"")){c("/marketplace");return}k();const t=m.channel("online-users");return t.on("presence",{event:"join"},({key:a,newPresences:x})=>{const n=x[0];n&&n.user_id!==s?.id&&g({type:"info",message:`${n.full_name||"A user"} came online`})}).subscribe(),()=>{m.removeChannel(t)}},[s]),d.useEffect(()=>{if(r){const t=setTimeout(()=>g(null),4e3);return()=>clearTimeout(t)}},[r]);const k=async()=>{if(s){p(!0);try{let t=m.from("campus_news").select("is_published, views_count, author_id");const{data:a,error:x}=await t;if(x)throw x;if(a){const i=a.filter(l=>s.role==="super_admin"||l.is_published===!0||l.author_id===s.id);w({published:i.filter(l=>l.is_published).length,drafts:i.filter(l=>!l.is_published).length,totalViews:i.reduce((l,_)=>l+(_.views_count||0),0)})}let n=m.from("campus_news").select("id, title, views_count, is_published, created_at, category, author_id").order("created_at",{ascending:!1}).limit(10);const{data:v,error:f}=await n;if(f)throw f;const y=(v||[]).filter(i=>s.role==="super_admin"||i.is_published===!0||i.author_id===s.id).slice(0,5);j(y)}catch(t){console.error("Error fetching publisher data:",t)}finally{p(!1)}}};if(N)return e.jsx("div",{className:"min-h-[100dvh] bg-slate-50 dark:bg-slate-950 flex items-center justify-center transition-colors",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-12 h-12 border-4 border-slate-200 border-t-indigo-600 rounded-full animate-spin mb-4 mx-auto"}),e.jsx("p",{className:"text-xs font-bold uppercase tracking-widest text-slate-400",children:"Loading Dashboard..."})]})});const u=s?.role==="admin"||s?.role==="super_admin";return e.jsxs("div",{className:"min-h-[100dvh] bg-slate-50 dark:bg-slate-950 transition-colors duration-300 pb-20 font-sans",children:[e.jsx(A,{}),r&&e.jsxs("div",{className:`fixed top-24 right-4 md:right-8 z-50 animate-in fade-in slide-in-from-right-8 duration-300 px-6 py-4 rounded-2xl shadow-2xl border flex items-center gap-3 backdrop-blur-md ${r.type==="success"?"bg-emerald-500/90 border-emerald-400/50 text-white":r.type==="error"?"bg-rose-500/90 border-rose-400/50 text-white":"bg-blue-500/90 border-blue-400/50 text-white"}`,children:[e.jsx("i",{className:`${r.type==="success"?"ri-checkbox-circle-fill":r.type==="error"?"ri-error-warning-fill":"ri-notification-3-fill"} text-xl`}),e.jsx("span",{className:"font-bold text-sm tracking-wide",children:r.message})]}),e.jsxs("div",{className:"pt-32 md:pt-40 pb-12 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-8 mb-16",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsxs("span",{className:"px-4 py-1.5 bg-indigo-600 text-white text-[10px] font-black uppercase tracking-widest rounded-full shadow-xl shadow-indigo-500/20",children:[e.jsx("i",{className:"ri-quill-pen-line mr-2"}),"Editorial HQ"]}),e.jsx("span",{className:"px-4 py-1.5 bg-white dark:bg-slate-800 text-slate-500 text-[10px] font-black uppercase tracking-widest rounded-full border border-slate-100 dark:border-slate-700",children:"V2.4.0"})]}),e.jsxs("h1",{className:"text-5xl md:text-7xl font-black text-slate-900 dark:text-white tracking-tighter leading-none mb-6",children:["Campus",e.jsx("br",{}),e.jsx("span",{className:"text-indigo-600",children:"Newsroom."})]}),e.jsxs("p",{className:"text-slate-500 dark:text-slate-400 font-bold uppercase tracking-widest text-[10px] flex items-center gap-2",children:[e.jsx("span",{className:"w-8 h-[2px] bg-indigo-600/30"}),"Authoring & Media distribution center"]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(o,{to:"/profile",className:"h-16 px-6 bg-white dark:bg-slate-800 text-slate-700 dark:text-slate-100 font-bold rounded-2xl border border-slate-100 dark:border-slate-700 hover:bg-slate-50 transition-all text-xs uppercase tracking-widest flex items-center gap-3 active:scale-95",children:[e.jsx("i",{className:"ri-user-smile-line text-xl text-blue-500"}),"My Profile"]}),e.jsxs(o,{to:"/admin/news",className:"h-16 px-8 bg-slate-900 dark:bg-white text-white dark:text-slate-900 font-black rounded-2xl hover:scale-105 transition-all text-xs uppercase tracking-widest shadow-2xl flex items-center gap-3 active:scale-95",children:[e.jsx("i",{className:"ri-add-line text-xl"}),"New Dispatch"]})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-10",children:[{label:"Published News",value:h.published,icon:"ri-checkbox-circle-fill",color:"from-emerald-500 to-emerald-600",sub:"Live Audience"},{label:"Drafts Saved",value:h.drafts,icon:"ri-draft-fill",color:"from-amber-500 to-amber-600",sub:"In Progress"},{label:"Total Reads",value:h.totalViews.toLocaleString(),icon:"ri-eye-fill",color:"from-blue-500 to-blue-600",sub:"Engagement"}].map((t,a)=>e.jsxs("div",{className:"bg-white dark:bg-slate-900 p-6 rounded-[2rem] border border-slate-100 dark:border-slate-800 shadow-sm hover:shadow-2xl hover:-translate-y-1 transition-all group relative overflow-hidden",children:[e.jsx("div",{className:`absolute top-0 right-0 w-32 h-32 bg-gradient-to-br ${t.color} opacity-[0.08] rounded-bl-full group-hover:scale-110 transition-transform duration-500`}),e.jsx("div",{className:`w-14 h-14 rounded-2xl bg-gradient-to-tr ${t.color} text-white flex items-center justify-center mb-4 shadow-lg group-hover:shadow-xl group-hover:scale-110 transition-all duration-300`,children:e.jsx("i",{className:`${t.icon} text-2xl`})}),e.jsx("div",{className:"text-4xl font-black text-slate-900 dark:text-white mb-1 tracking-tight",children:t.value}),e.jsx("div",{className:"text-[10px] uppercase tracking-widest font-bold text-slate-400 mb-2",children:t.label}),e.jsxs("div",{className:"text-xs font-medium text-slate-500 dark:text-slate-400 flex items-center gap-1",children:[e.jsx("i",{className:"ri-bar-chart-fill text-slate-300 dark:text-slate-600"}),t.sub]})]},a))}),e.jsx("div",{className:"mb-10",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[u&&e.jsxs("div",{className:"lg:col-span-1 space-y-4",children:[e.jsxs("h3",{className:"text-xs font-bold uppercase tracking-widest text-slate-400 mb-4 flex items-center gap-2",children:[e.jsx("i",{className:"ri-shield-star-line text-blue-500"})," Admin Controls"]}),e.jsx("div",{className:"grid grid-cols-1 gap-3",children:[{title:"Users",path:"/admin/users",icon:"ri-user-settings-line",color:"text-blue-600 bg-blue-50 dark:bg-blue-900/20"},{title:"Polls",path:"/admin/polls",icon:"ri-bar-chart-grouped-line",color:"text-purple-600 bg-purple-50 dark:bg-purple-900/20"},{title:"Support",path:"/admin/support",icon:"ri-customer-service-2-line",color:"text-pink-600 bg-pink-50 dark:bg-pink-900/20"}].map((t,a)=>e.jsxs(o,{to:t.path,className:"flex items-center gap-3 p-3 bg-white dark:bg-slate-900 rounded-xl border border-slate-100 dark:border-slate-800 hover:border-blue-200 dark:hover:border-blue-800 hover:shadow-md transition-all group",children:[e.jsx("div",{className:`w-10 h-10 rounded-lg ${t.color} flex items-center justify-center`,children:e.jsx("i",{className:`${t.icon} text-lg`})}),e.jsx("span",{className:"font-bold text-xs uppercase tracking-wide text-slate-700 dark:text-slate-300",children:t.title})]},a))})]}),e.jsxs("div",{className:`lg:col-span-${u?"3":"4"}`,children:[e.jsxs("h3",{className:"text-xs font-bold uppercase tracking-widest text-slate-400 mb-4 flex items-center gap-2",children:[e.jsx("i",{className:"ri-flashlight-line text-amber-500"})," Editorial Actions"]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-6",children:[{title:"Write Article",desc:"New Story",path:"/admin/news",icon:"ri-edit-line",color:"text-indigo-600",bg:"bg-indigo-50 dark:bg-indigo-900/20"},{title:"My Drafts",desc:"Continue Writing",path:"/admin/news?filter=draft",icon:"ri-file-edit-line",color:"text-amber-600",bg:"bg-amber-50 dark:bg-amber-900/20"},{title:"Media Library",desc:"Manage Images",path:"/admin/content",icon:"ri-image-line",color:"text-cyan-600",bg:"bg-cyan-50 dark:bg-cyan-900/20"},{title:"Public News",desc:"View Live Site",path:"/news",icon:"ri-global-line",color:"text-emerald-600",bg:"bg-emerald-50 dark:bg-emerald-900/20"}].map((t,a)=>e.jsxs(o,{to:t.path,className:"flex flex-col items-center text-center p-6 bg-white dark:bg-slate-900 rounded-[2rem] border border-slate-100 dark:border-slate-800 hover:border-indigo-200 dark:hover:border-indigo-800 hover:shadow-xl hover:-translate-y-1 transition-all group",children:[e.jsx("div",{className:`w-16 h-16 rounded-2xl ${t.bg} ${t.color} flex items-center justify-center mb-4 group-hover:scale-110 transition-transform shadow-sm`,children:e.jsx("i",{className:`${t.icon} text-3xl`})}),e.jsx("h4",{className:"font-black text-slate-900 dark:text-white mb-1 text-sm",children:t.title}),e.jsx("p",{className:"text-[10px] text-slate-500 dark:text-slate-400 font-bold uppercase tracking-wider",children:t.desc})]},a))})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-[2.5rem] border border-slate-100 dark:border-slate-800 shadow-sm overflow-hidden p-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsx("h3",{className:"text-xl font-black text-slate-900 dark:text-white tracking-tight",children:"Recent Uploads"}),e.jsx(o,{to:"/admin/news",className:"text-[10px] font-bold text-indigo-600 dark:text-indigo-400 hover:text-indigo-800 dark:hover:text-indigo-300 uppercase tracking-widest bg-indigo-50 dark:bg-indigo-900/20 px-4 py-2 rounded-full transition-colors",children:"View Repository"})]}),b.length===0?e.jsxs("div",{className:"text-center py-16",children:[e.jsx("div",{className:"w-16 h-16 bg-white dark:bg-slate-800 rounded-2xl flex items-center justify-center mx-auto mb-4",children:e.jsx("i",{className:"ri-folder-open-line text-3xl text-slate-300 dark:text-slate-600"})}),e.jsx("p",{className:"text-xs font-bold uppercase tracking-widest text-slate-400",children:"No articles yet"}),e.jsx("button",{onClick:()=>c("/admin/news"),className:"mt-4 text-xs font-bold text-indigo-600 hover:underline",children:"Create your first story"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-slate-50/50 dark:bg-slate-800/50 border-b border-slate-100 dark:border-slate-800",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-left text-[10px] font-bold text-slate-400 uppercase tracking-widest",children:"Article Details"}),e.jsx("th",{className:"px-6 py-4 text-left text-[10px] font-bold text-slate-400 uppercase tracking-widest",children:"Status"}),e.jsx("th",{className:"px-6 py-4 text-left text-[10px] font-bold text-slate-400 uppercase tracking-widest",children:"Impact"}),e.jsx("th",{className:"px-6 py-4 text-right text-[10px] font-bold text-slate-400 uppercase tracking-widest",children:"Date"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100 dark:divide-slate-800",children:b.map(t=>e.jsxs("tr",{className:"hover:bg-slate-50/50 dark:hover:bg-slate-800/30 transition-colors group cursor-pointer",onClick:()=>c("/admin/news"),children:[e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("div",{className:"font-bold text-sm text-slate-900 dark:text-white line-clamp-1 group-hover:text-indigo-600 dark:group-hover:text-indigo-400 transition-colors",children:t.title}),e.jsx("div",{className:"text-[10px] text-slate-500 dark:text-slate-400 font-bold uppercase tracking-wide mt-1",children:t.category})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("span",{className:`inline-flex items-center gap-1.5 px-3 py-1 rounded-lg text-[10px] font-bold uppercase tracking-widest ${t.is_published?"bg-emerald-100 text-emerald-700 dark:bg-emerald-900/30 dark:text-emerald-300":"bg-amber-100 text-amber-700 dark:bg-amber-900/30 dark:text-amber-300"}`,children:[e.jsx("span",{className:`w-1.5 h-1.5 rounded-full ${t.is_published?"bg-emerald-500":"bg-amber-500"}`}),t.is_published?"Published":"Draft"]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("i",{className:"ri-eye-line text-slate-400"}),e.jsx("span",{className:"text-sm font-bold text-slate-700 dark:text-slate-300",children:t.views_count.toLocaleString()})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-xs font-bold text-slate-400",children:new Date(t.created_at).toLocaleDateString()})]},t.id))})]})})]})}),e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-gradient-to-br from-indigo-600 to-violet-700 rounded-[2.5rem] p-8 text-white shadow-2xl shadow-indigo-500/30 relative overflow-hidden group",children:[e.jsx("div",{className:"absolute top-0 right-0 w-48 h-48 bg-white/10 rounded-full blur-3xl -mr-20 -mt-20 group-hover:scale-125 transition-transform duration-700"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-32 h-32 bg-black/10 rounded-full blur-2xl -ml-12 -mb-12"}),e.jsxs("div",{className:"relative z-10",children:[e.jsx("div",{className:"w-14 h-14 bg-white/20 backdrop-blur-md rounded-2xl flex items-center justify-center mb-8 shadow-inner border border-white/10",children:e.jsx("i",{className:"ri-lightbulb-flash-fill text-2xl text-amber-300"})}),e.jsx("h3",{className:"text-2xl font-black mb-3 tracking-tight",children:"Pro Tip"}),e.jsxs("p",{className:"text-indigo-100 text-sm leading-relaxed mb-8 font-medium bg-black/10 p-5 rounded-2xl backdrop-blur-sm border border-white/5",children:['"Articles with engaging headlines and high-quality cover images receive up to ',e.jsx("span",{className:"text-white font-bold",children:"3x more views"}),' from the campus community."']}),e.jsx("button",{onClick:()=>c("/admin/news"),className:"w-full py-4 bg-white text-indigo-700 rounded-xl text-xs font-black uppercase tracking-widest hover:bg-indigo-50 transition-all shadow-xl active:scale-95",children:"Compose Now"})]})]})})]})]})]})}export{R as default};
//# sourceMappingURL=NewsPublisherDashboard-BCUtOnlT.js.map

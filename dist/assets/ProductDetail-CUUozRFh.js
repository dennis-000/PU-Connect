import{j as e}from"./query-vendor-CC_3ftG1.js";import{h as N,u as _,r as h,L as u}from"./react-vendor-Bsfkyusf.js";import{u as C,d as I,b as P,c as $,N as x,g}from"./index-BpkOjQCb.js";import{u as S,a as U}from"./useConversations-BtuUREJY.js";import"./i18n-vendor-CQdsz7qV.js";import"./supabase-vendor-C3liu3n-.js";function T(){const{id:m}=N(),{user:n}=C(),d=_(),{data:t,isLoading:b}=I(m),{conversations:f=[]}=S(),c=U(),{data:y=[]}=P(),w=$(),p=y.some(a=>a.product_id===m),[l,o]=h.useState(null);h.useEffect(()=>{t?.images&&t.images.length>0&&o(t.images[0])},[t]);const j=()=>{if(!t?.whatsapp_number){alert("WhatsApp number not available");return}const a=encodeURIComponent(`Hi! I'm interested in your product: ${t.name}`),r=`https://wa.me/${t.whatsapp_number.replace(/[^0-9]/g,"")}?text=${a}`;window.open(r,"_blank")},v=async()=>{if(!n){d("/login");return}if(!t)return;if(n.id===t.seller_id){alert("You cannot message yourself!");return}if(f?.find(r=>r.product_id===t.id&&(r.buyer_id===n.id||r.seller_id===n.id))){d("/messages");return}c.mutate({otherUserId:t.seller_id,productId:t.id},{onSuccess:()=>{d("/messages")},onError:r=>{console.error("Error creating conversation:",r),alert(`Failed to start conversation: ${r.message||"Unknown error"}`)}})},k=()=>{const a=t?.name||"Campus Connect Product",r=window.location.href;if(navigator.share)navigator.share({title:a,text:`Check out ${a} on Campus Marketplace`,url:r}).catch(i=>{i.name!=="AbortError"&&console.error("Share failed:",i)});else{const i=`https://wa.me/?text=${encodeURIComponent("Check out "+a+" on Campus Connect: "+r)}`;window.open(i,"_blank"),navigator.clipboard.writeText(r)}};if(b)return e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-950 pt-20 transition-colors duration-300",children:[e.jsx(x,{}),e.jsxs("div",{className:"text-center py-24",children:[e.jsx("div",{className:"inline-block w-12 h-12 border-4 border-gray-200 border-t-emerald-600 rounded-full animate-spin"}),e.jsx("p",{className:"mt-4 text-gray-600 dark:text-gray-400 font-medium",children:"Loading product details..."})]})]});if(!t)return e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-950 pt-20 transition-colors duration-300",children:[e.jsx(x,{}),e.jsxs("div",{className:"text-center py-24 max-w-md mx-auto",children:[e.jsx("div",{className:"w-24 h-24 bg-red-50 dark:bg-red-900/20 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx("i",{className:"ri-shopping-bag-line text-5xl text-red-300 dark:text-red-500"})}),e.jsx("h3",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Product not found"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-8",children:"The product you are looking for might have been sold or removed by the seller."}),e.jsxs(u,{to:"/marketplace",className:"inline-flex items-center px-6 py-3 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx("i",{className:"ri-arrow-left-line mr-2"}),"Back to marketplace"]})]})]});const s=t.seller;return e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-950 pt-24 pb-32 transition-colors duration-300",children:[e.jsx(x,{}),e.jsxs("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsxs(u,{to:"/marketplace",className:"inline-flex items-center text-blue-600 hover:text-blue-700 font-bold text-sm uppercase tracking-widest transition-colors cursor-pointer",children:[e.jsx("i",{className:"ri-arrow-left-line mr-2"}),"Back to Marketplace"]}),e.jsx("button",{onClick:k,className:"w-10 h-10 bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-100 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700 transition-all text-gray-500 dark:text-gray-400 cursor-pointer flex items-center justify-center",title:"Share Product",children:e.jsx("i",{className:"ri-share-forward-line text-lg"})})]}),e.jsx("div",{className:"bg-white dark:bg-gray-900 rounded-[2.5rem] shadow-xl shadow-gray-200/40 dark:shadow-none border border-gray-50 dark:border-gray-800 overflow-hidden",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 md:gap-12 p-6 md:p-12",children:[e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"aspect-[4/5] md:aspect-square bg-gray-50 dark:bg-gray-800 rounded-[2rem] overflow-hidden border border-gray-50 dark:border-gray-800 flex items-center justify-center relative group select-none",children:[l?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:g(l,1e3,85),alt:t.name,className:"w-full h-full object-cover animate-in fade-in zoom-in-105 duration-500",loading:"eager",decoding:"async"},l),t.images&&t.images.length>1&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:a=>{a.stopPropagation();const i=(t.images.indexOf(l)-1+t.images.length)%t.images.length;o(t.images[i])},className:"absolute left-4 top-1/2 -translate-y-1/2 w-10 h-10 bg-white/10 hover:bg-white/30 backdrop-blur-md text-white rounded-full flex items-center justify-center transition-all opacity-0 group-hover:opacity-100 active:scale-95",children:e.jsx("i",{className:"ri-arrow-left-s-line text-2xl"})}),e.jsx("button",{onClick:a=>{a.stopPropagation();const i=(t.images.indexOf(l)+1)%t.images.length;o(t.images[i])},className:"absolute right-4 top-1/2 -translate-y-1/2 w-10 h-10 bg-white/10 hover:bg-white/30 backdrop-blur-md text-white rounded-full flex items-center justify-center transition-all opacity-0 group-hover:opacity-100 active:scale-95",children:e.jsx("i",{className:"ri-arrow-right-s-line text-2xl"})}),e.jsxs("div",{className:"absolute bottom-4 right-4 px-3 py-1 bg-black/50 backdrop-blur-md rounded-full text-white text-[10px] font-bold uppercase tracking-widest opacity-0 group-hover:opacity-100 transition-opacity",children:[t.images.indexOf(l)+1," / ",t.images.length]})]})]}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx("i",{className:"ri-image-line text-6xl text-gray-200 dark:text-gray-700"})}),t.is_active===!1&&e.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center",children:e.jsx("span",{className:"px-8 py-3 bg-red-600 text-white font-bold rounded-full text-lg uppercase tracking-widest shadow-xl",children:"Sold Out"})})]}),t.images&&t.images.length>1&&e.jsx("div",{className:"grid grid-cols-5 gap-2 md:gap-3 overflow-x-auto pb-2 px-1",children:t.images.map((a,r)=>e.jsxs("button",{onClick:()=>o(a),className:`aspect-square rounded-xl overflow-hidden border-2 transition-all duration-300 relative group/thumb ${l===a?"border-blue-600 ring-4 ring-blue-600/10 scale-95 opacity-100":"border-transparent opacity-50 hover:opacity-100 hover:scale-105"}`,children:[e.jsx("img",{src:g(a,200,80),alt:`View ${r+1}`,className:"w-full h-full object-cover"}),l!==a&&e.jsx("div",{className:"absolute inset-0 bg-black/10 group-hover/thumb:bg-transparent transition-colors"})]},r))})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsx("span",{className:"px-4 py-1.5 bg-blue-600 text-white text-[10px] md:text-xs font-bold uppercase tracking-widest rounded-full shadow-lg shadow-blue-500/20",children:t.category}),e.jsxs("div",{className:"flex items-center text-gray-400 text-xs md:text-sm font-bold uppercase tracking-widest",children:[e.jsx("i",{className:"ri-eye-line mr-2 text-blue-600"}),t.views_count||0," Views"]})]}),e.jsxs("div",{className:"flex items-start justify-between gap-4 mb-6",children:[e.jsx("h1",{className:"text-3xl md:text-5xl font-bold text-gray-900 dark:text-white leading-tight tracking-tight",children:t.name}),e.jsx("button",{onClick:()=>w.mutate(t.id),className:`w-12 h-12 md:w-14 md:h-14 rounded-2xl flex items-center justify-center transition-all shadow-lg active:scale-95 flex-shrink-0 cursor-pointer ${p?"bg-rose-500 text-white shadow-rose-200 dark:shadow-none":"bg-white dark:bg-gray-800 text-gray-400 dark:text-gray-500 hover:text-rose-500 border border-gray-100 dark:border-gray-800"}`,children:e.jsx("i",{className:`${p?"ri-heart-fill":"ri-heart-line"} text-2xl`})})]}),e.jsx("div",{className:"mb-8 p-8 bg-gray-50 dark:bg-gray-800/50 rounded-[2rem] border border-gray-100 dark:border-gray-800",children:t.price_type==="fixed"?e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-widest mb-2",children:"Listing Price"}),e.jsxs("span",{className:"text-3xl md:text-5xl font-bold text-blue-600 tracking-tight",children:["GHâ‚µ",t.price?.toLocaleString()]})]}):e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-widest mb-2",children:"Pricing Terms"}),e.jsx("p",{className:"text-xl md:text-2xl font-bold text-blue-600 uppercase tracking-widest",children:"Contact for Quote"})]})}),e.jsxs("div",{className:"mb-10",children:[e.jsx("h3",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-widest mb-4 ml-1",children:"Product Description"}),e.jsx("div",{className:"prose prose-blue max-w-none dark:prose-invert",children:e.jsx("p",{className:"text-gray-600 dark:text-gray-300 leading-relaxed text-base font-medium",children:t.description||"No detailed description provided by the seller."})})]}),e.jsxs("div",{className:"mb-10 p-6 bg-gray-50 dark:bg-gray-800/50 rounded-2xl border border-gray-100 dark:border-gray-800 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl overflow-hidden shadow-sm border-2 border-white dark:border-gray-700 bg-white dark:bg-black",children:s.business_logo||s?.avatar_url?e.jsx("img",{src:g(s.business_logo||s.avatar_url,128,80),alt:s.business_name||s.full_name,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full bg-gray-900 dark:bg-gray-700 flex items-center justify-center",children:e.jsx("span",{className:"text-white font-bold text-lg",children:(s.business_name||s?.full_name)?.charAt(0).toUpperCase()||"S"})})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-widest mb-0.5",children:"Sold By"}),e.jsx("p",{className:"font-bold text-gray-900 dark:text-white text-base tracking-tight",children:s.business_name||s?.full_name||"Campus Seller"})]})]}),e.jsxs("div",{className:"text-right hidden sm:block",children:[e.jsx("p",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-widest mb-0.5",children:"Faculty / Dept"}),e.jsx("p",{className:"text-xs font-bold text-gray-700 dark:text-gray-300",children:s?.department||"Verified Member"})]})]}),e.jsx("div",{className:"fixed bottom-0 left-0 right-0 p-4 bg-white/95 dark:bg-gray-900/95 backdrop-blur-md border-t border-gray-100 dark:border-gray-800 z-50 lg:static lg:p-0 lg:bg-transparent lg:border-none shadow-[0_-10px_40px_-15px_rgba(0,0,0,0.1)] lg:shadow-none animate-slide-in-up",children:e.jsxs("div",{className:"max-w-6xl mx-auto grid grid-cols-3 gap-2 lg:gap-3",children:[e.jsxs("button",{onClick:j,className:"w-full flex flex-col lg:flex-row items-center justify-center gap-1 lg:gap-2 px-2 lg:px-4 py-3 lg:py-4.5 bg-emerald-600 text-white font-bold rounded-xl lg:rounded-2xl hover:bg-emerald-700 shadow-lg shadow-emerald-500/20 transition-all cursor-pointer active:scale-95 text-[10px] lg:text-xs uppercase tracking-widest",disabled:!t?.whatsapp_number,children:[e.jsx("i",{className:"ri-whatsapp-line text-lg lg:text-xl"}),e.jsx("span",{className:"hidden leading-none sm:inline",children:"WhatsApp"})]}),e.jsxs("a",{href:`tel:${s?.phone}`,className:`w-full flex flex-col lg:flex-row items-center justify-center gap-1 lg:gap-2 px-2 lg:px-4 py-3 lg:py-4.5 bg-blue-600 text-white font-bold rounded-xl lg:rounded-2xl hover:bg-blue-700 shadow-lg shadow-blue-500/20 transition-all cursor-pointer active:scale-95 text-[10px] lg:text-xs uppercase tracking-widest ${s?.phone?"":"opacity-50 pointer-events-none"}`,children:[e.jsx("i",{className:"ri-phone-line text-lg lg:text-xl"}),e.jsx("span",{className:"hidden leading-none sm:inline",children:"Call"})]}),e.jsxs("button",{onClick:v,className:"w-full flex flex-col lg:flex-row items-center justify-center gap-1 lg:gap-2 px-2 lg:px-4 py-3 lg:py-4.5 bg-gray-900 dark:bg-white text-white dark:text-gray-900 font-bold rounded-xl lg:rounded-2xl hover:bg-black dark:hover:bg-gray-100 shadow-lg shadow-gray-900/20 transition-all cursor-pointer active:scale-95 text-[10px] lg:text-xs uppercase tracking-widest",disabled:c.isPending,children:[e.jsx("i",{className:"ri-message-3-line text-lg lg:text-xl"}),e.jsx("span",{className:"hidden leading-none sm:inline",children:c.isPending?"...":"Chat"})]})]})})]})]})})]})]})}export{T as default};
//# sourceMappingURL=ProductDetail-CUUozRFh.js.map

{"version":3,"file":"SubscriptionManagement-DgnDyNNV.js","sources":["../../src/pages/admin/SubscriptionManagement.tsx"],"sourcesContent":["import { useState, useEffect } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { useAuth } from '../../contexts/AuthContext';\r\nimport { supabase } from '../../lib/supabase';\r\nimport Navbar from '../../components/feature/Navbar';\r\n\r\ntype SellerProfile = {\r\n  id: string;\r\n  user_id: string;\r\n  business_name: string;\r\n  subscription_status: string;\r\n  subscription_start_date: string | null;\r\n  subscription_end_date: string | null;\r\n  last_payment_amount: number | null;\r\n  last_payment_date: string | null;\r\n  profiles: {\r\n    full_name: string;\r\n    email: string;\r\n  };\r\n};\r\n\r\ntype Payment = {\r\n  id: string;\r\n  seller_id: string;\r\n  amount: number;\r\n  currency: string;\r\n  payment_reference: string;\r\n  payment_status: string;\r\n  subscription_start_date: string;\r\n  subscription_end_date: string;\r\n  created_at: string;\r\n  profiles: {\r\n    full_name: string;\r\n    email: string;\r\n  };\r\n};\r\n\r\nexport default function SubscriptionManagement() {\r\n  const navigate = useNavigate();\r\n  const { profile, loading: authLoading } = useAuth();\r\n  const [sellers, setSellers] = useState<SellerProfile[]>([]);\r\n  const [payments, setPayments] = useState<Payment[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [activeTab, setActiveTab] = useState<'sellers' | 'payments'>('sellers');\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [statusFilter, setStatusFilter] = useState('all');\r\n\r\n  useEffect(() => {\r\n    if (!authLoading && profile?.role !== 'admin') {\r\n      navigate('/');\r\n    }\r\n  }, [profile, authLoading, navigate]);\r\n\r\n  useEffect(() => {\r\n    fetchData();\r\n  }, []);\r\n\r\n  const fetchData = async () => {\r\n    try {\r\n      const { data: sellersData, error: sellersError } = await supabase\r\n        .from('seller_profiles')\r\n        .select('*, profiles!seller_profiles_user_id_fkey(full_name, email)')\r\n        .order('created_at', { ascending: false });\r\n\r\n      if (sellersError) throw sellersError;\r\n      setSellers(sellersData || []);\r\n\r\n      const { data: paymentsData, error: paymentsError } = await supabase\r\n        .from('subscription_payments')\r\n        .select('*, profiles!subscription_payments_seller_id_fkey(full_name, email)')\r\n        .order('created_at', { ascending: false });\r\n\r\n      if (paymentsError) throw paymentsError;\r\n      setPayments(paymentsData || []);\r\n    } catch (error) {\r\n      console.error('Error fetching data:', error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleManualRenewal = async (sellerId: string) => {\r\n    if (!confirm('Manually renew this seller\\'s subscription for 1 month + 3 days?')) {\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const startDate = new Date();\r\n      const endDate = new Date();\r\n      endDate.setMonth(endDate.getMonth() + 1);\r\n      endDate.setDate(endDate.getDate() + 3);\r\n\r\n      const { error } = await supabase\r\n        .from('seller_profiles')\r\n        .update({\r\n          subscription_status: 'active',\r\n          subscription_start_date: startDate.toISOString(),\r\n          subscription_end_date: endDate.toISOString(),\r\n          last_payment_date: startDate.toISOString(),\r\n        })\r\n        .eq('user_id', sellerId);\r\n\r\n      if (error) throw error;\r\n\r\n      await fetchData();\r\n      alert('Subscription renewed successfully!');\r\n    } catch (error) {\r\n      console.error('Error renewing subscription:', error);\r\n      alert('Failed to renew subscription');\r\n    }\r\n  };\r\n\r\n  const handleSuspendSeller = async (sellerId: string) => {\r\n    if (!confirm('Suspend this seller\\'s subscription? Their products will be hidden.')) {\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const { error } = await supabase\r\n        .from('seller_profiles')\r\n        .update({ subscription_status: 'inactive' })\r\n        .eq('user_id', sellerId);\r\n\r\n      if (error) throw error;\r\n\r\n      await fetchData();\r\n      alert('Seller subscription suspended');\r\n    } catch (error) {\r\n      console.error('Error suspending seller:', error);\r\n      alert('Failed to suspend seller');\r\n    }\r\n  };\r\n\r\n  const getDaysRemaining = (endDate: string | null) => {\r\n    if (!endDate) return null;\r\n    const end = new Date(endDate);\r\n    const now = new Date();\r\n    const diff = Math.ceil((end.getTime() - now.getTime()) / (1000 * 60 * 60 * 24));\r\n    return diff;\r\n  };\r\n\r\n  const filteredSellers = sellers.filter(seller => {\r\n    const matchesSearch = \r\n      seller.business_name.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n      seller.profiles.full_name.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n      seller.profiles.email.toLowerCase().includes(searchTerm.toLowerCase());\r\n    \r\n    const matchesStatus = statusFilter === 'all' || seller.subscription_status === statusFilter;\r\n    \r\n    return matchesSearch && matchesStatus;\r\n  });\r\n\r\n  const filteredPayments = payments.filter(payment =>\r\n    payment.profiles.full_name.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n    payment.profiles.email.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n    payment.payment_reference.toLowerCase().includes(searchTerm.toLowerCase())\r\n  );\r\n\r\n  const stats = {\r\n    total: sellers.length,\r\n    active: sellers.filter(s => s.subscription_status === 'active').length,\r\n    expired: sellers.filter(s => s.subscription_status === 'expired').length,\r\n    inactive: sellers.filter(s => s.subscription_status === 'inactive').length,\r\n    totalRevenue: payments\r\n      .filter(p => p.payment_status === 'success')\r\n      .reduce((sum, p) => sum + p.amount, 0),\r\n  };\r\n\r\n  if (authLoading || loading) {\r\n    return (\r\n      <div className=\"min-h-screen bg-gray-50 flex items-center justify-center\">\r\n        <div className=\"text-center\">\r\n          <i className=\"ri-loader-4-line text-4xl text-sky-600 animate-spin\"></i>\r\n          <p className=\"mt-4 text-gray-600\">Loading...</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gray-50\">\r\n      <Navbar />\r\n      \r\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\r\n        <div className=\"mb-8\">\r\n          <h1 className=\"text-3xl font-bold text-gray-900\">Subscription Management</h1>\r\n          <p className=\"mt-2 text-gray-600\">Monitor seller subscriptions and payments</p>\r\n        </div>\r\n\r\n        {/* Stats */}\r\n        <div className=\"grid grid-cols-1 md:grid-cols-5 gap-6 mb-8\">\r\n          <div className=\"bg-white rounded-xl shadow-sm p-6\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <div>\r\n                <p className=\"text-sm text-gray-600\">Total Sellers</p>\r\n                <p className=\"text-2xl font-bold text-gray-900 mt-1\">{stats.total}</p>\r\n              </div>\r\n              <div className=\"w-12 h-12 bg-sky-100 rounded-lg flex items-center justify-center\">\r\n                <i className=\"ri-store-line text-2xl text-sky-600\"></i>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"bg-white rounded-xl shadow-sm p-6\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <div>\r\n                <p className=\"text-sm text-gray-600\">Active</p>\r\n                <p className=\"text-2xl font-bold text-green-600 mt-1\">{stats.active}</p>\r\n              </div>\r\n              <div className=\"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center\">\r\n                <i className=\"ri-checkbox-circle-line text-2xl text-green-600\"></i>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"bg-white rounded-xl shadow-sm p-6\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <div>\r\n                <p className=\"text-sm text-gray-600\">Expired</p>\r\n                <p className=\"text-2xl font-bold text-red-600 mt-1\">{stats.expired}</p>\r\n              </div>\r\n              <div className=\"w-12 h-12 bg-red-100 rounded-lg flex items-center justify-center\">\r\n                <i className=\"ri-close-circle-line text-2xl text-red-600\"></i>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"bg-white rounded-xl shadow-sm p-6\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <div>\r\n                <p className=\"text-sm text-gray-600\">Inactive</p>\r\n                <p className=\"text-2xl font-bold text-gray-600 mt-1\">{stats.inactive}</p>\r\n              </div>\r\n              <div className=\"w-12 h-12 bg-gray-100 rounded-lg flex items-center justify-center\">\r\n                <i className=\"ri-pause-circle-line text-2xl text-gray-600\"></i>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"bg-white rounded-xl shadow-sm p-6\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <div>\r\n                <p className=\"text-sm text-gray-600\">Total Revenue</p>\r\n                <p className=\"text-2xl font-bold text-amber-600 mt-1\">\r\n                  GH₵ {stats.totalRevenue.toFixed(2)}\r\n                </p>\r\n              </div>\r\n              <div className=\"w-12 h-12 bg-amber-100 rounded-lg flex items-center justify-center\">\r\n                <i className=\"ri-money-dollar-circle-line text-2xl text-amber-600\"></i>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Tabs */}\r\n        <div className=\"bg-white rounded-xl shadow-sm mb-6\">\r\n          <div className=\"border-b border-gray-200\">\r\n            <div className=\"flex\">\r\n              <button\r\n                onClick={() => setActiveTab('sellers')}\r\n                className={`px-6 py-4 text-sm font-medium border-b-2 transition-colors cursor-pointer whitespace-nowrap ${\r\n                  activeTab === 'sellers'\r\n                    ? 'border-sky-600 text-sky-600'\r\n                    : 'border-transparent text-gray-500 hover:text-gray-700'\r\n                }`}\r\n              >\r\n                Seller Subscriptions\r\n              </button>\r\n              <button\r\n                onClick={() => setActiveTab('payments')}\r\n                className={`px-6 py-4 text-sm font-medium border-b-2 transition-colors cursor-pointer whitespace-nowrap ${\r\n                  activeTab === 'payments'\r\n                    ? 'border-sky-600 text-sky-600'\r\n                    : 'border-transparent text-gray-500 hover:text-gray-700'\r\n                }`}\r\n              >\r\n                Payment History\r\n              </button>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"p-6\">\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6\">\r\n              <div className=\"relative\">\r\n                <i className=\"ri-search-line absolute left-3 top-1/2 -translate-y-1/2 text-gray-400\"></i>\r\n                <input\r\n                  type=\"text\"\r\n                  value={searchTerm}\r\n                  onChange={(e) => setSearchTerm(e.target.value)}\r\n                  placeholder=\"Search...\"\r\n                  className=\"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-transparent text-sm\"\r\n                />\r\n              </div>\r\n\r\n              {activeTab === 'sellers' && (\r\n                <select\r\n                  value={statusFilter}\r\n                  onChange={(e) => setStatusFilter(e.target.value)}\r\n                  className=\"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-transparent text-sm cursor-pointer\"\r\n                >\r\n                  <option value=\"all\">All Status</option>\r\n                  <option value=\"active\">Active</option>\r\n                  <option value=\"expired\">Expired</option>\r\n                  <option value=\"inactive\">Inactive</option>\r\n                </select>\r\n              )}\r\n            </div>\r\n\r\n            {activeTab === 'sellers' ? (\r\n              <div className=\"overflow-x-auto\">\r\n                <table className=\"w-full\">\r\n                  <thead className=\"bg-gray-50 border-b border-gray-200\">\r\n                    <tr>\r\n                      <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                        Seller\r\n                      </th>\r\n                      <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                        Business\r\n                      </th>\r\n                      <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                        Status\r\n                      </th>\r\n                      <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                        Expires In\r\n                      </th>\r\n                      <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                        Last Payment\r\n                      </th>\r\n                      <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                        Actions\r\n                      </th>\r\n                    </tr>\r\n                  </thead>\r\n                  <tbody className=\"bg-white divide-y divide-gray-200\">\r\n                    {filteredSellers.map((seller) => {\r\n                      const daysRemaining = getDaysRemaining(seller.subscription_end_date);\r\n                      return (\r\n                        <tr key={seller.id} className=\"hover:bg-gray-50\">\r\n                          <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                            <div>\r\n                              <div className=\"text-sm font-medium text-gray-900\">\r\n                                {seller.profiles.full_name}\r\n                              </div>\r\n                              <div className=\"text-sm text-gray-500\">{seller.profiles.email}</div>\r\n                            </div>\r\n                          </td>\r\n                          <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                            <div className=\"text-sm text-gray-900\">{seller.business_name}</div>\r\n                          </td>\r\n                          <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                            <span className={`px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${\r\n                              seller.subscription_status === 'active'\r\n                                ? 'bg-green-100 text-green-800'\r\n                                : seller.subscription_status === 'expired'\r\n                                ? 'bg-red-100 text-red-800'\r\n                                : 'bg-gray-100 text-gray-800'\r\n                            }`}>\r\n                              {seller.subscription_status}\r\n                            </span>\r\n                          </td>\r\n                          <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                            {daysRemaining !== null ? (\r\n                              <span className={`text-sm font-medium ${\r\n                                daysRemaining < 0 ? 'text-red-600' :\r\n                                daysRemaining <= 7 ? 'text-amber-600' :\r\n                                'text-green-600'\r\n                              }`}>\r\n                                {daysRemaining < 0 ? 'Expired' : `${daysRemaining} days`}\r\n                              </span>\r\n                            ) : (\r\n                              <span className=\"text-sm text-gray-500\">-</span>\r\n                            )}\r\n                          </td>\r\n                          <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                            {seller.last_payment_amount ? (\r\n                              <div>\r\n                                <div className=\"text-sm text-gray-900\">\r\n                                  GH₵ {seller.last_payment_amount.toFixed(2)}\r\n                                </div>\r\n                                {seller.last_payment_date && (\r\n                                  <div className=\"text-sm text-gray-500\">\r\n                                    {new Date(seller.last_payment_date).toLocaleDateString()}\r\n                                  </div>\r\n                                )}\r\n                              </div>\r\n                            ) : (\r\n                              <span className=\"text-sm text-gray-500\">No payment</span>\r\n                            )}\r\n                          </td>\r\n                          <td className=\"px-6 py-4 whitespace-nowrap text-sm\">\r\n                            <div className=\"flex gap-2\">\r\n                              <button\r\n                                onClick={() => handleManualRenewal(seller.user_id)}\r\n                                className=\"text-sky-600 hover:text-sky-800 font-medium cursor-pointer\"\r\n                              >\r\n                                Renew\r\n                              </button>\r\n                              {seller.subscription_status === 'active' && (\r\n                                <button\r\n                                  onClick={() => handleSuspendSeller(seller.user_id)}\r\n                                  className=\"text-red-600 hover:text-red-800 font-medium cursor-pointer\"\r\n                                >\r\n                                  Suspend\r\n                                </button>\r\n                              )}\r\n                            </div>\r\n                          </td>\r\n                        </tr>\r\n                      );\r\n                    })}\r\n                  </tbody>\r\n                </table>\r\n\r\n                {filteredSellers.length === 0 && (\r\n                  <div className=\"text-center py-12\">\r\n                    <i className=\"ri-store-line text-5xl text-gray-300\"></i>\r\n                    <p className=\"mt-4 text-gray-500\">No sellers found</p>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            ) : (\r\n              <div className=\"overflow-x-auto\">\r\n                <table className=\"w-full\">\r\n                  <thead className=\"bg-gray-50 border-b border-gray-200\">\r\n                    <tr>\r\n                      <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                        Seller\r\n                      </th>\r\n                      <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                        Amount\r\n                      </th>\r\n                      <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                        Reference\r\n                      </th>\r\n                      <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                        Status\r\n                      </th>\r\n                      <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                        Subscription Period\r\n                      </th>\r\n                      <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                        Date\r\n                      </th>\r\n                    </tr>\r\n                  </thead>\r\n                  <tbody className=\"bg-white divide-y divide-gray-200\">\r\n                    {filteredPayments.map((payment) => (\r\n                      <tr key={payment.id} className=\"hover:bg-gray-50\">\r\n                        <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                          <div>\r\n                            <div className=\"text-sm font-medium text-gray-900\">\r\n                              {payment.profiles.full_name}\r\n                            </div>\r\n                            <div className=\"text-sm text-gray-500\">{payment.profiles.email}</div>\r\n                          </div>\r\n                        </td>\r\n                        <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                          <div className=\"text-sm font-medium text-gray-900\">\r\n                            {payment.currency} {payment.amount.toFixed(2)}\r\n                          </div>\r\n                        </td>\r\n                        <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                          <div className=\"text-sm text-gray-900 font-mono\">\r\n                            {payment.payment_reference}\r\n                          </div>\r\n                        </td>\r\n                        <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                          <span className={`px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${\r\n                            payment.payment_status === 'success'\r\n                              ? 'bg-green-100 text-green-800'\r\n                              : payment.payment_status === 'pending'\r\n                              ? 'bg-yellow-100 text-yellow-800'\r\n                              : 'bg-red-100 text-red-800'\r\n                          }`}>\r\n                            {payment.payment_status}\r\n                          </span>\r\n                        </td>\r\n                        <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                          <div className=\"text-sm text-gray-900\">\r\n                            {new Date(payment.subscription_start_date).toLocaleDateString()} -\r\n                          </div>\r\n                          <div className=\"text-sm text-gray-900\">\r\n                            {new Date(payment.subscription_end_date).toLocaleDateString()}\r\n                          </div>\r\n                        </td>\r\n                        <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">\r\n                          {new Date(payment.created_at).toLocaleDateString()}\r\n                        </td>\r\n                      </tr>\r\n                    ))}\r\n                  </tbody>\r\n                </table>\r\n\r\n                {filteredPayments.length === 0 && (\r\n                  <div className=\"text-center py-12\">\r\n                    <i className=\"ri-money-dollar-circle-line text-5xl text-gray-300\"></i>\r\n                    <p className=\"mt-4 text-gray-500\">No payments found</p>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":["SubscriptionManagement","navigate","useNavigate","profile","authLoading","useAuth","sellers","setSellers","useState","payments","setPayments","loading","setLoading","activeTab","setActiveTab","searchTerm","setSearchTerm","statusFilter","setStatusFilter","useEffect","fetchData","sellersData","sellersError","supabase","paymentsData","paymentsError","error","handleManualRenewal","sellerId","startDate","endDate","handleSuspendSeller","getDaysRemaining","end","now","filteredSellers","seller","matchesSearch","matchesStatus","filteredPayments","payment","stats","s","p","sum","jsxs","jsx","Navbar","e","daysRemaining"],"mappings":"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"}
import{j as e}from"./query-vendor-CC_3ftG1.js";import{u as k,f,r as a}from"./react-vendor-Bsfkyusf.js";import{u as w,s as n,N as _}from"./index-CcOhh2SE.js";import"./i18n-vendor-CQdsz7qV.js";import"./supabase-vendor-C3liu3n-.js";function S(){const{profile:r}=w(),s=k(),[l]=f(),[o,m]=a.useState([]),[g,c]=a.useState(!0),[i,x]=a.useState(l.get("filter")||"all");a.useEffect(()=>{if(r?.role!=="admin"&&r?.role!=="super_admin"){s("/marketplace");return}p();const t=n.channel("public:activity_logs").on("postgres_changes",{event:"INSERT",schema:"public",table:"activity_logs"},d=>{console.log("New activity:",d),p()}).subscribe();return()=>{n.removeChannel(t)}},[r]),a.useEffect(()=>{const t=l.get("filter");t&&x(t)},[l]);const p=async()=>{c(!0);const{data:t,error:d}=await n.from("activity_logs").select(`
        *,
        user:profiles!user_id(full_name, email)
      `).order("created_at",{ascending:!1}).limit(100);!d&&t&&m(t),c(!1)},b=i==="all"?o:o.filter(t=>t.action_type===i),h=t=>{switch(t){case"login":return"ri-login-box-line";case"logout":return"ri-logout-box-line";case"product_created":return"ri-add-box-line";case"product_updated":return"ri-edit-box-line";case"product_deleted":return"ri-delete-bin-line";case"message_sent":return"ri-message-line";case"sms_sent":return"ri-message-2-line";case"application_submitted":return"ri-file-list-line";case"application_approved":return"ri-checkbox-circle-line";case"application_rejected":return"ri-close-circle-line";case"news_created":return"ri-article-line";case"news_updated":return"ri-edit-2-line";case"news_published":return"ri-send-plane-fill";case"news_deleted":return"ri-delete-bin-2-line";default:return"ri-information-line"}},u=t=>{switch(t){case"login":return"bg-emerald-100 text-emerald-700 dark:bg-emerald-900/30 dark:text-emerald-400";case"logout":return"bg-slate-100 text-slate-700 dark:bg-slate-800 dark:text-slate-400";case"product_created":return"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400";case"product_updated":return"bg-amber-100 text-amber-700 dark:bg-amber-900/30 dark:text-amber-400";case"product_deleted":return"bg-rose-100 text-rose-700 dark:bg-rose-900/30 dark:text-rose-400";case"message_sent":return"bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-400";case"sms_sent":return"bg-indigo-100 text-indigo-700 dark:bg-indigo-900/30 dark:text-indigo-400";case"application_submitted":return"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400";case"application_approved":return"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400";case"application_rejected":return"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400";case"news_created":return"bg-cyan-100 text-cyan-700 dark:bg-cyan-900/30 dark:text-cyan-400";case"news_updated":return"bg-teal-100 text-teal-700 dark:bg-teal-900/30 dark:text-teal-400";case"news_published":return"bg-indigo-100 text-indigo-700 dark:bg-indigo-900/30 dark:text-indigo-400";case"news_deleted":return"bg-pink-100 text-pink-700 dark:bg-pink-900/30 dark:text-pink-400";default:return"bg-slate-100 text-slate-700 dark:bg-slate-800 dark:text-slate-400"}};return e.jsxs("div",{className:"min-h-screen bg-slate-50 dark:bg-slate-900 transition-colors duration-300 pb-20 font-sans",children:[e.jsx(_,{}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pt-28 pb-12 box-border",children:[e.jsxs("div",{className:"mb-8 flex flex-col md:flex-row md:items-end justify-between gap-6",children:[e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center gap-2 mb-2",children:e.jsx("span",{className:"px-3 py-1 rounded-full bg-amber-100 dark:bg-amber-900/30 text-amber-700 dark:text-amber-300 text-[10px] font-bold uppercase tracking-widest border border-amber-200 dark:border-amber-800",children:"Security & Logs"})}),e.jsx("h1",{className:"text-3xl md:text-5xl font-black text-slate-900 dark:text-white tracking-tight mb-2",children:"Audit Trails"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 font-medium",children:"Real-time monitoring of platform events and security actions."})]}),e.jsxs("button",{onClick:()=>s("/admin/dashboard"),className:"px-6 py-3 bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl text-xs font-bold uppercase tracking-wide shadow-sm hover:shadow-md transition-all cursor-pointer flex items-center gap-2",children:[e.jsx("i",{className:"ri-arrow-left-line text-lg"})," Dashboard"]})]}),e.jsx("div",{className:"bg-white dark:bg-slate-800 rounded-2xl border border-slate-100 dark:border-slate-700 p-2 mb-8 shadow-sm overflow-x-auto",children:e.jsx("div",{className:"flex items-center space-x-2",children:[{id:"all",label:"All History"},{id:"login",label:"Login History"},{id:"application_submitted",label:"New Applications"},{id:"application_approved",label:"Approved Applications"},{id:"application_rejected",label:"Rejected Applications"},{id:"product_created",label:"Product History"},{id:"sms_sent",label:"SMS History"},{id:"message_sent",label:"Message History"},{id:"news_created",label:"News Created"},{id:"news_updated",label:"News Updated"},{id:"news_published",label:"News Published"}].map(t=>e.jsx("button",{onClick:()=>{x(t.id),s(`?filter=${t.id}`,{replace:!0})},className:`px-4 py-2 text-xs font-bold uppercase tracking-wide rounded-xl transition-all whitespace-nowrap cursor-pointer ${i===t.id?"bg-slate-900 dark:bg-white text-white dark:text-slate-900 shadow-md":"text-slate-500 hover:bg-slate-50 dark:hover:bg-slate-700"}`,children:t.label},t.id))})}),e.jsx("div",{className:"bg-white dark:bg-slate-800 rounded-[2rem] border border-slate-100 dark:border-slate-700 shadow-sm p-6 md:p-8",children:g?e.jsxs("div",{className:"text-center py-20",children:[e.jsx("div",{className:"inline-block w-10 h-10 border-4 border-slate-200 border-t-slate-800 rounded-full animate-spin"}),e.jsx("p",{className:"mt-4 text-xs font-bold uppercase tracking-widest text-slate-400",children:"Loading logs..."})]}):b.length===0?e.jsxs("div",{className:"text-center py-20",children:[e.jsx("div",{className:"w-20 h-20 bg-slate-50 dark:bg-slate-700 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx("i",{className:"ri-history-line text-4xl text-slate-300 dark:text-slate-500"})}),e.jsx("h3",{className:"text-xl font-bold text-slate-900 dark:text-white mb-2",children:"No activities found"}),e.jsx("p",{className:"text-slate-500 max-w-sm mx-auto",children:"Activities will appear here as users interact with the platform."})]}):e.jsx("div",{className:"space-y-4",children:b.map(t=>e.jsxs("div",{className:"flex items-start space-x-4 p-4 rounded-2xl hover:bg-slate-50 dark:hover:bg-slate-700/30 transition-all border border-transparent hover:border-slate-100 dark:hover:border-slate-700 group",children:[e.jsx("div",{className:`w-12 h-12 rounded-2xl flex items-center justify-center flex-shrink-0 ${u(t.action_type)} group-hover:scale-110 transition-transform`,children:e.jsx("i",{className:`${h(t.action_type)} text-xl`})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("h3",{className:"text-sm font-bold text-slate-900 dark:text-white",children:t.user?.full_name||"System / Unknown"}),e.jsx("span",{className:"text-[10px] font-medium text-slate-400 uppercase tracking-wide",children:new Date(t.created_at).toLocaleString()})]}),e.jsx("div",{className:"flex items-center gap-2 mb-1",children:e.jsx("span",{className:`px-2 py-0.5 rounded text-[10px] font-bold uppercase tracking-wide ${u(t.action_type)} bg-opacity-20`,children:t.action_type.split("_").join(" ")})}),t.action_details&&e.jsx("div",{className:"text-xs text-slate-500 dark:text-slate-400 font-mono bg-slate-50 dark:bg-slate-900/50 p-3 rounded-xl mt-2 overflow-x-auto border border-slate-100 dark:border-slate-800",children:typeof t.action_details=="string"?t.action_details:JSON.stringify(t.action_details,null,2)})]})]},t.id))})})]})]})}export{S as default};
//# sourceMappingURL=ActivityMonitor-BG4NTKJp.js.map

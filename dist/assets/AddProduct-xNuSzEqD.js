const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-CcOhh2SE.js","assets/query-vendor-CC_3ftG1.js","assets/react-vendor-Bsfkyusf.js","assets/i18n-vendor-CQdsz7qV.js","assets/supabase-vendor-C3liu3n-.js","assets/index-1ug13H_y.css"])))=>i.map(i=>d[i]);
import{_ as U}from"./supabase-vendor-C3liu3n-.js";import{j as e}from"./query-vendor-CC_3ftG1.js";import{u as X,r as c}from"./react-vendor-Bsfkyusf.js";import{u as z,s as p,N as O,I as B}from"./index-CcOhh2SE.js";import"./i18n-vendor-CQdsz7qV.js";const D=["Electronics","Books & Stationery","Fashion & Accessories","Food & Beverages","Sports & Fitness","Home & Living","Services","Other"];function Y(){const x=X(),{profile:r,loading:m}=z(),[j,y]=c.useState(!1),[k,_]=c.useState([]),[I,v]=c.useState([]),[s,i]=c.useState({name:"",description:"",category:"",price:"",priceType:"fixed",images:[],sellerId:"",whatsappNumber:""}),[S,E]=c.useState({}),[d,u]=c.useState(null),b=60,P=1e3,n=r?.role==="admin"||r?.role==="super_admin";c.useEffect(()=>{if(d){const t=setTimeout(()=>u(null),4e3);return()=>clearTimeout(t)}},[d]),c.useEffect(()=>{(async()=>{if(!m){if(r?.role!=="seller"&&r?.role!=="admin"&&r?.role!=="super_admin"){x("/seller/status");return}if(r?.role==="seller"&&!n)try{const{data:a}=await p.from("platform_settings").select("value").eq("key","subscriptions_enabled").maybeSingle();if(a?a.value:!0){const{data:o}=await p.from("seller_profiles").select("subscription_status").eq("user_id",r.id).maybeSingle();o&&o.subscription_status!=="active"&&(alert("You must have an active subscription to verify and list products."),x("/seller/dashboard"))}}catch(a){console.error("Error checking subscription:",a)}}})()},[r,m,x,n]),c.useEffect(()=>{n?T():r?.id&&i(t=>({...t,sellerId:r.id})),r?.phone&&!s.whatsappNumber&&i(t=>({...t,whatsappNumber:r.phone||""}))},[n,r]);const T=async()=>{try{const{data:t,error:a}=await p.from("profiles").select("id, full_name, email").in("role",["seller","admin","super_admin"]).order("full_name");if(a)throw a;_(t||[])}catch(t){console.error("Error fetching sellers:",t)}},C=()=>{const t={};return s.name.trim()?s.name.length>b&&(t.name=`Name must be less than ${b} characters`):t.name="Product name is required",s.category||(t.category="Please select a category"),s.priceType==="fixed"&&(s.price?parseFloat(s.price)<=0&&(t.price="Price must be greater than 0"):t.price="Price is required"),s.whatsappNumber||(t.whatsappNumber="WhatsApp number is required"),s.images.length===0&&(t.images="At least 1 image is required"),s.images.length>8&&(t.images="Maximum 8 images allowed"),n&&!s.sellerId&&(t.sellerId="Please select a merchant"),E(t),Object.keys(t).length===0},q=async t=>{const a=localStorage.getItem("sys_admin_bypass")==="true",l=localStorage.getItem("sys_admin_secret");if(a&&l){const{data:o,error:h}=await p.rpc("admin_insert_product",{product_data:t,secret_key:l});return{error:h}}return await p.from("products").insert([t])},F=async t=>{if(t.preventDefault(),!C()){Object.values(S)[0]&&u({type:"error",message:"Please fix the errors in the form"});return}y(!0);try{const{uploadImage:a,compressImage:l}=await U(async()=>{const{uploadImage:g,compressImage:f}=await import("./index-CcOhh2SE.js").then(w=>w.k);return{uploadImage:g,compressImage:f}},__vite__mapDeps([0,1,2,3,4,5])),o=I.map(async g=>{const f=await l(g),{url:w}=await a(f,"products",n?s.sellerId:r?.id);return w}),h=await Promise.all(o),M={seller_id:n?s.sellerId:r?.id,name:s.name.trim(),description:s.description.trim(),category:s.category,price:s.priceType==="fixed"?parseFloat(s.price):null,price_type:s.priceType,images:h,whatsapp_number:s.whatsappNumber,is_active:!0},{error:N}=await q(M);if(N)throw N;u({type:"success",message:"Product successfully listed!"}),setTimeout(()=>{x(n?"/admin/dashboard":"/seller/dashboard")},1500)}catch(a){console.error("Error adding product:",a),u({type:"error",message:a.message||"Failed to add product"})}finally{y(!1)}},L=t=>{const a=URL.createObjectURL(t);v(l=>[...l,t]),i(l=>({...l,images:[...l.images,a]}))},A=t=>{s.images[t].startsWith("blob:")&&URL.revokeObjectURL(s.images[t]),v(a=>a.filter((l,o)=>o!==t)),i(a=>({...a,images:a.images.filter((l,o)=>o!==t)}))};return m?e.jsx("div",{className:"min-h-screen bg-slate-50 dark:bg-slate-900 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("i",{className:"ri-loader-4-line text-4xl text-teal-600 animate-spin"}),e.jsx("p",{className:"mt-4 text-slate-600 dark:text-slate-400",children:"Loading..."})]})}):e.jsxs("div",{className:"min-h-screen bg-slate-50 dark:bg-slate-900 transition-colors duration-300 pb-20 font-sans",children:[e.jsx(O,{}),d&&e.jsx("div",{className:"fixed top-24 left-1/2 -translate-x-1/2 z-50 animate-in fade-in slide-in-from-top-4 duration-300",children:e.jsxs("div",{className:`px-6 py-3 rounded-2xl shadow-xl border flex items-center gap-3 ${d.type==="success"?"bg-emerald-500 border-emerald-400 text-white":d.type==="error"?"bg-rose-500 border-rose-400 text-white":"bg-blue-500 border-blue-400 text-white"}`,children:[e.jsx("i",{className:d.type==="success"?"ri-checkbox-circle-line":d.type==="error"?"ri-error-warning-line":"ri-information-line"}),e.jsx("p",{className:"text-sm font-bold uppercase tracking-wide",children:d.message})]})}),e.jsxs("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-28 md:py-36",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-end justify-between gap-10 mb-20",children:[e.jsxs("div",{className:"text-center lg:text-left",children:[e.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-600 text-white text-[10px] font-black uppercase tracking-[0.2em] rounded-full mb-8 shadow-xl shadow-blue-500/20",children:[e.jsx("i",{className:"ri-shopping-bag-3-line"}),"Inventory Console"]}),e.jsxs("h1",{className:"text-5xl md:text-8xl font-black text-slate-900 dark:text-white tracking-tighter leading-none mb-6",children:["Stock Your",e.jsx("br",{}),e.jsx("span",{className:"text-blue-600",children:"Storefront."})]}),e.jsxs("p",{className:"max-w-xl text-slate-500 dark:text-slate-400 font-bold uppercase tracking-widest text-[10px] flex items-center gap-3 justify-center lg:justify-start",children:[e.jsx("span",{className:"w-10 h-[2px] bg-blue-600/30"}),n?"Global Merchant Operations Center":"Launch your next product to the campus community"]})]}),e.jsxs("button",{onClick:()=>x(n?"/admin/dashboard":"/seller/dashboard"),className:"h-16 px-8 bg-white dark:bg-slate-800 text-slate-400 hover:text-rose-500 border border-slate-100 dark:border-slate-700 font-black rounded-2xl transition-all text-xs uppercase tracking-widest flex items-center justify-center gap-3 active:scale-95 group",children:[e.jsx("i",{className:"ri-close-circle-line text-xl group-hover:rotate-90 transition-transform duration-500"}),"Discard Entry"]})]}),e.jsxs("div",{className:"flex flex-col-reverse xl:grid xl:grid-cols-5 gap-10",children:[e.jsx("div",{className:"xl:col-span-3 space-y-10",children:e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-[3rem] shadow-2xl shadow-slate-200/50 dark:shadow-none border border-slate-100 dark:border-slate-800 p-8 md:p-14 relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-blue-500/5 rounded-full blur-3xl -mr-32 -mt-32"}),e.jsxs("form",{onSubmit:F,className:"space-y-12 relative z-10",children:[n&&e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-950 p-8 rounded-[2rem] border border-slate-100 dark:border-slate-800 space-y-4",children:[e.jsx("label",{className:"block text-[10px] font-black text-slate-400 uppercase tracking-widest ml-1",children:"Target Merchant Account"}),e.jsxs("div",{className:"relative group",children:[e.jsxs("select",{value:s.sellerId,onChange:t=>i({...s,sellerId:t.target.value}),className:"w-full px-8 py-5 bg-white dark:bg-slate-900 border-2 border-slate-100 dark:border-slate-800 focus:border-blue-500/30 rounded-2xl font-bold outline-none text-sm text-slate-900 dark:text-white transition-all appearance-none cursor-pointer",required:!0,children:[e.jsx("option",{value:"",children:"Select Merchant..."}),k.map(t=>e.jsx("option",{value:t.id,children:t.full_name},t.id))]}),e.jsx("i",{className:"ri-arrow-down-s-line absolute right-6 top-1/2 -translate-y-1/2 text-slate-400"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-10",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center px-1",children:[e.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest",children:"Product Identity"}),e.jsxs("span",{className:"text-[9px] font-bold text-slate-300",children:[s.name.length,"/",b]})]}),e.jsx("input",{type:"text",required:!0,value:s.name,onChange:t=>i({...s,name:t.target.value}),className:"w-full px-8 py-5 bg-slate-50/50 dark:bg-slate-950 border-2 border-transparent focus:border-blue-500/20 rounded-2xl font-bold outline-none text-sm text-slate-900 dark:text-white transition-all placeholder:text-slate-300",placeholder:"e.g. MacBook Pro 2021"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest px-1",children:"Market Category"}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{required:!0,value:s.category,onChange:t=>i({...s,category:t.target.value}),className:"w-full px-8 py-5 bg-slate-50/50 dark:bg-slate-950 border-2 border-transparent focus:border-blue-500/20 rounded-2xl font-bold outline-none text-sm text-slate-900 dark:text-white transition-all appearance-none cursor-pointer",children:[e.jsx("option",{value:"",children:"Choose category..."}),D.map(t=>e.jsx("option",{value:t,children:t},t))]}),e.jsx("i",{className:"ri-arrow-down-s-line absolute right-6 top-1/2 -translate-y-1/2 text-slate-400"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center px-1",children:[e.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest",children:"Inventory Story"}),e.jsxs("span",{className:"text-[9px] font-bold text-slate-300",children:[s.description.length,"/",P]})]}),e.jsx("textarea",{value:s.description,onChange:t=>i({...s,description:t.target.value}),rows:5,className:"w-full px-8 py-6 bg-slate-50/50 dark:bg-slate-950 border-2 border-transparent focus:border-blue-500/20 rounded-3xl font-bold outline-none text-sm text-slate-900 dark:text-white transition-all resize-none placeholder:text-slate-300",placeholder:"Tell buyers why they need this..."})]}),e.jsxs("div",{className:"bg-slate-50/50 dark:bg-slate-950 p-8 rounded-[2.5rem] border border-slate-100 dark:border-slate-800 space-y-8",children:[e.jsx("div",{className:"flex flex-col sm:flex-row gap-4",children:["fixed","contact"].map(t=>e.jsxs("button",{type:"button",onClick:()=>i({...s,priceType:t}),className:`flex-1 p-6 rounded-3xl border-2 transition-all group flex flex-col items-center gap-3 ${s.priceType===t?"bg-blue-600 border-blue-600 text-white shadow-xl shadow-blue-500/20":"bg-white dark:bg-slate-900 border-slate-100 dark:border-slate-800 text-slate-500"}`,children:[e.jsx("i",{className:`${t==="fixed"?"ri-price-tag-3-line":"ri-exchange-line"} text-2xl`}),e.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:t==="fixed"?"Set Price":"Negotiable"})]},t))}),s.priceType==="fixed"&&e.jsxs("div",{className:"relative max-w-xs transition-all ring-offset-2 focus-within:ring-4 ring-blue-500/10 rounded-2xl",children:[e.jsx("span",{className:"absolute left-8 top-1/2 -translate-y-1/2 font-black text-2xl text-slate-300",children:"GHâ‚µ"}),e.jsx("input",{type:"number",step:"0.01",value:s.price,onChange:t=>i({...s,price:t.target.value}),className:"w-full pl-24 pr-8 py-6 bg-white dark:bg-slate-900 border-none rounded-2xl font-black text-3xl text-slate-900 dark:text-white placeholder:text-slate-200 outline-none",placeholder:"0.00",required:s.priceType==="fixed"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest px-1",children:"Business Line (WhatsApp)"}),e.jsxs("div",{className:"relative group",children:[e.jsx("i",{className:"ri-whatsapp-fill absolute left-8 top-1/2 -translate-y-1/2 text-emerald-500 text-2xl"}),e.jsx("input",{type:"tel",required:!0,value:s.whatsappNumber,onChange:t=>i({...s,whatsappNumber:t.target.value}),className:"w-full pl-16 pr-8 py-6 bg-slate-50/50 dark:bg-slate-950 border-2 border-transparent focus:border-emerald-500/20 rounded-2xl font-black text-lg text-slate-900 dark:text-white outline-none transition-all",placeholder:"054XXXXXXXX"})]})]}),e.jsx("button",{type:"submit",disabled:j,className:"w-full h-20 bg-slate-900 dark:bg-white text-white dark:text-slate-900 rounded-[2.2rem] font-black text-sm uppercase tracking-widest hover:scale-[1.02] active:scale-95 transition-all shadow-2xl disabled:opacity-50 flex items-center justify-center gap-4 cursor-pointer",children:j?e.jsx("i",{className:"ri-loader-4-line animate-spin text-2xl"}):e.jsxs(e.Fragment,{children:["Publish to Marketplace",e.jsx("i",{className:"ri-rocket-fill text-xl text-blue-400 dark:text-blue-600"})]})})]})]})}),e.jsxs("div",{className:"xl:col-span-2 space-y-8",children:[e.jsxs("div",{className:"bg-slate-900 dark:bg-black p-10 rounded-[3rem] text-white shadow-2xl relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 left-0 w-full h-full bg-gradient-to-tr from-blue-600/10 to-transparent"}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("h3",{className:"text-2xl font-black mb-10 tracking-tight flex items-center gap-4",children:[e.jsx("i",{className:"ri-gallery-fill text-blue-400"}),"Media Gallery"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-5 mb-10",children:[s.images.map((t,a)=>e.jsxs("div",{className:"aspect-square rounded-3xl overflow-hidden bg-slate-800 relative group border border-slate-700/50",children:[e.jsx("img",{src:t,className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-700"}),e.jsx("button",{onClick:()=>A(a),className:"absolute top-3 right-3 w-8 h-8 bg-rose-600 rounded-full flex items-center justify-center shadow-2xl opacity-0 group-hover:opacity-100 transition-all active:scale-90",children:e.jsx("i",{className:"ri-close-line"})}),a===0&&e.jsx("div",{className:"absolute inset-x-0 bottom-0 bg-blue-600/90 py-2 text-[8px] font-black uppercase tracking-widest text-center backdrop-blur-md",children:"Headline Image"})]},a)),s.images.length<8&&e.jsxs("div",{className:"aspect-square bg-white/5 border-2 border-dashed border-white/10 rounded-3xl relative group hover:bg-white/10 transition-all cursor-pointer",children:[e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center gap-3 text-slate-500 group-hover:text-blue-400 transition-colors pointer-events-none z-0",children:[e.jsx("i",{className:"ri-image-add-line text-3xl group-hover:scale-110 transition-transform duration-300"}),e.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:"Add Photo"})]}),e.jsx(B,{folder:"products",autoUpload:!1,onFileSelected:L,hideInternalUI:!0,size:"custom",noBorder:!0,className:"absolute inset-0 z-10 w-full h-full"})]})]}),e.jsxs("div",{className:"p-6 bg-white/5 rounded-3xl border border-white/5",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-slate-500",children:"Inventory Slot"}),e.jsxs("span",{className:"text-xs font-black text-blue-400",children:[s.images.length,"/8"]})]}),e.jsx("div",{className:"w-full h-2 bg-white/5 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-blue-500 transition-all duration-500",style:{width:`${s.images.length/8*100}%`}})})]})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-blue-600 to-indigo-700 p-10 rounded-[3rem] text-white shadow-2xl shadow-blue-500/20 group translate-y-0 hover:-translate-y-2 transition-transform duration-500",children:[e.jsx("i",{className:"ri-shield-user-fill text-4xl text-blue-200 mb-8 block group-hover:rotate-12 transition-transform"}),e.jsx("h4",{className:"text-xl font-black mb-4 tracking-tight",children:"Enterprise Safety"}),e.jsx("p",{className:"text-blue-100 text-xs font-bold leading-relaxed uppercase tracking-wider opacity-80",children:"All campus listings are cryptographically signed and monitored for community compliance."})]})]})]})]})]})}export{Y as default};
//# sourceMappingURL=AddProduct-xNuSzEqD.js.map

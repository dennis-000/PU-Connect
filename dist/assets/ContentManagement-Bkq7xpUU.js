import{j as e}from"./query-vendor-CC_3ftG1.js";import{u as C,r as n}from"./react-vendor-Bsfkyusf.js";import{u as S,s as o,N as _,I as E}from"./index-CcOhh2SE.js";import{C as d}from"./useSiteContent-Daxp1dB1.js";import"./i18n-vendor-CQdsz7qV.js";import"./supabase-vendor-C3liu3n-.js";function O(){const{profile:c}=S(),p=C(),[x,g]=n.useState("images"),[i,u]=n.useState({}),[y,b]=n.useState(!0),[N,h]=n.useState(!1),[r,m]=n.useState(null);n.useEffect(()=>{if(c?.role!=="admin"&&c?.role!=="super_admin"){p("/marketplace");return}j();const a=o.channel("online-users");return a.on("presence",{event:"join"},({key:l,newPresences:t})=>{const s=t[0];s&&s.user_id!==c?.id&&m({type:"info",message:`${s.full_name||"A user"} came online`})}).subscribe(),()=>{o.removeChannel(a)}},[]),n.useEffect(()=>{if(r){const a=setTimeout(()=>m(null),4e3);return()=>clearTimeout(a)}},[r]);const j=async()=>{try{const{data:a,error:l}=await o.storage.from("uploads").download("site_config.json");if(l){console.warn("No config found or error:",l.message),b(!1);return}if(a){const t=await a.text();u(JSON.parse(t))}}catch(a){console.error("Error fetching config:",a)}finally{b(!1)}},f=async(a,l)=>{const t={...i,[a]:l};u(t),h(!0);try{const s=new Blob([JSON.stringify(t)],{type:"application/json"}),{error:k}=await o.storage.from("uploads").upload("site_config.json",s,{contentType:"application/json",upsert:!0});if(k)throw k;localStorage.setItem(`site_content_${a}`,l)}catch(s){console.error("Failed to save config:",s),m({type:"error",message:"Failed to save changes"})}finally{h(!1)}},w=[{title:"Home Page Hero",description:"The main slider images visible on the landing page.",items:[{label:"Main Hero Image",key:d.HOME_HERO_MAIN,type:"image"},{label:"Secondary/Aerial Image",key:d.HOME_HERO_AERIAL,type:"image"}]},{title:"Section Banners",description:"Header images for specific site sections.",items:[{label:"Marketplace Header",key:d.MARKETPLACE_BANNER,type:"image"},{label:"Campus News Header",key:d.NEWS_BANNER,type:"image"}]}],v=x==="images"?w:[{title:"Vital Announcements",description:"Important text displayed on the home page.",items:[{label:"Announcement 1",key:"home_announcement_1",type:"text",placeholder:"e.g. SRC Week starts next Monday!"},{label:"Announcement 2",key:"home_announcement_2",type:"text",placeholder:"e.g. Exam registration deadline extended."},{label:"Hero Headline",key:"home_hero_headline",type:"text",placeholder:"e.g. The Future of Campus Living"}]}];return e.jsxs("div",{className:"min-h-screen bg-slate-50 dark:bg-slate-900 transition-colors duration-300 pb-20 font-sans",children:[e.jsx(_,{}),r&&e.jsxs("div",{className:`fixed top-24 right-4 md:right-8 z-50 animate-in fade-in slide-in-from-right-8 duration-300 px-6 py-4 rounded-2xl shadow-2xl border flex items-center gap-3 backdrop-blur-md ${r.type==="success"?"bg-emerald-500/90 border-emerald-400/50 text-white":r.type==="error"?"bg-rose-500/90 border-rose-400/50 text-white":"bg-blue-500/90 border-blue-400/50 text-white"}`,children:[e.jsx("i",{className:`${r.type==="success"?"ri-checkbox-circle-fill":r.type==="error"?"ri-error-warning-fill":"ri-notification-3-fill"} text-xl`}),e.jsx("span",{className:"font-bold text-sm tracking-wide",children:r.message})]}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pt-32 md:pt-40 pb-12 box-border",children:[e.jsxs("div",{className:"mb-12",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-end justify-between gap-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1 bg-cyan-600 dark:bg-cyan-500 text-white text-[10px] font-bold uppercase tracking-[0.2em] rounded-full mb-6",children:[e.jsx("i",{className:"ri-layout-masonry-line"}),"CMS Portal 1.0"]}),e.jsxs("h1",{className:"text-4xl md:text-5xl font-black text-slate-900 dark:text-white tracking-tight leading-none mb-4",children:["Content",e.jsx("br",{}),e.jsx("span",{className:"text-slate-400 dark:text-slate-600",children:"Manager."})]}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 font-bold uppercase tracking-widest text-xs",children:"Update site imagery and assets in real-time."})]}),e.jsx("div",{className:"flex gap-3",children:e.jsxs("button",{onClick:()=>p("/admin/dashboard"),className:"px-6 py-3 bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 text-slate-700 dark:text-slate-200 rounded-xl hover:bg-slate-50 dark:hover:bg-slate-700 transition-colors text-xs font-bold uppercase tracking-wide whitespace-nowrap cursor-pointer flex items-center gap-2",children:[e.jsx("i",{className:"ri-arrow-left-line text-lg"}),"Dashboard"]})})]}),e.jsxs("div",{className:"mt-8 bg-white dark:bg-slate-800 p-1 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700 inline-flex",children:[e.jsxs("button",{onClick:()=>g("images"),className:`px-6 py-2.5 rounded-lg text-xs font-bold uppercase tracking-widest transition-all ${x==="images"?"bg-cyan-600 text-white shadow-md":"text-slate-500 dark:text-slate-400 hover:bg-slate-50 dark:hover:bg-slate-700"}`,children:[e.jsx("i",{className:"ri-image-line mr-2"}),"Imagery"]}),e.jsxs("button",{onClick:()=>g("text"),className:`px-6 py-2.5 rounded-lg text-xs font-bold uppercase tracking-widest transition-all ${x==="text"?"bg-cyan-600 text-white shadow-md":"text-slate-500 dark:text-slate-400 hover:bg-slate-50 dark:hover:bg-slate-700"}`,children:[e.jsx("i",{className:"ri-text mr-2"}),"Text Content"]})]})]}),y?e.jsxs("div",{className:"py-20 text-center",children:[e.jsx("div",{className:"w-10 h-10 border-4 border-cyan-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-slate-400 font-bold uppercase tracking-widest text-xs",children:"Loading Configuration..."})]}):e.jsx("div",{className:"space-y-16",children:v.map((a,l)=>e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-[2.5rem] p-8 md:p-12 shadow-sm border border-slate-100 dark:border-slate-700",children:[e.jsxs("div",{className:"mb-10",children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900 dark:text-white tracking-tight",children:a.title}),e.jsx("p",{className:"text-slate-400 dark:text-slate-500 text-xs font-bold uppercase tracking-widest mt-2",children:a.description})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-12",children:a.items.map(t=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-bold text-slate-700 dark:text-slate-300",children:t.label}),i[t.key]&&e.jsx("span",{className:"text-[10px] font-bold text-emerald-500 bg-emerald-50 dark:bg-emerald-900/20 px-3 py-1 rounded-full uppercase tracking-wide",children:"Live"})]}),t.type==="image"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative group",children:[e.jsx(E,{currentImage:i[t.key],onImageUploaded:s=>f(t.key,s),folder:"cms",size:"large",shape:"square",className:"w-full aspect-video h-auto rounded-2xl overflow-hidden"}),N&&e.jsx("div",{className:"absolute top-4 right-4 bg-black/80 text-white text-[10px] font-bold px-3 py-1 rounded-full animate-pulse",children:"Saving..."})]}),e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-900 p-4 rounded-xl break-all border border-slate-100 dark:border-slate-700",children:[e.jsx("p",{className:"text-[10px] font-mono text-slate-400 mb-1 uppercase",children:"Asset URL"}),e.jsx("p",{className:"text-xs text-slate-600 dark:text-slate-300 line-clamp-2",children:i[t.key]||"Using System Default"})]})]}):e.jsxs("div",{className:"relative",children:[e.jsx("textarea",{value:i[t.key]||"",onChange:s=>f(t.key,s.target.value),placeholder:t.placeholder,rows:4,className:"w-full p-4 bg-slate-50 dark:bg-slate-900 border-none rounded-xl text-sm font-medium text-slate-900 dark:text-white focus:ring-2 focus:ring-cyan-500/20 focus:bg-white dark:focus:bg-slate-800 transition-all resize-none"}),e.jsxs("p",{className:"text-xs text-slate-400 mt-2 text-right",children:[i[t.key]?.length||0," characters"]})]})]},t.key))})]},l))})]})]})}export{O as default};
//# sourceMappingURL=ContentManagement-Bkq7xpUU.js.map

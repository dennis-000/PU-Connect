import{j as e}from"./query-vendor-Cpskl8RO.js";import{u as k,r}from"./react-vendor-Bsfkyusf.js";import{u as N,s as c,N as _,I as y}from"./index-4BAF1yr7.js";import"./i18n-vendor-CQdsz7qV.js";import"./supabase-vendor-C3liu3n-.js";function I(){const{profile:n}=N(),x=k(),[p,b]=r.useState([]),[g,h]=r.useState(!0),[f,d]=r.useState(!1),[o,m]=r.useState(null),[a,l]=r.useState({title:"",image_url:"",destination_url:"",placement_area:"home_hero",status:"active",start_date:new Date().toISOString().slice(0,16)});r.useEffect(()=>{if(n){if(!["admin","super_admin","news_publisher","publisher_seller"].includes(n?.role||"")){x("/");return}u()}},[n,x]);const u=async()=>{h(!0);try{const{data:t,error:s}=await c.from("advertisements").select("*").order("created_at",{ascending:!1});if(s)if(s.code==="42P01")console.warn("Advertisements table missing"),b([]);else throw s;else b(t||[])}catch(t){console.error("Error fetching ads:",t)}finally{h(!1)}},j=async t=>{t.preventDefault();try{const s={title:a.title,image_url:a.image_url,destination_url:a.destination_url,placement_area:a.placement_area,status:a.status,start_date:new Date(a.start_date).toISOString(),created_by:n?.id};if(o){const{error:i}=await c.from("advertisements").update(s).eq("id",o.id);if(i)throw i}else{const{error:i}=await c.from("advertisements").insert(s);if(i)throw i}d(!1),m(null),u()}catch(s){alert("Failed to save ad: "+s.message)}},v=async t=>{if(!confirm("Are you sure?"))return;const{error:s}=await c.from("advertisements").delete().eq("id",t);s?alert(s.message):u()},w=t=>{m(t),l({title:t.title,image_url:t.image_url,destination_url:t.destination_url||"",placement_area:t.placement_area,status:t.status,start_date:new Date(t.start_date).toISOString().slice(0,16)}),d(!0)};return e.jsxs("div",{className:"min-h-screen bg-slate-50 dark:bg-slate-900 transition-colors duration-300 pb-20 font-sans",children:[e.jsx(_,{}),e.jsxs("div",{className:"pt-32 pb-12 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-end justify-between gap-6 mb-10",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl md:text-5xl font-black text-slate-900 dark:text-white tracking-tight mb-2",children:"Ad Manager"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 font-medium",children:"Manage promotional content and banners."})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>x("/admin/dashboard"),className:"px-6 py-3 bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 text-slate-700 dark:text-slate-200 rounded-xl font-bold uppercase tracking-wide text-xs hover:bg-slate-50 transition-colors",children:"Back"}),e.jsx("button",{onClick:()=>{m(null),l({title:"",image_url:"",destination_url:"",placement_area:"home_hero",status:"active",start_date:new Date().toISOString().slice(0,16)}),d(!0)},className:"px-6 py-3 bg-blue-600 text-white rounded-xl font-bold uppercase tracking-wide text-xs hover:bg-blue-700 transition-colors shadow-lg shadow-blue-500/20",children:"+ New Ad Campaign"})]})]}),g?e.jsx("div",{className:"text-center py-20",children:"Loading..."}):p.length===0?e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-3xl p-16 text-center border border-slate-100 dark:border-slate-700",children:[e.jsx("div",{className:"w-20 h-20 bg-slate-50 dark:bg-slate-700 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx("i",{className:"ri-advertisement-line text-4xl text-slate-300"})}),e.jsx("h3",{className:"text-xl font-bold text-slate-900 dark:text-white mb-2",children:"No Active Campaigns"}),e.jsx("p",{className:"text-slate-500 mb-6",children:"Create your first advertisement to start promoting content."}),e.jsxs("div",{className:"bg-amber-50 dark:bg-amber-900/20 p-4 rounded-xl inline-block text-left max-w-md mx-auto",children:[e.jsx("p",{className:"text-xs font-bold text-amber-700 dark:text-amber-400 mb-1",children:"Database Setup Required?"}),e.jsxs("p",{className:"text-xs text-amber-600 dark:text-amber-500/80",children:["If you haven't run the migration script yet, please run ",e.jsx("code",{children:"database_enhancements.sql"})," in your Supabase SQL Editor."]})]})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:p.map(t=>e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl overflow-hidden border border-slate-100 dark:border-slate-700 shadow-sm group",children:[e.jsxs("div",{className:"h-48 bg-slate-100 dark:bg-slate-900 relative",children:[e.jsx("img",{src:t.image_url,alt:t.title,className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute top-2 right-2",children:e.jsx("span",{className:`px-2 py-1 text-[10px] font-bold uppercase tracking-wide rounded-md ${t.status==="active"?"bg-emerald-500 text-white":"bg-slate-500 text-white"}`,children:t.status})})]}),e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"font-bold text-slate-900 dark:text-white text-lg mb-1",children:t.title}),e.jsx("p",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest mb-4",children:t.placement_area}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 border-t border-slate-50 dark:border-slate-700 pt-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] text-slate-400 font-bold uppercase",children:"Impressions"}),e.jsx("p",{className:"text-lg font-black text-slate-900 dark:text-white",children:t.impressions_count})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] text-slate-400 font-bold uppercase",children:"Clicks"}),e.jsx("p",{className:"text-lg font-black text-slate-900 dark:text-white",children:t.clicks_count})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>w(t),className:"flex-1 py-2 bg-slate-50 dark:bg-slate-700 rounded-lg text-xs font-bold uppercase tracking-wide hover:bg-slate-100 transition-colors",children:"Edit"}),e.jsx("button",{onClick:()=>v(t.id),className:"px-3 py-2 bg-rose-50 dark:bg-rose-900/20 text-rose-600 rounded-lg hover:bg-rose-100 transition-colors",children:e.jsx("i",{className:"ri-delete-bin-line"})})]})]})]},t.id))})]}),f&&e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-3xl shadow-2xl max-w-lg w-full max-h-[90vh] overflow-y-auto border border-slate-100 dark:border-slate-800",children:[e.jsxs("div",{className:"p-6 border-b border-slate-100 dark:border-slate-800 flex justify-between items-center",children:[e.jsx("h3",{className:"text-xl font-bold text-slate-900 dark:text-white",children:o?"Edit Ad":"New Campaign"}),e.jsx("button",{onClick:()=>d(!1),children:e.jsx("i",{className:"ri-close-line text-2xl"})})]}),e.jsxs("form",{onSubmit:j,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold uppercase tracking-wide text-slate-500 mb-1",children:"Title"}),e.jsx("input",{type:"text",required:!0,value:a.title,onChange:t=>l({...a,title:t.target.value}),className:"w-full px-4 py-3 bg-slate-50 dark:bg-slate-800 rounded-xl"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold uppercase tracking-wide text-slate-500 mb-1",children:"Placement"}),e.jsxs("select",{value:a.placement_area,onChange:t=>l({...a,placement_area:t.target.value}),className:"w-full px-4 py-3 bg-slate-50 dark:bg-slate-800 rounded-xl",children:[e.jsx("option",{value:"home_hero",children:"Home Page Hero"}),e.jsx("option",{value:"marketplace_sidebar",children:"Marketplace Sidebar"}),e.jsx("option",{value:"news_feed",children:"News Feed"}),e.jsx("option",{value:"global_popup",children:"Global Popup"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold uppercase tracking-wide text-slate-500 mb-1",children:"Creative"}),e.jsxs("div",{className:"flex gap-4 items-center",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"text",placeholder:"Image URL",value:a.image_url,onChange:t=>l({...a,image_url:t.target.value}),className:"w-full px-4 py-3 bg-slate-50 dark:bg-slate-800 rounded-xl text-xs"})}),e.jsx("div",{className:"w-12 h-12",children:e.jsx(y,{onImageUploaded:t=>l({...a,image_url:t}),folder:"ads",className:"w-full h-full bg-slate-100 rounded-lg flex items-center justify-center cursor-pointer"})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold uppercase tracking-wide text-slate-500 mb-1",children:"Destination Link"}),e.jsx("input",{type:"url",placeholder:"https://",value:a.destination_url,onChange:t=>l({...a,destination_url:t.target.value}),className:"w-full px-4 py-3 bg-slate-50 dark:bg-slate-800 rounded-xl"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold uppercase tracking-wide text-slate-500 mb-1",children:"Status"}),e.jsxs("select",{value:a.status,onChange:t=>l({...a,status:t.target.value}),className:"w-full px-4 py-3 bg-slate-50 dark:bg-slate-800 rounded-xl",children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"paused",children:"Paused"}),e.jsx("option",{value:"expired",children:"Expired"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold uppercase tracking-wide text-slate-500 mb-1",children:"Start Date"}),e.jsx("input",{type:"datetime-local",value:a.start_date,onChange:t=>l({...a,start_date:t.target.value}),className:"w-full px-4 py-3 bg-slate-50 dark:bg-slate-800 rounded-xl"})]})]}),e.jsx("button",{type:"submit",className:"w-full py-4 bg-blue-600 text-white font-bold rounded-xl uppercase tracking-widest text-xs shadow-lg mt-4",children:o?"Update Campaign":"Launch Campaign"})]})]})})]})}export{I as default};
//# sourceMappingURL=AdsManagement-CvvWP5WT.js.map

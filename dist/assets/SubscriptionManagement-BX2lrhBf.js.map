{"version":3,"mappings":"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","names":["SubscriptionManagement","navigate","useNavigate","profile","authLoading","useAuth","sellers","setSellers","useState","payments","setPayments","loading","setLoading","activeTab","setActiveTab","searchTerm","setSearchTerm","statusFilter","setStatusFilter","subscriptionEnabled","setSubscriptionEnabled","updatingSettings","setUpdatingSettings","selectedSellers","setSelectedSellers","useEffect","fetchData","settingsData","supabase","sellersData","sellersError","paymentsData","paymentsError","error","handleToggleSubscription","newValue","isBypass","secret","existing","updateError","insertError","err","handleManualRenewal","sellerId","startDate","endDate","seller","s","phoneNumber","fullName","sendSMS","__vitePreload","name","smsError","handleBulkRenew","updatePromises","userId","handleBulkSuspend","handleSuspendSeller","handleGenerateInvoice","payment","statusColor","statusText","invoiceWindow","htmlContent","getDaysRemaining","end","now","filteredSellers","matchesSearch","matchesStatus","filteredPayments","handleSelectAll","e","handleSelectSeller","prev","id","stats","p","sum","jsx","jsxs","Navbar","daysRemaining"],"ignoreList":[],"sources":["../../src/pages/admin/SubscriptionManagement.tsx"],"sourcesContent":["import { useState, useEffect } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { useAuth } from '../../contexts/AuthContext';\r\nimport { supabase } from '../../lib/supabase';\r\nimport Navbar from '../../components/feature/Navbar';\r\n\r\ntype SellerProfile = {\r\n  id: string;\r\n  user_id: string;\r\n  business_name: string;\r\n  subscription_status: string;\r\n  subscription_start_date: string | null;\r\n  subscription_end_date: string | null;\r\n  last_payment_amount: number | null;\r\n  last_payment_date: string | null;\r\n  profiles: {\r\n    full_name: string;\r\n    email: string;\r\n    avatar_url: string | null;\r\n    phone: string | null;\r\n  };\r\n};\r\n\r\ntype Payment = {\r\n  id: string;\r\n  seller_id: string;\r\n  amount: number;\r\n  currency: string;\r\n  payment_reference: string;\r\n  payment_status: string;\r\n  subscription_start_date: string;\r\n  subscription_end_date: string;\r\n  created_at: string;\r\n  profiles: {\r\n    full_name: string;\r\n    email: string;\r\n  };\r\n};\r\n\r\nexport default function SubscriptionManagement() {\r\n  const navigate = useNavigate();\r\n  const { profile, loading: authLoading } = useAuth();\r\n  const [sellers, setSellers] = useState<SellerProfile[]>([]);\r\n  const [payments, setPayments] = useState<Payment[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [activeTab, setActiveTab] = useState<'sellers' | 'payments'>('sellers');\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [statusFilter, setStatusFilter] = useState('all');\r\n\r\n  // Platform Settings State\r\n  const [subscriptionEnabled, setSubscriptionEnabled] = useState(true);\r\n  const [updatingSettings, setUpdatingSettings] = useState(false);\r\n\r\n  // Bulk Selection State\r\n  const [selectedSellers, setSelectedSellers] = useState<string[]>([]);\r\n\r\n  useEffect(() => {\r\n    // Rely on ProtectedRoute for access control, but keep this as a failsafe\r\n    if (!authLoading && profile?.role !== 'admin' && profile?.role !== 'super_admin') {\r\n      navigate('/');\r\n    }\r\n  }, [profile, authLoading, navigate]);\r\n\r\n  useEffect(() => {\r\n    fetchData();\r\n  }, []);\r\n\r\n  const fetchData = async () => {\r\n    try {\r\n      // Fetch Subscription Setting\r\n      const { data: settingsData } = await supabase\r\n        .from('platform_settings')\r\n        .select('value')\r\n        .eq('key', 'subscriptions_enabled')\r\n        .maybeSingle();\r\n\r\n      if (settingsData) {\r\n        setSubscriptionEnabled(settingsData.value);\r\n      } else {\r\n        setSubscriptionEnabled(true);\r\n      }\r\n\r\n      const { data: sellersData, error: sellersError } = await supabase\r\n        .from('seller_profiles')\r\n        .select('*, profiles!seller_profiles_user_id_fkey(full_name, email, avatar_url, phone)')\r\n        .order('created_at', { ascending: false });\r\n\r\n      if (sellersError) throw sellersError;\r\n      setSellers(sellersData || []);\r\n\r\n      const { data: paymentsData, error: paymentsError } = await supabase\r\n        .from('subscription_payments')\r\n        .select('*, profiles!subscription_payments_seller_id_fkey(full_name, email)')\r\n        .order('created_at', { ascending: false });\r\n\r\n      if (paymentsError) throw paymentsError;\r\n      setPayments(paymentsData || []);\r\n    } catch (error) {\r\n      console.error('Error fetching data:', error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleToggleSubscription = async () => {\r\n    if (!confirm(`Are you sure you want to ${subscriptionEnabled ? 'DISABLE' : 'ENABLE'} subscriptions? \\n\\n${subscriptionEnabled ? 'Disabling means ALL sellers can post products for FREE.' : 'Enabling means sellers must pay to post products.'}`)) {\r\n      return;\r\n    }\r\n\r\n    setUpdatingSettings(true);\r\n    const newValue = !subscriptionEnabled;\r\n    try {\r\n      const isBypass = localStorage.getItem('sys_admin_bypass') === 'true';\r\n      const secret = localStorage.getItem('sys_admin_secret') || 'pentvars-sys-admin-x892';\r\n\r\n      if (isBypass && secret) {\r\n        const { error } = await supabase.rpc('sys_update_platform_setting', {\r\n          secret_key: secret,\r\n          setting_key: 'subscriptions_enabled',\r\n          setting_value: newValue\r\n        });\r\n        if (error) throw error;\r\n      } else {\r\n        const { data: existing } = await supabase.from('platform_settings').select('key').eq('key', 'subscriptions_enabled').maybeSingle();\r\n\r\n        if (!existing) {\r\n          const { error: insertError } = await supabase.from('platform_settings').insert({\r\n            key: 'subscriptions_enabled',\r\n            value: newValue\r\n          });\r\n          if (insertError) throw insertError;\r\n        } else {\r\n          const { error: updateError } = await supabase\r\n            .from('platform_settings')\r\n            .update({ value: newValue })\r\n            .eq('key', 'subscriptions_enabled');\r\n          if (updateError) throw updateError;\r\n        }\r\n      }\r\n\r\n      setSubscriptionEnabled(newValue);\r\n      alert(`Subscriptions are now ${newValue ? 'ENABLED' : 'DISABLED'} platform-wide.`);\r\n    } catch (err: any) {\r\n      console.error('Error updating settings:', err);\r\n      alert('Failed to update settings. ' + err.message);\r\n    } finally {\r\n      setUpdatingSettings(false);\r\n    }\r\n  };\r\n\r\n  const handleManualRenewal = async (sellerId: string) => {\r\n    if (!confirm('Manually renew this seller\\'s subscription for 1 month + 3 days?')) {\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const startDate = new Date();\r\n      const endDate = new Date();\r\n      endDate.setMonth(endDate.getMonth() + 1);\r\n      endDate.setDate(endDate.getDate() + 3);\r\n\r\n      const isBypass = localStorage.getItem('sys_admin_bypass') === 'true';\r\n      const secret = localStorage.getItem('sys_admin_secret') || 'pentvars-sys-admin-x892';\r\n\r\n      if (isBypass && secret) {\r\n        const { error } = await supabase.rpc('sys_manage_seller_subscription', {\r\n          secret_key: secret,\r\n          target_user_id: sellerId,\r\n          new_status: 'active',\r\n          start_date: startDate.toISOString(),\r\n          end_date: endDate.toISOString()\r\n        });\r\n        if (error) throw error;\r\n      } else {\r\n        const { error } = await supabase\r\n          .from('seller_profiles')\r\n          .update({\r\n            subscription_status: 'active',\r\n            subscription_start_date: startDate.toISOString(),\r\n            subscription_end_date: endDate.toISOString(),\r\n            last_payment_date: startDate.toISOString(),\r\n          })\r\n          .eq('user_id', sellerId);\r\n        if (error) throw error;\r\n      }\r\n\r\n      // SMS Notification\r\n      try {\r\n        const seller = sellers.find(s => s.user_id === sellerId);\r\n        const phoneNumber = seller?.profiles.phone;\r\n        const fullName = seller?.profiles.full_name;\r\n\r\n        if (phoneNumber) {\r\n          const { sendSMS } = await import('../../lib/arkesel');\r\n          const name = (fullName || 'Seller').split(' ')[0];\r\n          await sendSMS(\r\n            [phoneNumber],\r\n            `Hi ${name}, your Campus Marketplace subscription has been ACTIVATED! Start selling now.`\r\n          );\r\n        }\r\n      } catch (smsError) {\r\n        console.error(\"SMS Warning:\", smsError);\r\n      }\r\n\r\n      await fetchData();\r\n      alert('Subscription renewed successfully!');\r\n    } catch (error) {\r\n      console.error('Error renewing subscription:', error);\r\n      alert('Failed to renew subscription');\r\n    }\r\n  };\r\n\r\n  const handleBulkRenew = async () => {\r\n    if (selectedSellers.length === 0) return;\r\n    if (!confirm(`Renew subscriptions for ${selectedSellers.length} selected sellers?`)) return;\r\n\r\n    setLoading(true);\r\n    try {\r\n      const startDate = new Date();\r\n      const endDate = new Date();\r\n      endDate.setMonth(endDate.getMonth() + 1);\r\n      endDate.setDate(endDate.getDate() + 3);\r\n\r\n      // Parallelize updates\r\n      const updatePromises = selectedSellers.map(async (userId) => {\r\n        // 1. Update DB\r\n        // 1. Update DB\r\n        const isBypass = localStorage.getItem('sys_admin_bypass') === 'true';\r\n        const secret = localStorage.getItem('sys_admin_secret') || 'pentvars-sys-admin-x892';\r\n\r\n        if (isBypass && secret) {\r\n          const { error } = await supabase.rpc('sys_manage_seller_subscription', {\r\n            secret_key: secret,\r\n            target_user_id: userId,\r\n            new_status: 'active',\r\n            start_date: startDate.toISOString(),\r\n            end_date: endDate.toISOString()\r\n          });\r\n          if (error) throw error;\r\n        } else {\r\n          const { error } = await supabase\r\n            .from('seller_profiles')\r\n            .update({\r\n              subscription_status: 'active',\r\n              subscription_start_date: startDate.toISOString(),\r\n              subscription_end_date: endDate.toISOString(),\r\n              last_payment_date: startDate.toISOString(),\r\n            })\r\n            .eq('user_id', userId);\r\n          if (error) throw error;\r\n        }\r\n\r\n        // 2. Send SMS\r\n        try {\r\n          const seller = sellers.find(s => s.user_id === userId);\r\n          const phoneNumber = seller?.profiles.phone;\r\n          const fullName = seller?.profiles.full_name;\r\n\r\n          if (phoneNumber) {\r\n            const { sendSMS } = await import('../../lib/arkesel');\r\n            const name = (fullName || 'Seller').split(' ')[0];\r\n            await sendSMS(\r\n              [phoneNumber],\r\n              `Hi ${name}, your Campus Marketplace subscription has been ACTIVATED! Start selling now.`\r\n            );\r\n          }\r\n        } catch (smsError) {\r\n          console.error(`Failed to send SMS to ${userId}:`, smsError);\r\n        }\r\n      });\r\n\r\n      await Promise.all(updatePromises);\r\n\r\n      await fetchData();\r\n      setSelectedSellers([]);\r\n      alert(`Successfully renewed ${selectedSellers.length} subscriptions.`);\r\n\r\n    } catch (error) {\r\n      console.error('Bulk renewal error:', error);\r\n      alert('Failed to process some renewals.');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleBulkSuspend = async () => {\r\n    if (selectedSellers.length === 0) return;\r\n    if (!confirm(`Suspend subscriptions for ${selectedSellers.length} selected sellers? Their products will be hidden.`)) return;\r\n\r\n    setLoading(true);\r\n    try {\r\n      const isBypass = localStorage.getItem('sys_admin_bypass') === 'true';\r\n      const secret = localStorage.getItem('sys_admin_secret') || 'pentvars-sys-admin-x892';\r\n\r\n      // Parallelize updates\r\n      const updatePromises = selectedSellers.map(async (userId) => {\r\n        // 1. Update DB\r\n        if (isBypass && secret) {\r\n          const { error } = await supabase.rpc('sys_manage_seller_subscription', {\r\n            secret_key: secret,\r\n            target_user_id: userId,\r\n            new_status: 'inactive'\r\n          });\r\n          if (error) throw error;\r\n        } else {\r\n          const { error } = await supabase\r\n            .from('seller_profiles')\r\n            .update({ subscription_status: 'inactive' })\r\n            .eq('user_id', userId);\r\n          if (error) throw error;\r\n        }\r\n\r\n        // 2. Send SMS\r\n        try {\r\n          const seller = sellers.find(s => s.user_id === userId);\r\n          const phoneNumber = seller?.profiles.phone;\r\n          const fullName = seller?.profiles.full_name;\r\n\r\n          if (phoneNumber) {\r\n            const { sendSMS } = await import('../../lib/arkesel');\r\n            const name = (fullName || 'Seller').split(' ')[0];\r\n            await sendSMS(\r\n              [phoneNumber],\r\n              `Hi ${name}, your Campus Marketplace subscription has been SUSPENDED. Your products are now hidden. Please contact support.`\r\n            );\r\n          }\r\n        } catch (smsError) {\r\n          console.error(`Failed to send SMS to ${userId}:`, smsError);\r\n        }\r\n      });\r\n\r\n      await Promise.all(updatePromises);\r\n      await fetchData();\r\n      setSelectedSellers([]);\r\n      alert(`Successfully suspended ${selectedSellers.length} sellers.`);\r\n    } catch (error) {\r\n      console.error('Bulk suspension error:', error);\r\n      alert('Failed to process some suspensions.');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleSuspendSeller = async (sellerId: string) => {\r\n    if (!confirm('Suspend this seller\\'s subscription? Their products will be hidden.')) {\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const isBypass = localStorage.getItem('sys_admin_bypass') === 'true';\r\n      const secret = localStorage.getItem('sys_admin_secret') || 'pentvars-sys-admin-x892';\r\n\r\n      if (isBypass && secret) {\r\n        const { error } = await supabase.rpc('sys_manage_seller_subscription', {\r\n          secret_key: secret,\r\n          target_user_id: sellerId,\r\n          new_status: 'inactive'\r\n        });\r\n        if (error) throw error;\r\n      } else {\r\n        const { error } = await supabase\r\n          .from('seller_profiles')\r\n          .update({ subscription_status: 'inactive' })\r\n          .eq('user_id', sellerId);\r\n        if (error) throw error;\r\n      }\r\n\r\n      // SMS Notification\r\n      try {\r\n        const seller = sellers.find(s => s.user_id === sellerId);\r\n        const phoneNumber = seller?.profiles.phone;\r\n        const fullName = seller?.profiles.full_name;\r\n\r\n        if (phoneNumber) {\r\n          const { sendSMS } = await import('../../lib/arkesel');\r\n          const name = (fullName || 'Seller').split(' ')[0];\r\n          await sendSMS(\r\n            [phoneNumber],\r\n            `Hi ${name}, your Campus Marketplace subscription has been SUSPENDED. Your products are now hidden. Please contact support.`\r\n          );\r\n        }\r\n      } catch (smsError) {\r\n        console.error(\"SMS Warning:\", smsError);\r\n      }\r\n\r\n      await fetchData();\r\n      alert('Seller subscription suspended');\r\n    } catch (error) {\r\n      console.error('Error suspending seller:', error);\r\n      alert('Failed to suspend seller');\r\n    }\r\n  };\r\n\r\n  const handleGenerateInvoice = (payment: Payment) => {\r\n    const statusColor = payment.payment_status === 'success' ? '#10b981' : '#f59e0b';\r\n    const statusText = payment.payment_status.toUpperCase();\r\n\r\n    const invoiceWindow = window.open('', '_blank');\r\n    if (!invoiceWindow) {\r\n      alert('Please allow popups to view the invoice.');\r\n      return;\r\n    }\r\n\r\n    const htmlContent = `\r\n        <!DOCTYPE html>\r\n        <html>\r\n        <head>\r\n            <title>Invoice #${payment.payment_reference}</title>\r\n            <style>\r\n                body { font-family: 'Montserrat', 'Helvetica Neue', Helvetica, Arial, sans-serif; padding: 40px; color: #333; line-height: 1.6; }\r\n                .invoice-box { max-width: 800px; margin: auto; padding: 30px; border: 1px solid #eee; box-shadow: 0 0 10px rgba(0, 0, 0, .15); font-size: 16px; line-height: 24px; color: #555; }\r\n                .header { display: flex; justify-content: space-between; margin-bottom: 50px; }\r\n                .logo { font-size: 24px; font-weight: bold; color: #2563eb; }\r\n                .invoice-details { text-align: right; }\r\n                .status-badge { display: inline-block; padding: 5px 15px; background: ${statusColor}20; color: ${statusColor}; border-radius: 20px; font-weight: bold; font-size: 12px; }\r\n                table { width: 100%; line-height: inherit; text-align: left; border-collapse: collapse; }\r\n                table td { padding: 5px; vertical-align: top; }\r\n                table tr td:nth-child(2) { text-align: right; }\r\n                .heading td { background: #eee; border-bottom: 1px solid #ddd; font-weight: bold; }\r\n                .item td { border-bottom: 1px solid #eee; }\r\n                .total td { border-top: 2px solid #eee; font-weight: bold; }\r\n            </style>\r\n        </head>\r\n        <body>\r\n            <div class=\"invoice-box\">\r\n                <div class=\"header\">\r\n                    <div class=\"logo\">CampusConnect.</div>\r\n                    <div class=\"invoice-details\">\r\n                        <h2 style=\"margin: 0;\">INVOICE</h2>\r\n                        <p style=\"margin: 5px 0;\">Ref: ${payment.payment_reference}</p>\r\n                        <p style=\"margin: 0;\">Date: ${new Date(payment.created_at).toLocaleDateString()}</p>\r\n                        <div style=\"margin-top: 10px;\"><span class=\"status-badge\">${statusText}</span></div>\r\n                    </div>\r\n                </div>\r\n\r\n                <div style=\"margin-bottom: 40px;\">\r\n                    <strong>Bill To:</strong><br>\r\n                    ${payment.profiles.full_name}<br>\r\n                    ${payment.profiles.email}\r\n                </div>\r\n\r\n                <table>\r\n                    <tr class=\"heading\">\r\n                        <td>Item</td>\r\n                        <td>Price</td>\r\n                    </tr>\r\n                    <tr class=\"item\">\r\n                        <td>Seller Subscription (${new Date(payment.subscription_start_date).toLocaleDateString()} - ${new Date(payment.subscription_end_date).toLocaleDateString()})</td>\r\n                        <td>${payment.currency} ${payment.amount.toFixed(2)}</td>\r\n                    </tr>\r\n                    <tr class=\"total\">\r\n                        <td></td>\r\n                        <td>Total: ${payment.currency} ${payment.amount.toFixed(2)}</td>\r\n                    </tr>\r\n                </table>\r\n\r\n                <div style=\"margin-top: 50px; text-align: center; font-size: 12px; color: #999;\">\r\n                    <p>Thank you for your business.</p>\r\n                    <p>Campus Connect Inc.</p>\r\n                </div>\r\n            </div>\r\n        </body>\r\n        </html>\r\n    `;\r\n\r\n    invoiceWindow.document.write(htmlContent);\r\n    invoiceWindow.document.close();\r\n  };\r\n\r\n  const getDaysRemaining = (endDate: string | null) => {\r\n    if (!endDate) return null;\r\n    const end = new Date(endDate);\r\n    const now = new Date();\r\n    const diff = Math.ceil((end.getTime() - now.getTime()) / (1000 * 60 * 60 * 24));\r\n    return diff;\r\n  };\r\n\r\n  // Filtering logic moved here, derived from state\r\n  const filteredSellers = sellers.filter(seller => {\r\n    const matchesSearch =\r\n      seller.business_name.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n      seller.profiles.full_name.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n      seller.profiles.email.toLowerCase().includes(searchTerm.toLowerCase());\r\n\r\n    const matchesStatus = statusFilter === 'all' || seller.subscription_status === statusFilter;\r\n\r\n    return matchesSearch && matchesStatus;\r\n  });\r\n\r\n  const filteredPayments = payments.filter(payment =>\r\n    payment.profiles.full_name.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n    payment.profiles.email.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n    payment.payment_reference.toLowerCase().includes(searchTerm.toLowerCase())\r\n  );\r\n\r\n  // Handlers depending on filteredSellers\r\n  const handleSelectAll = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    if (e.target.checked) {\r\n      setSelectedSellers(filteredSellers.map(s => s.user_id));\r\n    } else {\r\n      setSelectedSellers([]);\r\n    }\r\n  };\r\n\r\n  const handleSelectSeller = (userId: string) => {\r\n    setSelectedSellers(prev =>\r\n      prev.includes(userId) ? prev.filter(id => id !== userId) : [...prev, userId]\r\n    );\r\n  };\r\n\r\n\r\n  const stats = {\r\n    total: sellers.length,\r\n    active: sellers.filter(s => s.subscription_status === 'active').length,\r\n    expired: sellers.filter(s => s.subscription_status === 'expired').length,\r\n    inactive: sellers.filter(s => s.subscription_status === 'inactive').length,\r\n    totalRevenue: payments\r\n      .filter(p => p.payment_status === 'success')\r\n      .reduce((sum, p) => sum + p.amount, 0),\r\n  };\r\n\r\n  if (authLoading || loading) {\r\n    return (\r\n      <div className=\"min-h-screen bg-slate-50 dark:bg-slate-900 flex items-center justify-center\">\r\n        <div className=\"text-center\">\r\n          <i className=\"ri-loader-4-line text-4xl text-blue-600 animate-spin\"></i>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-slate-50 dark:bg-slate-900 transition-colors duration-300 pb-20 font-sans\">\r\n      <Navbar />\r\n\r\n      <div className=\"pt-32 md:pt-40 pb-12 box-border max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\r\n\r\n        {/* Header Area */}\r\n        <div className=\"flex flex-col md:flex-row md:items-end justify-between gap-6 mb-10\">\r\n          <div>\r\n            <div className=\"flex items-center gap-2 mb-2\">\r\n              <span className=\"px-3 py-1 rounded-full bg-amber-100 dark:bg-amber-900/30 text-amber-700 dark:text-amber-300 text-[10px] font-bold uppercase tracking-widest border border-amber-200 dark:border-amber-800\">\r\n                Premium\r\n              </span>\r\n            </div>\r\n            <h1 className=\"text-3xl md:text-5xl font-black text-slate-900 dark:text-white tracking-tight mb-2\">\r\n              Platform Subs\r\n            </h1>\r\n            <p className=\"text-slate-500 dark:text-slate-400 font-medium\">\r\n              Manage seller subscriptions, renewals, and revenue.\r\n            </p>\r\n          </div>\r\n\r\n          {/* Global Subscription Switch */}\r\n          <div className={`p-4 rounded-2xl border transition-all ${subscriptionEnabled ? 'bg-emerald-50 border-emerald-100 dark:bg-emerald-900/20 dark:border-emerald-800' : 'bg-slate-100 border-slate-200 dark:bg-slate-800 dark:border-slate-700'}`}>\r\n            <div className=\"flex items-center gap-4\">\r\n              <div>\r\n                <p className=\"text-xs font-bold uppercase tracking-widest mb-1 text-slate-500 dark:text-slate-400\">Platform Status</p>\r\n                <p className={`font-bold ${subscriptionEnabled ? 'text-emerald-600 dark:text-emerald-400' : 'text-slate-600 dark:text-slate-300'}`}>\r\n                  {subscriptionEnabled ? 'Subscriptions ENABLED' : 'Subscriptions DISABLED (Free)'}\r\n                </p>\r\n              </div>\r\n              <button\r\n                onClick={handleToggleSubscription}\r\n                disabled={updatingSettings}\r\n                className={`w-14 h-8 rounded-full p-1 transition-colors relative ${subscriptionEnabled ? 'bg-emerald-500' : 'bg-slate-300 dark:bg-slate-600'}`}\r\n              >\r\n                <div className={`w-6 h-6 bg-white rounded-full shadow-md transition-transform ${subscriptionEnabled ? 'translate-x-6' : 'translate-x-0'}`}></div>\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Stats */}\r\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8\">\r\n          <div className=\"bg-white dark:bg-slate-800 rounded-3xl p-6 border border-slate-100 dark:border-slate-700 shadow-sm relative overflow-hidden group\">\r\n            <div className=\"relative z-10\">\r\n              <p className=\"text-xs font-bold text-slate-400 uppercase tracking-widest\">Total Sellers</p>\r\n              <p className=\"text-3xl font-black text-slate-900 dark:text-white mt-1 group-hover:scale-105 transition-transform\">{stats.total}</p>\r\n            </div>\r\n            <i className=\"ri-store-3-line absolute right-6 bottom-6 text-4xl text-slate-100 dark:text-slate-700 group-hover:scale-110 transition-transform\"></i>\r\n          </div>\r\n\r\n          <div className=\"bg-white dark:bg-slate-800 rounded-3xl p-6 border border-slate-100 dark:border-slate-700 shadow-sm relative overflow-hidden group\">\r\n            <div className=\"relative z-10\">\r\n              <p className=\"text-xs font-bold text-emerald-500 uppercase tracking-widest\">Active Subs</p>\r\n              <p className=\"text-3xl font-black text-slate-900 dark:text-white mt-1 group-hover:scale-105 transition-transform\">{stats.active}</p>\r\n            </div>\r\n            <i className=\"ri-checkbox-circle-fill absolute right-6 bottom-6 text-4xl text-emerald-100 dark:text-emerald-900/20 group-hover:scale-110 transition-transform\"></i>\r\n          </div>\r\n\r\n          <div className=\"bg-white dark:bg-slate-800 rounded-3xl p-6 border border-slate-100 dark:border-slate-700 shadow-sm relative overflow-hidden group\">\r\n            <div className=\"relative z-10\">\r\n              <p className=\"text-xs font-bold text-rose-500 uppercase tracking-widest\">Expired / Inactive</p>\r\n              <p className=\"text-3xl font-black text-slate-900 dark:text-white mt-1 group-hover:scale-105 transition-transform\">{stats.expired + stats.inactive}</p>\r\n            </div>\r\n            <i className=\"ri-error-warning-fill absolute right-6 bottom-6 text-4xl text-rose-100 dark:text-rose-900/20 group-hover:scale-110 transition-transform\"></i>\r\n          </div>\r\n\r\n          <div className=\"bg-gradient-to-br from-amber-500 to-orange-600 rounded-3xl p-6 shadow-lg shadow-amber-500/20 text-white relative overflow-hidden group\">\r\n            <div className=\"relative z-10\">\r\n              <p className=\"text-xs font-bold text-amber-100 uppercase tracking-widest\">Total Revenue</p>\r\n              <p className=\"text-3xl font-black mt-1 group-hover:scale-105 transition-transform\">GHâ‚µ {stats.totalRevenue.toLocaleString()}</p>\r\n            </div>\r\n            <i className=\"ri-money-dollar-circle-line absolute right-6 bottom-6 text-4xl text-white/20 group-hover:scale-110 transition-transform\"></i>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Bulk Action Bar (Only visible when items selected) */}\r\n        {selectedSellers.length > 0 && activeTab === 'sellers' && (\r\n          <div className=\"fixed bottom-6 left-1/2 -translate-x-1/2 z-50 bg-slate-900 text-white px-6 py-3 rounded-2xl shadow-2xl flex items-center gap-6 animate-in slide-in-from-bottom-4\">\r\n            <span className=\"font-bold text-sm\">{selectedSellers.length} sellers selected</span>\r\n            <button\r\n              onClick={handleBulkRenew}\r\n              className=\"bg-emerald-500 hover:bg-emerald-600 text-white px-4 py-2 rounded-xl font-bold text-xs uppercase tracking-widest transition-colors flex items-center gap-2\"\r\n            >\r\n              <i className=\"ri-refresh-line\"></i> Bulk Renew\r\n            </button>\r\n            <button\r\n              onClick={handleBulkSuspend}\r\n              className=\"bg-rose-500 hover:bg-rose-600 text-white px-4 py-2 rounded-xl font-bold text-xs uppercase tracking-widest transition-colors flex items-center gap-2\"\r\n            >\r\n              <i className=\"ri-forbid-2-line\"></i> Bulk Suspend\r\n            </button>\r\n          </div>\r\n        )}\r\n\r\n        {/* Content Tabs */}\r\n        <div className=\"bg-white dark:bg-slate-800 rounded-[2.5rem] shadow-sm border border-slate-200 dark:border-slate-700 overflow-hidden min-h-[500px]\">\r\n          <div className=\"flex gap-1 p-2 bg-slate-100 dark:bg-slate-900/50 m-2 rounded-2xl overflow-x-auto\">\r\n            <button\r\n              onClick={() => setActiveTab('sellers')}\r\n              className={`flex-1 px-6 py-4 rounded-xl text-sm font-bold uppercase tracking-wide transition-all ${activeTab === 'sellers'\r\n                ? 'bg-white dark:bg-slate-800 text-slate-900 dark:text-white shadow-sm'\r\n                : 'text-slate-500 hover:text-slate-700 dark:hover:text-slate-300'\r\n                }`}\r\n            >\r\n              <i className=\"ri-store-line mr-2\"></i>\r\n              Seller Subscriptions\r\n            </button>\r\n            <button\r\n              onClick={() => setActiveTab('payments')}\r\n              className={`flex-1 px-6 py-4 rounded-xl text-sm font-bold uppercase tracking-wide transition-all ${activeTab === 'payments'\r\n                ? 'bg-white dark:bg-slate-800 text-slate-900 dark:text-white shadow-sm'\r\n                : 'text-slate-500 hover:text-slate-700 dark:hover:text-slate-300'\r\n                }`}\r\n            >\r\n              <i className=\"ri-history-line mr-2\"></i>\r\n              Payment History\r\n            </button>\r\n          </div>\r\n\r\n          <div className=\"p-6\">\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 mb-8\">\r\n              <div className=\"relative\">\r\n                <i className=\"ri-search-line absolute left-4 top-1/2 -translate-y-1/2 text-slate-400\"></i>\r\n                <input\r\n                  type=\"text\"\r\n                  value={searchTerm}\r\n                  onChange={(e) => setSearchTerm(e.target.value)}\r\n                  placeholder=\"Search sellers, emails, or references...\"\r\n                  className=\"w-full pl-11 pr-4 py-3 bg-slate-50 dark:bg-slate-900 border-none rounded-xl focus:ring-2 focus:ring-blue-500/20 font-medium text-sm text-slate-900 dark:text-white outline-none\"\r\n                />\r\n              </div>\r\n\r\n              {activeTab === 'sellers' && (\r\n                <div className=\"relative\">\r\n                  <select\r\n                    value={statusFilter}\r\n                    onChange={(e) => setStatusFilter(e.target.value)}\r\n                    className=\"w-full pl-4 pr-10 py-3 bg-slate-50 dark:bg-slate-900 border-none rounded-xl focus:ring-2 focus:ring-blue-500/20 font-medium text-sm text-slate-900 dark:text-white outline-none appearance-none cursor-pointer\"\r\n                  >\r\n                    <option value=\"all\">All Statuses</option>\r\n                    <option value=\"active\">Active Only</option>\r\n                    <option value=\"expired\">Expired Only</option>\r\n                    <option value=\"inactive\">Inactive Only</option>\r\n                  </select>\r\n                  <i className=\"ri-filter-3-line absolute right-4 top-1/2 -translate-y-1/2 text-slate-400 pointer-events-none\"></i>\r\n                </div>\r\n              )}\r\n            </div>\r\n\r\n            {activeTab === 'sellers' ? (\r\n              <div className=\"overflow-x-auto\">\r\n                <table className=\"w-full\">\r\n                  <thead className=\"bg-slate-50/50 dark:bg-slate-800/50 border-b border-slate-100 dark:border-slate-700\">\r\n                    <tr>\r\n                      <th className=\"px-6 py-4\">\r\n                        <input\r\n                          type=\"checkbox\"\r\n                          onChange={handleSelectAll}\r\n                          checked={selectedSellers.length === filteredSellers.length && filteredSellers.length > 0}\r\n                          className=\"w-4 h-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\r\n                        />\r\n                      </th>\r\n                      <th className=\"px-6 py-4 text-left text-[10px] font-bold text-slate-400 uppercase tracking-widest\">Seller Profile</th>\r\n                      <th className=\"px-6 py-4 text-left text-[10px] font-bold text-slate-400 uppercase tracking-widest\">Business Name</th>\r\n                      <th className=\"px-6 py-4 text-left text-[10px] font-bold text-slate-400 uppercase tracking-widest\">Status</th>\r\n                      <th className=\"px-6 py-4 text-left text-[10px] font-bold text-slate-400 uppercase tracking-widest\">Expires In</th>\r\n                      <th className=\"px-6 py-4 text-left text-[10px] font-bold text-slate-400 uppercase tracking-widest\">Last Payout</th>\r\n                      <th className=\"px-6 py-4 text-right text-[10px] font-bold text-slate-400 uppercase tracking-widest\">Actions</th>\r\n                    </tr>\r\n                  </thead>\r\n                  <tbody className=\"divide-y divide-slate-100 dark:divide-slate-700\">\r\n                    {filteredSellers.map((seller) => {\r\n                      const daysRemaining = getDaysRemaining(seller.subscription_end_date);\r\n                      return (\r\n                        <tr key={seller.id} className=\"hover:bg-slate-50/50 dark:hover:bg-slate-700/30 transition-colors\">\r\n                          <td className=\"px-6 py-4\">\r\n                            <input\r\n                              type=\"checkbox\"\r\n                              checked={selectedSellers.includes(seller.user_id)}\r\n                              onChange={() => handleSelectSeller(seller.user_id)}\r\n                              className=\"w-4 h-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\r\n                            />\r\n                          </td>\r\n                          <td className=\"px-6 py-4\">\r\n                            <div className=\"flex items-center gap-3\">\r\n                              <div className=\"w-8 h-8 rounded-lg bg-slate-100 dark:bg-slate-800 flex items-center justify-center font-bold text-slate-400\">\r\n                                {seller.profiles.full_name.charAt(0)}\r\n                              </div>\r\n                              <div>\r\n                                <div className=\"text-sm font-bold text-slate-900 dark:text-white\">{seller.profiles.full_name}</div>\r\n                                <div className=\"text-xs text-slate-500\">{seller.profiles.email}</div>\r\n                              </div>\r\n                            </div>\r\n                          </td>\r\n                          <td className=\"px-6 py-4 text-sm font-medium text-slate-600 dark:text-slate-300\">{seller.business_name}</td>\r\n                          <td className=\"px-6 py-4\">\r\n                            <span className={`px-2 py-1 rounded text-[10px] font-bold uppercase tracking-wide ${seller.subscription_status === 'active'\r\n                              ? 'bg-emerald-100 text-emerald-700'\r\n                              : seller.subscription_status === 'expired'\r\n                                ? 'bg-rose-100 text-rose-700'\r\n                                : 'bg-slate-100 text-slate-600'\r\n                              }`}>\r\n                              {seller.subscription_status}\r\n                            </span>\r\n                          </td>\r\n                          <td className=\"px-6 py-4\">\r\n                            {daysRemaining !== null ? (\r\n                              <span className={`text-sm font-bold ${daysRemaining < 0 ? 'text-rose-500' :\r\n                                daysRemaining <= 7 ? 'text-amber-500' :\r\n                                  'text-emerald-500'\r\n                                }`}>\r\n                                {daysRemaining < 0 ? 'Expired' : `${daysRemaining} days`}\r\n                              </span>\r\n                            ) : (\r\n                              <span className=\"text-sm text-slate-400\">-</span>\r\n                            )}\r\n                          </td>\r\n                          <td className=\"px-6 py-4\">\r\n                            {seller.last_payment_amount ? (\r\n                              <div>\r\n                                <div className=\"text-sm font-bold text-slate-900 dark:text-white\">\r\n                                  GHâ‚µ {seller.last_payment_amount.toFixed(2)}\r\n                                </div>\r\n                                {seller.last_payment_date && (\r\n                                  <div className=\"text-[10px] text-slate-400\">\r\n                                    {new Date(seller.last_payment_date).toLocaleDateString()}\r\n                                  </div>\r\n                                )}\r\n                              </div>\r\n                            ) : (\r\n                              <span className=\"text-sm text-slate-400\">No payment</span>\r\n                            )}\r\n                          </td>\r\n                          <td className=\"px-6 py-4 text-right\">\r\n                            <div className=\"flex items-center justify-end gap-2\">\r\n                              <button\r\n                                onClick={() => handleManualRenewal(seller.user_id)}\r\n                                title=\"Renew Subscription\"\r\n                                className=\"w-8 h-8 flex items-center justify-center rounded-lg bg-emerald-50 text-emerald-600 hover:bg-emerald-100 transition-colors\"\r\n                              >\r\n                                <i className=\"ri-refresh-line\"></i>\r\n                              </button>\r\n                              {seller.subscription_status === 'active' && (\r\n                                <button\r\n                                  onClick={() => handleSuspendSeller(seller.user_id)}\r\n                                  title=\"Suspend\"\r\n                                  className=\"w-8 h-8 flex items-center justify-center rounded-lg bg-rose-50 text-rose-600 hover:bg-rose-100 transition-colors\"\r\n                                >\r\n                                  <i className=\"ri-forbid-2-line\"></i>\r\n                                </button>\r\n                              )}\r\n                            </div>\r\n                          </td>\r\n                        </tr>\r\n                      );\r\n                    })}\r\n                  </tbody>\r\n                </table>\r\n              </div>\r\n            ) : (\r\n              <div className=\"overflow-x-auto\">\r\n                <table className=\"w-full\">\r\n                  <thead className=\"bg-slate-50/50 dark:bg-slate-800/50 border-b border-slate-100 dark:border-slate-700\">\r\n                    <tr>\r\n                      <th className=\"px-6 py-4 text-left text-[10px] font-bold text-slate-400 uppercase tracking-widest\">Seller</th>\r\n                      <th className=\"px-6 py-4 text-left text-[10px] font-bold text-slate-400 uppercase tracking-widest\">Amount</th>\r\n                      <th className=\"px-6 py-4 text-left text-[10px] font-bold text-slate-400 uppercase tracking-widest\">Reference</th>\r\n                      <th className=\"px-6 py-4 text-left text-[10px] font-bold text-slate-400 uppercase tracking-widest\">Status</th>\r\n                      <th className=\"px-6 py-4 text-left text-[10px] font-bold text-slate-400 uppercase tracking-widest\">Period</th>\r\n                      <th className=\"px-6 py-4 text-right text-[10px] font-bold text-slate-400 uppercase tracking-widest\">Actions</th>\r\n                    </tr>\r\n                  </thead>\r\n                  <tbody className=\"divide-y divide-slate-100 dark:divide-slate-700\">\r\n                    {filteredPayments.map((payment) => (\r\n                      <tr key={payment.id} className=\"hover:bg-slate-50/50 dark:hover:bg-slate-700/30 transition-colors\">\r\n                        <td className=\"px-6 py-4\">\r\n                          <div className=\"flex items-center gap-3\">\r\n                            <div className=\"w-8 h-8 rounded-lg bg-slate-100 dark:bg-slate-800 flex items-center justify-center font-bold text-slate-400\">\r\n                              {payment.profiles.full_name.charAt(0)}\r\n                            </div>\r\n                            <div>\r\n                              <div className=\"text-sm font-bold text-slate-900 dark:text-white\">{payment.profiles.full_name}</div>\r\n                              <div className=\"text-xs text-slate-500\">{payment.profiles.email}</div>\r\n                            </div>\r\n                          </div>\r\n                        </td>\r\n                        <td className=\"px-6 py-4 text-sm font-bold text-slate-900 dark:text-white\">\r\n                          {payment.currency} {payment.amount.toFixed(2)}\r\n                        </td>\r\n                        <td className=\"px-6 py-4 text-xs font-mono text-slate-500\">\r\n                          {payment.payment_reference}\r\n                        </td>\r\n                        <td className=\"px-6 py-4\">\r\n                          <span className={`px-2 py-1 rounded text-[10px] font-bold uppercase tracking-wide ${payment.payment_status === 'success'\r\n                            ? 'bg-emerald-100 text-emerald-700'\r\n                            : 'bg-amber-100 text-amber-700'\r\n                            }`}>\r\n                            {payment.payment_status}\r\n                          </span>\r\n                        </td>\r\n                        <td className=\"px-6 py-4\">\r\n                          <div className=\"text-xs text-slate-600 dark:text-slate-300\">\r\n                            {new Date(payment.subscription_start_date).toLocaleDateString()} - {new Date(payment.subscription_end_date).toLocaleDateString()}\r\n                          </div>\r\n                        </td>\r\n                        <td className=\"px-6 py-4 text-right\">\r\n                          <button\r\n                            onClick={() => handleGenerateInvoice(payment)}\r\n                            className=\"px-3 py-1.5 bg-slate-900 dark:bg-white text-white dark:text-slate-900 text-[10px] font-bold uppercase tracking-wide rounded-lg hover:bg-slate-800 dark:hover:bg-slate-200 transition-colors\"\r\n                          >\r\n                            Invoice\r\n                          </button>\r\n                        </td>\r\n                      </tr>\r\n                    ))}\r\n                  </tbody>\r\n                </table>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"file":"SubscriptionManagement-BX2lrhBf.js"}
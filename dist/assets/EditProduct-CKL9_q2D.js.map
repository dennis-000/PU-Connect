{"version":3,"mappings":"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","names":["categories","EditProduct","navigate","useNavigate","id","useParams","user","profile","useAuth","loading","setLoading","useState","saving","setSaving","error","setError","newFilesMap","formData","setFormData","useEffect","fetchProduct","data","supabase","err","adminUpdateProduct","productId","productData","isBypass","secret","adminDeleteProduct","handleSubmit","e","uploadImage","compressImage","__vitePreload","n","uploadPromises","url","file","compressed","uploadedUrl","finalImages","handleDelete","handleFileSelect","previewUrl","prev","removeImage","index","urlToRemove","_","i","jsxs","jsx","cat","Fragment","ImageUploader"],"ignoreList":[],"sources":["../../src/pages/seller/EditProduct.tsx"],"sourcesContent":["import { useState, useEffect } from 'react';\r\nimport { useNavigate, useParams } from 'react-router-dom';\r\nimport { useAuth } from '../../contexts/AuthContext';\r\nimport { supabase, type Product } from '../../lib/supabase';\r\nimport Navbar from '../../components/feature/Navbar';\r\nimport ImageUploader from '../../components/base/ImageUploader';\r\n\r\nconst categories = [\r\n  'Electronics',\r\n  'Books & Stationery',\r\n  'Fashion & Accessories',\r\n  'Food & Beverages',\r\n  'Sports & Fitness',\r\n  'Home & Living',\r\n  'Services',\r\n  'Other',\r\n];\r\n\r\nexport default function EditProduct() {\r\n  const navigate = useNavigate();\r\n  const { id } = useParams();\r\n  const { user, profile } = useAuth();\r\n  const [loading, setLoading] = useState(true);\r\n  const [saving, setSaving] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [newFilesMap] = useState(new Map<string, File>());\r\n  const [formData, setFormData] = useState({\r\n    name: '',\r\n    description: '',\r\n    category: '',\r\n    price: '',\r\n    priceType: 'fixed' as 'fixed' | 'contact',\r\n    images: [] as string[], // Mix of existing URLs and local blobs\r\n    whatsapp_number: '',\r\n  });\r\n\r\n  useEffect(() => {\r\n    if (!user || (profile?.role !== 'seller' && profile?.role !== 'admin' && profile?.role !== 'super_admin')) {\r\n      navigate('/marketplace');\r\n      return;\r\n    }\r\n\r\n    if (id) {\r\n      fetchProduct();\r\n    }\r\n  }, [id, user, profile, navigate]);\r\n\r\n  const fetchProduct = async () => {\r\n    if (!id) return;\r\n\r\n    setLoading(true);\r\n    try {\r\n      const { data, error } = await supabase\r\n        .from('products')\r\n        .select('*')\r\n        .eq('id', id)\r\n        .single();\r\n\r\n      if (error) throw error;\r\n\r\n      if (data) {\r\n        // Check if user owns this product or is admin/super_admin\r\n        if (data.seller_id !== user?.id && profile?.role !== 'admin' && profile?.role !== 'super_admin') {\r\n          navigate('/seller/dashboard');\r\n          return;\r\n        }\r\n\r\n        setFormData({\r\n          name: data.name || '',\r\n          description: data.description || '',\r\n          category: data.category || '',\r\n          price: data.price?.toString() || '',\r\n          priceType: data.price_type || 'fixed',\r\n          images: data.images || [],\r\n          whatsapp_number: data.whatsapp_number || '',\r\n        });\r\n      }\r\n    } catch (err: any) {\r\n      console.error('Error fetching product:', err);\r\n      setError('Failed to load product');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  // Helper for System Admin Bypass\r\n  const adminUpdateProduct = async (productId: string, productData: any) => {\r\n    const isBypass = localStorage.getItem('sys_admin_bypass') === 'true';\r\n    const secret = localStorage.getItem('sys_admin_secret');\r\n    if (isBypass && secret) {\r\n      const { error } = await supabase.rpc('admin_update_product', {\r\n        product_id: productId,\r\n        product_data: productData,\r\n        secret_key: secret\r\n      });\r\n      return { error };\r\n    }\r\n    return await supabase.from('products').update(productData).eq('id', productId);\r\n  };\r\n\r\n  const adminDeleteProduct = async (productId: string) => {\r\n    const isBypass = localStorage.getItem('sys_admin_bypass') === 'true';\r\n    const secret = localStorage.getItem('sys_admin_secret');\r\n    if (isBypass && secret) {\r\n      const { error } = await supabase.rpc('admin_delete_product', {\r\n        target_id: productId,\r\n        secret_key: secret\r\n      });\r\n      return { error };\r\n    }\r\n    return await supabase.from('products').delete().eq('id', productId);\r\n  };\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    setSaving(true);\r\n    setError(null);\r\n\r\n    try {\r\n      // 1. Upload new images if any (Parallelized for speed)\r\n      const { uploadImage, compressImage } = await import('../../lib/uploadImage');\r\n\r\n      const uploadPromises = formData.images.map(async (url) => {\r\n        if (url.startsWith('blob:')) {\r\n          const file = newFilesMap.get(url);\r\n          if (file) {\r\n            const compressed = await compressImage(file);\r\n            const { url: uploadedUrl } = await uploadImage(compressed, 'products', user!.id);\r\n            return uploadedUrl;\r\n          }\r\n          return null;\r\n        }\r\n        return url;\r\n      });\r\n\r\n      const finalImages = (await Promise.all(uploadPromises)).filter(Boolean) as string[];\r\n\r\n      const productData = {\r\n        name: formData.name,\r\n        description: formData.description,\r\n        category: formData.category,\r\n        price: formData.priceType === 'fixed' ? parseFloat(formData.price) : null,\r\n        price_type: formData.priceType,\r\n        images: finalImages.length > 0 ? finalImages : null,\r\n        whatsapp_number: formData.whatsapp_number || null,\r\n        updated_at: new Date().toISOString(),\r\n      };\r\n\r\n      const { error } = await adminUpdateProduct(id!, productData);\r\n\r\n      if (error) throw error;\r\n\r\n      navigate('/seller/dashboard');\r\n    } catch (err: any) {\r\n      setError(err.message || 'Failed to update product');\r\n    } finally {\r\n      setSaving(false);\r\n    }\r\n  };\r\n\r\n  const handleDelete = async () => {\r\n    if (!id || !window.confirm('Delete this product? Action cannot be undone.')) return;\r\n    setSaving(true);\r\n    try {\r\n      const { error } = await adminDeleteProduct(id);\r\n      if (error) throw error;\r\n      navigate('/seller/dashboard');\r\n    } catch (err: any) {\r\n      setError(err.message || 'Failed to delete product');\r\n    } finally {\r\n      setSaving(false);\r\n    }\r\n  };\r\n\r\n  const handleFileSelect = (file: File) => {\r\n    const previewUrl = URL.createObjectURL(file);\r\n    newFilesMap.set(previewUrl, file);\r\n    setFormData(prev => ({\r\n      ...prev,\r\n      images: [...prev.images, previewUrl],\r\n    }));\r\n  };\r\n\r\n  const removeImage = (index: number) => {\r\n    const urlToRemove = formData.images[index];\r\n    if (urlToRemove.startsWith('blob:')) {\r\n      newFilesMap.delete(urlToRemove);\r\n      URL.revokeObjectURL(urlToRemove);\r\n    }\r\n    setFormData(prev => ({\r\n      ...prev,\r\n      images: prev.images.filter((_, i) => i !== index),\r\n    }));\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"min-h-screen bg-gradient-to-br from-teal-50 via-white to-blue-50 flex items-center justify-center\">\r\n        <div className=\"text-center\">\r\n          <i className=\"ri-loader-4-line text-4xl text-teal-600 animate-spin\"></i>\r\n          <p className=\"mt-4 text-gray-600\">Loading product...</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-10 md:py-20\">\r\n      <div className=\"flex flex-col md:flex-row md:items-end justify-between gap-8 mb-16\">\r\n        <div className=\"text-center md:text-left\">\r\n          <div className=\"inline-flex items-center gap-2 px-4 py-1.5 bg-gray-900 text-white text-[10px] font-bold uppercase tracking-widest rounded-full mb-6\">\r\n            <i className=\"ri-edit-circle-line text-blue-400\"></i>\r\n            Manage Listing\r\n          </div>\r\n          <h1 className=\"text-4xl md:text-6xl font-bold text-gray-900 tracking-tight leading-tight mb-4\">\r\n            Update<br /><span className=\"text-blue-600\">Product.</span>\r\n          </h1>\r\n          <p className=\"text-gray-500 font-bold uppercase tracking-widest text-[10px] md:text-xs\">\r\n            Review and refine your marketplace listing\r\n          </p>\r\n        </div>\r\n        <button\r\n          onClick={() => navigate('/seller/dashboard')}\r\n          className=\"text-[10px] font-bold text-gray-400 hover:text-blue-600 uppercase tracking-widest transition-colors cursor-pointer flex items-center justify-center gap-2 group\"\r\n        >\r\n          <i className=\"ri-arrow-left-s-line text-lg group-hover:-translate-x-1 transition-transform\"></i>\r\n          Exit Editor\r\n        </button>\r\n      </div>\r\n\r\n      <div className=\"grid grid-cols-1 lg:grid-cols-12 gap-12\">\r\n        {/* Form Section */}\r\n        <div className=\"lg:col-span-8\">\r\n          <div className=\"bg-white rounded-[2.5rem] shadow-xl shadow-gray-200/40 border border-gray-100 p-8 md:p-12\">\r\n            {error && (\r\n              <div className=\"mb-10 p-6 bg-rose-50 border border-rose-100 rounded-2xl flex items-center gap-4 animate-in fade-in slide-in-from-top-4 duration-500\">\r\n                <i className=\"ri-error-warning-fill text-2xl text-rose-600\"></i>\r\n                <p className=\"text-sm font-bold text-rose-900 uppercase tracking-tight\">{error}</p>\r\n              </div>\r\n            )}\r\n\r\n            <form onSubmit={handleSubmit} className=\"space-y-10\">\r\n              {/* Product Info */}\r\n              <div className=\"space-y-8\">\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-8\">\r\n                  <div className=\"space-y-2\">\r\n                    <label className=\"block text-[10px] font-bold text-gray-400 uppercase tracking-widest ml-1\">\r\n                      Product Name\r\n                    </label>\r\n                    <input\r\n                      type=\"text\"\r\n                      required\r\n                      value={formData.name}\r\n                      onChange={(e) => setFormData({ ...formData, name: e.target.value })}\r\n                      className=\"w-full px-6 py-4 bg-gray-50 border-none rounded-2xl focus:ring-2 focus:ring-blue-600/20 font-semibold outline-none text-sm text-gray-900 transition-all\"\r\n                      placeholder=\"e.g. Vintage Denim Jacket\"\r\n                    />\r\n                  </div>\r\n\r\n                  <div className=\"space-y-2\">\r\n                    <label className=\"block text-[10px] font-bold text-gray-400 uppercase tracking-widest ml-1\">\r\n                      Category\r\n                    </label>\r\n                    <div className=\"relative\">\r\n                      <select\r\n                        required\r\n                        value={formData.category}\r\n                        onChange={(e) => setFormData({ ...formData, category: e.target.value })}\r\n                        className=\"w-full px-6 py-4 bg-gray-50 border-none rounded-2xl focus:ring-2 focus:ring-blue-600/20 font-semibold outline-none text-sm text-gray-900 transition-all appearance-none cursor-pointer\"\r\n                      >\r\n                        <option value=\"\">Select Category</option>\r\n                        {categories.map((cat) => (\r\n                          <option key={cat} value={cat}>{cat}</option>\r\n                        ))}\r\n                      </select>\r\n                      <i className=\"ri-arrow-down-s-line absolute right-6 top-1/2 -translate-y-1/2 text-gray-400 pointer-events-none\"></i>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"space-y-2\">\r\n                  <label className=\"block text-[10px] font-bold text-gray-400 uppercase tracking-widest ml-1\">\r\n                    Product Description\r\n                  </label>\r\n                  <textarea\r\n                    value={formData.description}\r\n                    onChange={(e) => setFormData({ ...formData, description: e.target.value })}\r\n                    rows={4}\r\n                    className=\"w-full px-6 py-4 bg-gray-50 border-none rounded-2xl focus:ring-2 focus:ring-blue-600/20 font-semibold outline-none text-sm text-gray-900 transition-all resize-none\"\r\n                    placeholder=\"Provide detailed information about the product...\"\r\n                  />\r\n                </div>\r\n              </div>\r\n\r\n              {/* Pricing */}\r\n              <div className=\"space-y-6\">\r\n                <label className=\"block text-[10px] font-bold text-gray-400 uppercase tracking-widest ml-1\">\r\n                  Pricing Terms\r\n                </label>\r\n                <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\r\n                  <button\r\n                    type=\"button\"\r\n                    onClick={() => setFormData({ ...formData, priceType: 'fixed' })}\r\n                    className={`p-6 rounded-[2rem] border-2 text-left transition-all ${formData.priceType === 'fixed' ? 'bg-blue-600 border-blue-600 text-white shadow-lg shadow-blue-500/20' : 'bg-gray-50 border-gray-100 text-gray-900'\r\n                      }`}\r\n                  >\r\n                    <i className={`ri-price-tag-3-line text-2xl mb-4 block ${formData.priceType === 'fixed' ? 'text-blue-200' : 'text-blue-600'}`}></i>\r\n                    <p className=\"font-bold text-sm uppercase tracking-widest leading-none mb-1\">Fixed Price</p>\r\n                    <p className={`text-[10px] font-semibold ${formData.priceType === 'fixed' ? 'text-blue-100' : 'text-gray-400'}`}>Standard selling price</p>\r\n                  </button>\r\n                  <button\r\n                    type=\"button\"\r\n                    onClick={() => setFormData({ ...formData, priceType: 'contact' })}\r\n                    className={`p-6 rounded-[2rem] border-2 text-left transition-all ${formData.priceType === 'contact' ? 'bg-blue-600 border-blue-600 text-white shadow-lg shadow-blue-500/20' : 'bg-gray-50 border-gray-100 text-gray-900'\r\n                      }`}\r\n                  >\r\n                    <i className={`ri-customer-service-2-line text-2xl mb-4 block ${formData.priceType === 'contact' ? 'text-blue-200' : 'text-blue-600'}`}></i>\r\n                    <p className=\"font-bold text-sm uppercase tracking-widest leading-none mb-1\">Negotiable</p>\r\n                    <p className={`text-[10px] font-semibold ${formData.priceType === 'contact' ? 'text-blue-100' : 'text-gray-400'}`}>Price discussed via chat</p>\r\n                  </button>\r\n                </div>\r\n\r\n                {formData.priceType === 'fixed' && (\r\n                  <div className=\"animate-in fade-in slide-in-from-top-2 duration-300\">\r\n                    <div className=\"relative max-w-xs\">\r\n                      <span className=\"absolute left-6 top-1/2 -translate-y-1/2 font-bold text-xl text-gray-400\">GHâ‚µ</span>\r\n                      <input\r\n                        type=\"number\"\r\n                        step=\"0.01\"\r\n                        required={formData.priceType === 'fixed'}\r\n                        value={formData.price}\r\n                        onChange={(e) => setFormData({ ...formData, price: e.target.value })}\r\n                        className=\"w-full pl-14 pr-6 py-4 bg-gray-50 border-none rounded-2xl focus:ring-2 focus:ring-blue-600/20 font-bold outline-none text-2xl text-gray-900 transition-all\"\r\n                        placeholder=\"0.00\"\r\n                      />\r\n                    </div>\r\n                  </div>\r\n                )}\r\n              </div>\r\n\r\n              {/* WhatsApp Contact */}\r\n              <div className=\"space-y-4\">\r\n                <label className=\"block text-[10px] font-bold text-gray-400 uppercase tracking-widest ml-1\">\r\n                  WhatsApp Contact (Optional)\r\n                </label>\r\n                <input\r\n                  type=\"tel\"\r\n                  value={formData.whatsapp_number}\r\n                  onChange={(e) => setFormData({ ...formData, whatsapp_number: e.target.value })}\r\n                  className=\"w-full px-6 py-4 bg-gray-50 border-none rounded-2xl focus:ring-2 focus:ring-blue-600/20 font-semibold outline-none text-sm text-gray-900 transition-all\"\r\n                  placeholder=\"+233 XX XXX XXXX\"\r\n                />\r\n                <p className=\"text-[10px] font-bold text-gray-400 uppercase tracking-widest ml-1\">Customers can contact you directly on WhatsApp</p>\r\n              </div>\r\n\r\n              <div className=\"flex flex-col sm:flex-row gap-4 pt-6\">\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={handleDelete}\r\n                  disabled={saving}\r\n                  className=\"px-8 py-5 bg-rose-50 text-rose-600 font-bold text-xs uppercase tracking-widest rounded-2xl hover:bg-rose-600 hover:text-white transition-all disabled:opacity-50 flex items-center justify-center gap-3 active:scale-[0.98]\"\r\n                >\r\n                  <i className=\"ri-delete-bin-line text-lg\"></i>\r\n                  <span>Delete Listing</span>\r\n                </button>\r\n                <button\r\n                  type=\"submit\"\r\n                  disabled={saving}\r\n                  className=\"flex-1 py-5 bg-gray-900 text-white font-bold text-xs uppercase tracking-widest rounded-2xl hover:bg-black shadow-xl shadow-gray-900/10 transition-all disabled:opacity-50 flex items-center justify-center gap-3 active:scale-[0.98]\"\r\n                >\r\n                  {saving ? (\r\n                    <i className=\"ri-loader-4-line animate-spin text-xl\"></i>\r\n                  ) : (\r\n                    <>\r\n                      <span>Save Changes</span>\r\n                      <i className=\"ri-save-3-fill text-lg\"></i>\r\n                    </>\r\n                  )}\r\n                </button>\r\n              </div>\r\n            </form>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Media Sidebar */}\r\n        <div className=\"lg:col-span-4 space-y-8\">\r\n          <div className=\"bg-gray-900 text-white p-8 rounded-[2.5rem] shadow-xl\">\r\n            <h3 className=\"text-xl font-bold mb-8 tracking-tight flex items-center gap-3\">\r\n              <i className=\"ri-image-edit-line text-blue-400\"></i>\r\n              Manage Media\r\n            </h3>\r\n\r\n            <div className=\"grid grid-cols-2 gap-4\">\r\n              {formData.images.map((url, index) => (\r\n                <div key={index} className=\"relative group aspect-square rounded-2xl overflow-hidden bg-gray-800 border border-white/5\">\r\n                  <img\r\n                    src={url}\r\n                    alt={`Product image ${index + 1}`}\r\n                    className=\"w-full h-full object-cover group-hover:scale-105 transition-transform duration-500\"\r\n                    loading=\"lazy\"\r\n                  />\r\n                  <button\r\n                    type=\"button\"\r\n                    onClick={() => removeImage(index)}\r\n                    className=\"absolute top-2 right-2 w-7 h-7 bg-rose-600 text-white rounded-full flex items-center justify-center shadow-lg opacity-0 group-hover:opacity-100 transition-all hover:bg-rose-700 active:scale-90\"\r\n                  >\r\n                    <i className=\"ri-close-line\"></i>\r\n                  </button>\r\n                  {index === 0 && (\r\n                    <div className=\"absolute bottom-0 left-0 right-0 bg-blue-600/90 text-white text-[8px] font-bold uppercase tracking-widest text-center py-1.5\">\r\n                      Main Cover\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              ))}\r\n\r\n              {formData.images.length < 8 && (\r\n                <div className=\"aspect-square\">\r\n                  <ImageUploader\r\n                    folder=\"products\"\r\n                    autoUpload={false}\r\n                    onFileSelected={handleFileSelect}\r\n                    hideInternalUI={true}\r\n                    shape=\"square\"\r\n                    size=\"medium\"\r\n                    className=\"w-full h-full bg-gray-800 hover:bg-gray-700 transition-colors rounded-2xl border-2 border-dashed border-gray-700 flex items-center justify-center cursor-pointer group\"\r\n                  />\r\n                </div>\r\n              )}\r\n            </div>\r\n\r\n            <div className=\"mt-8 p-6 bg-white/5 rounded-2xl border border-white/5\">\r\n              <p className=\"text-[10px] font-bold text-blue-400 uppercase tracking-widest mb-2\">Product Reference</p>\r\n              <p className=\"text-[10px] font-semibold text-gray-500 leading-relaxed break-all\">\r\n                ID: {id}\r\n              </p>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"bg-blue-50 p-8 rounded-[2rem] border border-blue-100/50\">\r\n            <i className=\"ri-shield-check-fill text-3xl text-blue-600 mb-4 block\"></i>\r\n            <p className=\"text-sm font-bold text-blue-950 uppercase tracking-widest mb-2\">Security Note</p>\r\n            <p className=\"text-xs font-semibold text-blue-800/80 leading-relaxed\">\r\n              Updated information is synchronized instantly across the PU Connect marketplace ecosystem.\r\n            </p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"file":"EditProduct-CKL9_q2D.js"}
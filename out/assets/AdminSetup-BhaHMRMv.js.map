{"version":3,"file":"AdminSetup-BhaHMRMv.js","sources":["../../src/pages/admin/AdminSetup.tsx"],"sourcesContent":["import { useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { useAuth } from '../../contexts/AuthContext';\nimport { supabase } from '../../lib/supabase';\nimport Navbar from '../../components/feature/Navbar';\n\nexport default function AdminSetup() {\n  const { user, profile, refreshProfile } = useAuth();\n  const navigate = useNavigate();\n  const [loading, setLoading] = useState(false);\n  const [message, setMessage] = useState('');\n  const [selectedRole, setSelectedRole] = useState<'admin' | 'super_admin'>('admin');\n\n  const makeAdmin = async () => {\n    if (!user) {\n      setMessage('You must be logged in');\n      return;\n    }\n\n    setLoading(true);\n    setMessage('');\n\n    try {\n      const { error } = await supabase\n        .from('profiles')\n        .update({ role: selectedRole })\n        .eq('id', user.id);\n\n      if (error) throw error;\n\n      // If super_admin, also add to system_admins table\n      if (selectedRole === 'super_admin') {\n        await supabase.from('system_admins').insert({\n          user_id: user.id,\n          granted_by: user.id,\n          is_active: true\n        });\n      }\n\n      await refreshProfile();\n      setMessage(`Success! You are now ${selectedRole === 'super_admin' ? 'a Super Admin' : 'an Admin'}. Redirecting...`);\n      \n      setTimeout(() => {\n        navigate('/admin/dashboard');\n      }, 2000);\n    } catch (error: any) {\n      setMessage('Error: ' + error.message);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const isAdmin = profile?.role === 'admin' || profile?.role === 'super_admin';\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-slate-50 via-white to-slate-50\">\n      <Navbar />\n\n      <div className=\"max-w-2xl mx-auto px-4 sm:px-6 lg:px-8 py-16\">\n        <div className=\"bg-white rounded-2xl border border-slate-200 p-8 shadow-lg\">\n          <div className=\"text-center mb-8\">\n            <div className=\"w-16 h-16 bg-gradient-to-br from-slate-900 to-slate-700 rounded-2xl flex items-center justify-center mx-auto mb-4\">\n              <i className=\"ri-shield-user-line text-white text-3xl\"></i>\n            </div>\n            <h1 className=\"text-3xl font-bold text-slate-900 mb-2\">Admin Setup</h1>\n            <p className=\"text-slate-600\">Grant yourself administrative access to manage the platform</p>\n          </div>\n\n          {profile && (\n            <div className=\"bg-gradient-to-br from-slate-50 to-slate-100 rounded-xl p-6 mb-6 border border-slate-200\">\n              <h3 className=\"text-sm font-semibold text-slate-900 mb-3\">Your Current Profile</h3>\n              <div className=\"space-y-2 text-sm\">\n                <div className=\"flex justify-between\">\n                  <span className=\"text-slate-600\">Name:</span>\n                  <span className=\"font-medium text-slate-900\">{profile.full_name}</span>\n                </div>\n                <div className=\"flex justify-between\">\n                  <span className=\"text-slate-600\">Email:</span>\n                  <span className=\"font-medium text-slate-900\">{profile.email}</span>\n                </div>\n                <div className=\"flex justify-between\">\n                  <span className=\"text-slate-600\">Current Role:</span>\n                  <span className={`px-3 py-1 text-xs font-medium rounded-full ${\n                    profile.role === 'super_admin'\n                      ? 'bg-gradient-to-r from-purple-100 to-pink-100 text-purple-700'\n                      : profile.role === 'admin' \n                      ? 'bg-purple-100 text-purple-700'\n                      : profile.role === 'seller'\n                      ? 'bg-green-100 text-green-700'\n                      : 'bg-blue-100 text-blue-700'\n                  }`}>\n                    {profile.role === 'super_admin' ? 'Super Admin' : profile.role.charAt(0).toUpperCase() + profile.role.slice(1)}\n                  </span>\n                </div>\n              </div>\n            </div>\n          )}\n\n          {isAdmin ? (\n            <div className=\"text-center\">\n              <div className=\"w-16 h-16 bg-gradient-to-br from-green-100 to-green-200 rounded-2xl flex items-center justify-center mx-auto mb-4\">\n                <i className=\"ri-check-line text-green-600 text-3xl\"></i>\n              </div>\n              <h3 className=\"text-lg font-semibold text-slate-900 mb-2\">\n                You're Already {profile?.role === 'super_admin' ? 'a Super Admin' : 'an Admin'}!\n              </h3>\n              <p className=\"text-slate-600 mb-6\">\n                You have {profile?.role === 'super_admin' ? 'full system access with elevated privileges' : 'access to admin features'}\n              </p>\n              <button\n                onClick={() => navigate('/admin/dashboard')}\n                className=\"px-6 py-3 bg-slate-900 text-white text-sm font-medium rounded-xl hover:bg-slate-800 transition-colors whitespace-nowrap cursor-pointer\"\n              >\n                Go to Admin Dashboard\n              </button>\n            </div>\n          ) : (\n            <>\n              {/* Role Selection */}\n              <div className=\"mb-6\">\n                <label className=\"block text-sm font-semibold text-slate-900 mb-3\">Select Admin Role</label>\n                <div className=\"grid grid-cols-2 gap-4\">\n                  <button\n                    onClick={() => setSelectedRole('admin')}\n                    className={`p-4 rounded-xl border-2 transition-all cursor-pointer ${\n                      selectedRole === 'admin'\n                        ? 'border-purple-500 bg-purple-50'\n                        : 'border-slate-200 hover:border-slate-300'\n                    }`}\n                  >\n                    <i className=\"ri-shield-line text-2xl text-purple-600 mb-2\"></i>\n                    <h4 className=\"font-semibold text-slate-900 text-sm\">Admin</h4>\n                    <p className=\"text-xs text-slate-600 mt-1\">Standard admin access</p>\n                  </button>\n                  <button\n                    onClick={() => setSelectedRole('super_admin')}\n                    className={`p-4 rounded-xl border-2 transition-all cursor-pointer ${\n                      selectedRole === 'super_admin'\n                        ? 'border-purple-500 bg-gradient-to-br from-purple-50 to-pink-50'\n                        : 'border-slate-200 hover:border-slate-300'\n                    }`}\n                  >\n                    <i className=\"ri-shield-star-line text-2xl text-purple-600 mb-2\"></i>\n                    <h4 className=\"font-semibold text-slate-900 text-sm\">Super Admin</h4>\n                    <p className=\"text-xs text-slate-600 mt-1\">Full system control</p>\n                  </button>\n                </div>\n              </div>\n\n              <div className=\"bg-amber-50 border border-amber-200 rounded-xl p-4 mb-6\">\n                <div className=\"flex items-start space-x-3\">\n                  <i className=\"ri-information-line text-amber-600 text-xl flex-shrink-0 mt-0.5\"></i>\n                  <div>\n                    <h4 className=\"text-sm font-semibold text-amber-900 mb-1\">Important</h4>\n                    <p className=\"text-sm text-amber-800\">\n                      {selectedRole === 'super_admin' \n                        ? 'Super Admin has complete system control and can manage other admins. Only grant this to platform owners.'\n                        : 'This will grant you administrator privileges. Only do this if you are authorized.'}\n                    </p>\n                  </div>\n                </div>\n              </div>\n\n              {message && (\n                <div className={`p-4 rounded-xl mb-6 ${\n                  message.includes('Success') \n                    ? 'bg-green-50 border border-green-200 text-green-800'\n                    : 'bg-red-50 border border-red-200 text-red-800'\n                }`}>\n                  <p className=\"text-sm\">{message}</p>\n                </div>\n              )}\n\n              <button\n                onClick={makeAdmin}\n                disabled={loading}\n                className=\"w-full px-6 py-3 bg-gradient-to-r from-slate-900 to-slate-700 text-white text-sm font-medium rounded-xl hover:from-slate-800 hover:to-slate-600 transition-all disabled:opacity-50 disabled:cursor-not-allowed whitespace-nowrap cursor-pointer\"\n              >\n                {loading ? (\n                  <span className=\"flex items-center justify-center\">\n                    <i className=\"ri-loader-4-line animate-spin mr-2\"></i>\n                    Processing...\n                  </span>\n                ) : (\n                  <>\n                    <i className=\"ri-shield-check-line mr-2\"></i>\n                    Grant {selectedRole === 'super_admin' ? 'Super Admin' : 'Admin'} Access\n                  </>\n                )}\n              </button>\n            </>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":["AdminSetup","user","profile","refreshProfile","useAuth","navigate","useNavigate","loading","setLoading","useState","message","setMessage","selectedRole","setSelectedRole","makeAdmin","error","supabase","isAdmin","jsxs","jsx","Navbar","Fragment"],"mappings":"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"}
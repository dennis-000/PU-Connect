{"version":3,"file":"ActivityMonitor-cVxXayhJ.js","sources":["../../src/pages/admin/ActivityMonitor.tsx"],"sourcesContent":["\nimport { useState, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { useAuth } from '../../contexts/AuthContext';\nimport { supabase } from '../../lib/supabase';\nimport Navbar from '../../components/feature/Navbar';\n\ninterface ActivityLog {\n  id: string;\n  user_id: string;\n  action_type: string;\n  action_details: any;\n  created_at: string;\n  user?: {\n    full_name: string;\n    email: string;\n  };\n}\n\nexport default function ActivityMonitor() {\n  const { profile } = useAuth();\n  const navigate = useNavigate();\n  const [activities, setActivities] = useState<ActivityLog[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [filterType, setFilterType] = useState('all');\n\n  useEffect(() => {\n    if (profile?.role !== 'admin') {\n      navigate('/marketplace');\n      return;\n    }\n    fetchActivities();\n    \n    const interval = setInterval(fetchActivities, 30000);\n    return () => clearInterval(interval);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [profile]);\n\n  const fetchActivities = async () => {\n    setLoading(true);\n    const { data, error } = await supabase\n      .from('activity_logs')\n      .select(`\n        *,\n        user:profiles!user_id(full_name, email)\n      `)\n      .order('created_at', { ascending: false })\n      .limit(100);\n\n    if (!error && data) {\n      setActivities(data as any);\n    }\n    setLoading(false);\n  };\n\n  const filteredActivities = filterType === 'all' \n    ? activities \n    : activities.filter(a => a.action_type === filterType);\n\n  const getActionIcon = (actionType: string) => {\n    switch (actionType) {\n      case 'login': return 'ri-login-box-line';\n      case 'logout': return 'ri-logout-box-line';\n      case 'product_created': return 'ri-add-box-line';\n      case 'product_updated': return 'ri-edit-box-line';\n      case 'product_deleted': return 'ri-delete-bin-line';\n      case 'message_sent': return 'ri-message-line';\n      case 'application_submitted': return 'ri-file-list-line';\n      default: return 'ri-information-line';\n    }\n  };\n\n  const getActionColor = (actionType: string) => {\n    switch (actionType) {\n      case 'login': return 'bg-green-100 text-green-700';\n      case 'logout': return 'bg-gray-100 text-gray-700';\n      case 'product_created': return 'bg-blue-100 text-blue-700';\n      case 'product_updated': return 'bg-yellow-100 text-yellow-700';\n      case 'product_deleted': return 'bg-red-100 text-red-700';\n      case 'message_sent': return 'bg-purple-100 text-purple-700';\n      default: return 'bg-gray-100 text-gray-700';\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gray-50\">\n      <Navbar />\n\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\n        <div className=\"mb-8\">\n          <h1 className=\"text-3xl font-bold text-gray-900 mb-2\">Activity Monitor</h1>\n          <p className=\"text-gray-600\">Real-time monitoring of platform activities</p>\n        </div>\n\n        {/* Filter */}\n        <div className=\"bg-white rounded-xl border border-gray-200 p-6 mb-6\">\n          <div className=\"flex items-center space-x-4 overflow-x-auto\">\n            <button\n              onClick={() => setFilterType('all')}\n              className={`px-4 py-2 text-sm font-medium rounded-lg transition-colors whitespace-nowrap cursor-pointer ${\n                filterType === 'all'\n                  ? 'bg-gray-900 text-white'\n                  : 'text-gray-600 hover:bg-gray-100'\n              }`}\n            >\n              All Activities\n            </button>\n            <button\n              onClick={() => setFilterType('login')}\n              className={`px-4 py-2 text-sm font-medium rounded-lg transition-colors whitespace-nowrap cursor-pointer ${\n                filterType === 'login'\n                  ? 'bg-gray-900 text-white'\n                  : 'text-gray-600 hover:bg-gray-100'\n              }`}\n            >\n              Logins\n            </button>\n            <button\n              onClick={() => setFilterType('product_created')}\n              className={`px-4 py-2 text-sm font-medium rounded-lg transition-colors whitespace-nowrap cursor-pointer ${\n                filterType === 'product_created'\n                  ? 'bg-gray-900 text-white'\n                  : 'text-gray-600 hover:bg-gray-100'\n              }`}\n            >\n              Products\n            </button>\n            <button\n              onClick={() => setFilterType('message_sent')}\n              className={`px-4 py-2 text-sm font-medium rounded-lg transition-colors whitespace-nowrap cursor-pointer ${\n                filterType === 'message_sent'\n                  ? 'bg-gray-900 text-white'\n                  : 'text-gray-600 hover:bg-gray-100'\n              }`}\n            >\n              Messages\n            </button>\n          </div>\n        </div>\n\n        {/* Activity Timeline */}\n        <div className=\"bg-white rounded-xl border border-gray-200 p-6\">\n          {loading ? (\n            <div className=\"text-center py-12\">\n              <div className=\"inline-block w-10 h-10 border-4 border-gray-200 border-t-gray-900 rounded-full animate-spin\"></div>\n              <p className=\"mt-4 text-gray-600\">Loading activities...</p>\n            </div>\n          ) : filteredActivities.length === 0 ? (\n            <div className=\"text-center py-12\">\n              <i className=\"ri-history-line text-5xl text-gray-300 mb-4\"></i>\n              <h3 className=\"text-lg font-semibold text-gray-900 mb-2\">No activities found</h3>\n              <p className=\"text-gray-600\">Activities will appear here as users interact with the platform</p>\n            </div>\n          ) : (\n            <div className=\"space-y-4\">\n              {filteredActivities.map((activity) => (\n                <div\n                  key={activity.id}\n                  className=\"flex items-start space-x-4 p-4 border border-gray-200 rounded-lg hover:border-gray-300 transition-all\"\n                >\n                  <div className={`w-10 h-10 rounded-lg flex items-center justify-center flex-shrink-0 ${getActionColor(activity.action_type)}`}>\n                    <i className={`${getActionIcon(activity.action_type)} text-lg`}></i>\n                  </div>\n                  <div className=\"flex-1 min-w-0\">\n                    <div className=\"flex items-center justify-between mb-1\">\n                      <h3 className=\"text-sm font-semibold text-gray-900\">\n                        {activity.user?.full_name || 'Unknown User'}\n                      </h3>\n                      <span className=\"text-xs text-gray-500\">\n                        {new Date(activity.created_at).toLocaleString()}\n                      </span>\n                    </div>\n                    <p className=\"text-sm text-gray-600 mb-1\">\n                      {activity.action_type.replace(/_/g, ' ').replace(/\\b\\w/g, l => l.toUpperCase())}\n                    </p>\n                    {activity.action_details && (\n                      <p className=\"text-xs text-gray-500\">\n                        {JSON.stringify(activity.action_details)}\n                      </p>\n                    )}\n                  </div>\n                </div>\n              ))}\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":["ActivityMonitor","profile","useAuth","navigate","useNavigate","activities","setActivities","useState","loading","setLoading","filterType","setFilterType","useEffect","fetchActivities","interval","data","error","supabase","filteredActivities","a","getActionIcon","actionType","getActionColor","jsxs","jsx","Navbar","activity","l"],"mappings":"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"}
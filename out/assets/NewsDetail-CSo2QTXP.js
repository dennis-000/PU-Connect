import{j as e}from"./query-vendor-C4XoQ8tj.js";import{e as N,r as l,L as c}from"./react-vendor-BpnWQj_L.js";import{s as n,N as d}from"./index-BvprY0-k.js";import"./i18n-vendor-BT3zpxCT.js";import"./supabase-vendor-NSJvwn9b.js";function E(){const{id:r}=N(),[t,i]=l.useState(null),[o,h]=l.useState([]),[u,m]=l.useState(!0);l.useEffect(()=>{r&&(f(),j())},[r]);const f=async()=>{if(r){m(!0);try{const{data:s,error:a}=await n.from("campus_news").select("*").eq("id",r).single();a?(console.error("Error fetching article:",a),i(null)):s&&(i(s),g(s.category))}catch(s){console.error("Unexpected error:",s),i(null)}finally{m(!1)}}},g=async s=>{if(r)try{const{data:a,error:x}=await n.from("campus_news").select("*").eq("category",s).neq("id",r).eq("status","published").order("created_at",{ascending:!1}).limit(3);x?console.error("Error fetching related news:",x):a&&h(a)}catch(a){console.error("Unexpected error fetching related news:",a)}},j=async()=>{if(r)try{await n.rpc("increment_news_views",{news_id:r})}catch(s){console.error("Error incrementing views:",s)}},p=s=>new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"});return u?e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(d,{}),e.jsxs("div",{className:"text-center py-20",children:[e.jsx("div",{className:"inline-block w-10 h-10 border-4 border-gray-200 border-t-emerald-600 rounded-full animate-spin"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Loading article..."})]})]}):t?e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(d,{}),e.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsx("div",{className:"mb-6",children:e.jsxs(c,{to:"/news",className:"inline-flex items-center text-blue-600 hover:text-blue-700 font-semibold cursor-pointer",children:[e.jsx("i",{className:"ri-arrow-left-line mr-2"}),"Back to News"]})}),e.jsxs("article",{className:"bg-white rounded-xl shadow-lg overflow-hidden",children:[t.image_url&&e.jsx("div",{className:"relative h-96 w-full overflow-hidden",children:e.jsx("img",{src:t.image_url,alt:t.title,className:"w-full h-full object-cover object-center"})}),e.jsxs("div",{className:"p-8 md:p-12",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[e.jsx("span",{className:"px-4 py-2 bg-blue-100 text-blue-700 text-sm font-medium rounded-full",children:t.category}),e.jsx("span",{className:"text-gray-500",children:p(t.created_at)})]}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-6",children:t.title}),e.jsx("div",{className:"prose prose-lg max-w-none",children:e.jsx("p",{className:"text-gray-700 leading-relaxed whitespace-pre-line",children:t.content})}),e.jsx("div",{className:"mt-8 pt-6 border-t border-gray-200",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("div",{className:"flex items-center space-x-4",children:e.jsxs("button",{className:"flex items-center space-x-2 text-gray-600 hover:text-emerald-600 transition-colors cursor-pointer",children:[e.jsx("i",{className:"ri-share-line text-lg"}),e.jsx("span",{className:"text-sm font-medium",children:"Share"})]})})})})]})]}),o.length>0&&e.jsxs("div",{className:"mt-12",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Related News"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:o.map(s=>e.jsxs(c,{to:`/news/${s.id}`,className:"bg-white rounded-xl border border-gray-200 hover:border-emerald-300 hover:shadow-lg transition-all overflow-hidden",children:[e.jsx("div",{className:"h-40 bg-gray-100 relative overflow-hidden",children:s.image_url?e.jsx("img",{src:s.image_url,alt:s.title,className:"w-full h-full object-cover object-top"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx("i",{className:"ri-newspaper-line text-4xl text-gray-300"})})}),e.jsxs("div",{className:"p-4",children:[e.jsx("span",{className:"px-2 py-1 bg-emerald-100 text-emerald-700 text-xs font-medium rounded-full",children:s.category}),e.jsx("h3",{className:"text-base font-semibold text-gray-900 mt-3 line-clamp-2",children:s.title})]})]},s.id))})]})]})]}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(d,{}),e.jsxs("div",{className:"text-center py-20",children:[e.jsx("i",{className:"ri-file-damage-line text-5xl text-gray-300 mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Article not found"}),e.jsx(c,{to:"/news",className:"text-emerald-600 hover:text-emerald-700",children:"Back to news"})]})]})}export{E as default};
//# sourceMappingURL=NewsDetail-CSo2QTXP.js.map

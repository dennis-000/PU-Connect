import{j as e}from"./query-vendor-C4XoQ8tj.js";import{u as N,r as c}from"./react-vendor-BpnWQj_L.js";import{u as v,s as p,N as w,I as S}from"./index-BvprY0-k.js";import"./i18n-vendor-BT3zpxCT.js";import"./supabase-vendor-NSJvwn9b.js";const P=["Electronics","Books & Stationery","Fashion & Accessories","Food & Beverages","Sports & Fitness","Home & Living","Services","Other"];function q(){const i=N(),{profile:l,loading:n}=v(),[m,x]=c.useState(!1),[u,g]=c.useState([]),[r,t]=c.useState({name:"",description:"",category:"",price:"",priceType:"fixed",images:[],sellerId:""}),o=l?.role==="admin";c.useEffect(()=>{!n&&l?.role!=="seller"&&l?.role!=="admin"&&i("/seller/status")},[l,n,i]),c.useEffect(()=>{o?h():l?.id&&t(s=>({...s,sellerId:l.id}))},[o,l]);const h=async()=>{try{const{data:s,error:a}=await p.from("profiles").select("id, full_name, email").eq("role","seller").order("full_name");if(a)throw a;g(s||[])}catch(s){console.error("Error fetching sellers:",s)}},f=async s=>{if(s.preventDefault(),!r.name||!r.category){alert("Please fill in all required fields");return}if(!r.sellerId){alert("Please select a seller");return}x(!0);try{const a={seller_id:r.sellerId,name:r.name,description:r.description,category:r.category,price:r.priceType==="fixed"?parseFloat(r.price):null,price_type:r.priceType,images:r.images.length>0?r.images:null,is_active:!0,views_count:0},{error:d}=await p.from("products").insert([a]);if(d)throw d;alert("Product added successfully!"),i(o?"/admin/dashboard":"/seller/dashboard")}catch(a){console.error("Error adding product:",a),alert(a.message||"Failed to add product")}finally{x(!1)}},b=s=>{t(a=>({...a,images:[...a.images,s]}))},y=s=>{t(a=>({...a,images:a.images.filter((d,j)=>j!==s)}))};return n?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-teal-50 via-white to-blue-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("i",{className:"ri-loader-4-line text-4xl text-teal-600 animate-spin"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Loading..."})]})}):e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-teal-50 via-white to-blue-50",children:[e.jsx(w,{}),e.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-6 sm:py-8 lg:py-12",children:[e.jsxs("div",{className:"mb-6 sm:mb-8",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl lg:text-4xl font-bold text-gray-900",children:"Add New Product"}),e.jsx("p",{className:"mt-2 text-sm sm:text-base text-gray-600",children:"List a new product on the marketplace"})]}),e.jsx("div",{className:"bg-white rounded-2xl shadow-lg p-6 sm:p-8",children:e.jsxs("form",{onSubmit:f,className:"space-y-6",children:[o&&e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:["Select Seller ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:r.sellerId,onChange:s=>t({...r,sellerId:s.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-teal-500 focus:border-transparent text-sm transition-all",required:!0,children:[e.jsx("option",{value:"",children:"Choose a seller..."}),u.map(s=>e.jsxs("option",{value:s.id,children:[s.full_name," (",s.email,")"]},s.id))]}),e.jsx("p",{className:"mt-2 text-xs text-gray-500",children:"Select which seller this product belongs to"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"sm:col-span-2",children:[e.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:["Product Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:r.name,onChange:s=>t({...r,name:s.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-teal-500 focus:border-transparent text-sm transition-all",placeholder:"Enter product name",required:!0})]}),e.jsxs("div",{className:"sm:col-span-2",children:[e.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:["Category ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:r.category,onChange:s=>t({...r,category:s.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-teal-500 focus:border-transparent text-sm transition-all",required:!0,children:[e.jsx("option",{value:"",children:"Select a category"}),P.map(s=>e.jsx("option",{value:s,children:s},s))]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Description"}),e.jsx("textarea",{value:r.description,onChange:s=>t({...r,description:s.target.value}),rows:4,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-teal-500 focus:border-transparent text-sm transition-all resize-none",placeholder:"Describe your product..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Price Type"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsxs("label",{className:"flex items-center cursor-pointer bg-gray-50 px-4 py-3 rounded-xl border-2 border-gray-200 hover:border-teal-500 transition-all flex-1",children:[e.jsx("input",{type:"radio",value:"fixed",checked:r.priceType==="fixed",onChange:s=>t({...r,priceType:s.target.value}),className:"mr-3 w-4 h-4 text-teal-600"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-900",children:"Fixed Price"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Set a specific price"})]})]}),e.jsxs("label",{className:"flex items-center cursor-pointer bg-gray-50 px-4 py-3 rounded-xl border-2 border-gray-200 hover:border-teal-500 transition-all flex-1",children:[e.jsx("input",{type:"radio",value:"contact",checked:r.priceType==="contact",onChange:s=>t({...r,priceType:s.target.value}),className:"mr-3 w-4 h-4 text-teal-600"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-900",children:"Contact for Price"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Negotiate with buyers"})]})]})]})]}),r.priceType==="fixed"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Price (GHS)"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-500 font-medium",children:"â‚µ"}),e.jsx("input",{type:"number",step:"0.01",value:r.price,onChange:s=>t({...r,price:s.target.value}),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-teal-500 focus:border-transparent text-sm transition-all",placeholder:"0.00"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-4",children:"Product Images"}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4 mb-4",children:[r.images.map((s,a)=>e.jsxs("div",{className:"relative group",children:[e.jsx("div",{className:"aspect-square rounded-xl overflow-hidden bg-gray-100 border-2 border-gray-200",children:e.jsx("img",{src:s,alt:`Product ${a+1}`,className:"w-full h-full object-cover"})}),e.jsx("button",{type:"button",onClick:()=>y(a),className:"absolute -top-2 -right-2 w-8 h-8 bg-red-500 text-white rounded-full hover:bg-red-600 transition-all shadow-lg opacity-0 group-hover:opacity-100 cursor-pointer flex items-center justify-center",children:e.jsx("i",{className:"ri-close-line text-lg"})})]},a)),r.images.length<8&&e.jsx("div",{className:"aspect-square",children:e.jsx(S,{onImageUploaded:b,folder:"products",shape:"square",size:"medium",className:"w-full h-full"})})]}),e.jsxs("p",{className:"text-xs text-gray-500 flex items-center",children:[e.jsx("i",{className:"ri-information-line mr-1"}),"You can upload up to 8 images. First image will be the main product image."]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 pt-6 border-t border-gray-200",children:[e.jsxs("button",{type:"button",onClick:()=>i(o?"/admin/dashboard":"/seller/dashboard"),className:"flex-1 px-6 py-3 border-2 border-gray-300 text-gray-700 rounded-xl hover:bg-gray-50 transition-all font-medium whitespace-nowrap cursor-pointer",children:[e.jsx("i",{className:"ri-close-line mr-2"}),"Cancel"]}),e.jsx("button",{type:"submit",disabled:m,className:"flex-1 px-6 py-3 bg-teal-600 text-white rounded-xl hover:bg-teal-700 transition-all disabled:opacity-50 disabled:cursor-not-allowed font-medium whitespace-nowrap cursor-pointer shadow-md hover:shadow-lg",children:m?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"ri-loader-4-line animate-spin mr-2"}),"Adding Product..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"ri-add-line mr-2"}),"Add Product"]})})]})]})})]})]})}export{q as default};
//# sourceMappingURL=AddProduct-C2YBZtng.js.map

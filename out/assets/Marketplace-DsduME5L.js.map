{"version":3,"file":"Marketplace-DsduME5L.js","sources":["../../src/pages/marketplace/Marketplace.tsx"],"sourcesContent":["import { useState, useEffect, useMemo } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport Navbar from '../../components/feature/Navbar';\nimport { useProducts } from '../../hooks/useProducts';\nimport { useAuth } from '../../contexts/AuthContext';\nimport { supabase, type Profile } from '../../lib/supabase';\nimport { getOptimizedImageUrl } from '../../lib/imageOptimization';\n\nfunction Marketplace() {\n  const navigate = useNavigate();\n  const { user } = useAuth();\n  const { data: products, isLoading: productsLoading, error: productsError } = useProducts();\n  const [selectedCategory, setSelectedCategory] = useState('all');\n  const [searchQuery, setSearchQuery] = useState('');\n  const [priceRange, setPriceRange] = useState('all');\n  const [sortBy, setSortBy] = useState('newest');\n  const [favorites, setFavorites] = useState<string[]>([]);\n  const [isLoadingFavorites, setIsLoadingFavorites] = useState(false);\n  const [sellerProfiles, setSellerProfiles] = useState<Record<string, Profile>>({});\n\n  const loadFavorites = async () => {\n    if (!user) return;\n    \n    try {\n      const { data, error } = await supabase\n        .from('favorites')\n        .select('product_id')\n        .eq('user_id', user.id);\n\n      if (error) throw error;\n      setFavorites(data?.map(f => f.product_id) || []);\n    } catch (error) {\n      console.error('Error loading favorites:', error);\n    }\n  };\n\n  // Load favorites when user changes\n  useEffect(() => {\n    if (user) {\n      loadFavorites();\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [user]);\n\n  // Load seller profiles for all products - optimized\n  useEffect(() => {\n    if (products && products.length > 0) {\n      // Extract profiles from products data instead of making another query\n      const profilesMap: Record<string, Profile> = {};\n      products.forEach(product => {\n        if (product.seller) {\n          profilesMap[product.seller_id] = product.seller as Profile;\n        }\n      });\n      setSellerProfiles(profilesMap);\n    }\n  }, [products]);\n\n  const categories = [\n    { id: 'all', name: 'All Products', icon: 'ri-apps-line' },\n    { id: 'electronics', name: 'Electronics', icon: 'ri-smartphone-line' },\n    { id: 'books', name: 'Books', icon: 'ri-book-line' },\n    { id: 'fashion', name: 'Fashion', icon: 'ri-shirt-line' },\n    { id: 'food', name: 'Food', icon: 'ri-restaurant-line' },\n    { id: 'services', name: 'Services', icon: 'ri-service-line' },\n    { id: 'other', name: 'Other', icon: 'ri-more-line' }\n  ];\n\n  // Memoize filtered products to prevent unnecessary recalculations - MUST BE BEFORE EARLY RETURNS\n  const filteredProducts = useMemo(() => {\n    return (products || [])\n      .filter(product => {\n        const matchesCategory = selectedCategory === 'all' || product.category === selectedCategory;\n        const matchesSearch = product.name.toLowerCase().includes(searchQuery.toLowerCase()) ||\n                            product.description.toLowerCase().includes(searchQuery.toLowerCase());\n        \n        let matchesPrice = true;\n        if (product.price_type === 'fixed' && product.price) {\n          if (priceRange === 'under50') matchesPrice = product.price < 50;\n          else if (priceRange === '50-200') matchesPrice = product.price >= 50 && product.price <= 200;\n          else if (priceRange === 'over200') matchesPrice = product.price > 200;\n        }\n\n        return matchesCategory && matchesSearch && matchesPrice;\n      })\n      .sort((a, b) => {\n        if (sortBy === 'price-low' && a.price && b.price) return a.price - b.price;\n        if (sortBy === 'price-high' && a.price && b.price) return b.price - a.price;\n        if (sortBy === 'newest') return new Date(b.created_at).getTime() - new Date(a.created_at).getTime();\n        return 0;\n      });\n  }, [products, selectedCategory, searchQuery, priceRange, sortBy]);\n\n  // Show loader while products are loading\n  if (productsLoading) {\n    return (\n      <div className=\"min-h-screen bg-gray-50\">\n        <Navbar />\n        <div className=\"flex items-center justify-center py-20\">\n          <div className=\"text-center\">\n            <div className=\"w-16 h-16 border-4 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto\"></div>\n            <p className=\"mt-4 text-gray-600\">Loading products...</p>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  // Show error state\n  if (productsError) {\n    return (\n      <div className=\"min-h-screen bg-gray-50\">\n        <Navbar />\n        <div className=\"flex items-center justify-center py-20\">\n          <div className=\"text-center\">\n            <div className=\"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4\">\n              <i className=\"ri-error-warning-line text-3xl text-red-600\"></i>\n            </div>\n            <h3 className=\"text-xl font-semibold text-gray-800 mb-2\">Failed to load products</h3>\n            <p className=\"text-gray-600 mb-4\">Please check your connection and try again</p>\n            <button\n              onClick={() => window.location.reload()}\n              className=\"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors cursor-pointer whitespace-nowrap\"\n            >\n              Retry\n            </button>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  const toggleFavorite = async (productId: string) => {\n    if (!user) {\n      navigate('/login');\n      return;\n    }\n\n    setIsLoadingFavorites(true);\n    try {\n      const isFavorite = favorites.includes(productId);\n\n      if (isFavorite) {\n        const { error } = await supabase\n          .from('favorites')\n          .delete()\n          .eq('user_id', user.id)\n          .eq('product_id', productId);\n\n        if (error) throw error;\n        setFavorites(favorites.filter(id => id !== productId));\n      } else {\n        const { error } = await supabase\n          .from('favorites')\n          .insert({\n            user_id: user.id,\n            product_id: productId\n          });\n\n        if (error) throw error;\n        setFavorites([...favorites, productId]);\n      }\n    } catch (error) {\n      console.error('Error toggling favorite:', error);\n    } finally {\n      setIsLoadingFavorites(false);\n    }\n  };\n\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-amber-50 via-white to-sky-50\">\n      <Navbar />\n      \n      {/* Header */}\n      <div className=\"bg-gradient-to-r from-blue-600 to-blue-700 text-white py-12 md:py-16 lg:py-20 xl:py-24\">\n        <div className=\"max-w-7xl 2xl:max-w-[1400px] mx-auto px-4 sm:px-6 lg:px-8 xl:px-12\">\n          <h1 className=\"text-3xl md:text-4xl lg:text-5xl xl:text-6xl font-bold mb-4\">Campus Marketplace</h1>\n          <p className=\"text-blue-100 text-base md:text-lg lg:text-xl xl:text-2xl\">Discover amazing products from fellow students</p>\n        </div>\n      </div>\n\n      <div className=\"max-w-7xl 2xl:max-w-[1400px] mx-auto px-4 sm:px-6 lg:px-8 xl:px-12 py-8 md:py-12 lg:py-16\">\n        {/* Search and Filters */}\n        <div className=\"bg-white rounded-xl shadow-sm p-4 md:p-6 lg:p-8 xl:p-10 mb-8\">\n          {/* Search Bar */}\n          <div className=\"mb-6 lg:mb-8\">\n            <div className=\"relative\">\n              <i className=\"ri-search-line absolute left-4 lg:left-5 top-1/2 -translate-y-1/2 text-gray-400 text-lg lg:text-xl\"></i>\n              <input\n                type=\"text\"\n                placeholder=\"Search products...\"\n                value={searchQuery}\n                onChange={(e) => setSearchQuery(e.target.value)}\n                className=\"w-full pl-12 lg:pl-14 pr-4 py-3 lg:py-4 xl:py-5 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm md:text-base lg:text-lg\"\n              />\n            </div>\n          </div>\n\n          {/* Categories */}\n          <div className=\"mb-6 lg:mb-8\">\n            <h3 className=\"text-sm lg:text-base xl:text-lg font-semibold text-gray-700 mb-3 lg:mb-4\">Categories</h3>\n            <div className=\"flex flex-wrap gap-2 lg:gap-3\">\n              {categories.map(category => (\n                <button\n                  key={category.id}\n                  onClick={() => setSelectedCategory(category.id)}\n                  className={`flex items-center gap-2 px-3 md:px-4 lg:px-5 xl:px-6 py-2 lg:py-2.5 xl:py-3 rounded-lg text-xs md:text-sm lg:text-base font-medium transition-all whitespace-nowrap cursor-pointer ${\n                    selectedCategory === category.id\n                      ? 'bg-blue-600 text-white shadow-md'\n                      : 'bg-gray-100 text-gray-700 hover:bg-gray-200'\n                  }`}\n                >\n                  <i className={`${category.icon} text-sm md:text-base lg:text-lg`}></i>\n                  <span className=\"hidden sm:inline\">{category.name}</span>\n                </button>\n              ))}\n            </div>\n          </div>\n\n          {/* Filters */}\n          <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4 lg:gap-6\">\n            {/* Price Range */}\n            <div>\n              <label className=\"block text-sm lg:text-base font-medium text-gray-700 mb-2 lg:mb-3\">Price Range</label>\n              <select\n                value={priceRange}\n                onChange={(e) => setPriceRange(e.target.value)}\n                className=\"w-full px-4 lg:px-5 py-2 lg:py-3 xl:py-4 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm lg:text-base\"\n              >\n                <option value=\"all\">All Prices</option>\n                <option value=\"under50\">Under GH₵ 50</option>\n                <option value=\"50-200\">GH₵ 50 - GH₵ 200</option>\n                <option value=\"over200\">Over GH₵ 200</option>\n              </select>\n            </div>\n\n            {/* Sort By */}\n            <div>\n              <label className=\"block text-sm lg:text-base font-medium text-gray-700 mb-2 lg:mb-3\">Sort By</label>\n              <select\n                value={sortBy}\n                onChange={(e) => setSortBy(e.target.value)}\n                className=\"w-full px-4 lg:px-5 py-2 lg:py-3 xl:py-4 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm lg:text-base\"\n              >\n                <option value=\"newest\">Newest First</option>\n                <option value=\"price-low\">Price: Low to High</option>\n                <option value=\"price-high\">Price: High to Low</option>\n              </select>\n            </div>\n          </div>\n        </div>\n\n        {/* Results Count */}\n        <div className=\"mb-6 lg:mb-8\">\n          <p className=\"text-gray-600 text-sm md:text-base lg:text-lg\">\n            Showing <span className=\"font-semibold text-blue-600\">{filteredProducts.length}</span> products\n          </p>\n        </div>\n\n        {/* Products Grid */}\n        {filteredProducts.length === 0 ? (\n          <div className=\"text-center py-16 lg:py-24\">\n            <div className=\"w-20 h-20 lg:w-24 lg:h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4\">\n              <i className=\"ri-shopping-bag-line text-4xl lg:text-5xl text-gray-400\"></i>\n            </div>\n            <h3 className=\"text-xl lg:text-2xl font-semibold text-gray-800 mb-2\">No products found</h3>\n            <p className=\"text-gray-600 lg:text-lg\">Try adjusting your filters or search query</p>\n          </div>\n        ) : (\n          <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 2xl:grid-cols-5 gap-4 md:gap-6 lg:gap-8\">\n            {filteredProducts.map(product => {\n              const seller = sellerProfiles[product.seller_id];\n              return (\n                <div\n                  key={product.id}\n                  className=\"bg-white rounded-xl shadow-sm hover:shadow-lg transition-all duration-300 overflow-hidden group cursor-pointer\"\n                  onClick={() => navigate(`/product/${product.id}`)}\n                >\n                  {/* Product Image */}\n                  <div className=\"relative h-48 md:h-56 lg:h-64 xl:h-72 overflow-hidden bg-gray-100\">\n                    <img\n                      src={getOptimizedImageUrl(product.images?.[0], 400, 80) || 'https://readdy.ai/api/search-image?query=product%20placeholder%20simple%20background&width=400&height=400&seq=marketplace-placeholder&orientation=squarish'}\n                      alt={product.name}\n                      className=\"w-full h-full object-cover group-hover:scale-110 transition-transform duration-300\"\n                      loading=\"lazy\"\n                      decoding=\"async\"\n                    />\n                    \n                    {/* Favorite Button */}\n                    <button\n                      onClick={(e) => {\n                        e.stopPropagation();\n                        toggleFavorite(product.id);\n                      }}\n                      disabled={isLoadingFavorites}\n                      className=\"absolute top-3 right-3 w-9 h-9 lg:w-10 lg:h-10 bg-white rounded-full shadow-md flex items-center justify-center hover:bg-blue-50 transition-colors z-10 cursor-pointer\"\n                    >\n                      <i className={`${favorites.includes(product.id) ? 'ri-heart-fill text-red-500' : 'ri-heart-line text-gray-600'} text-lg lg:text-xl`}></i>\n                    </button>\n\n                    {/* Category Badge */}\n                    <div className=\"absolute top-3 left-3 bg-white/90 backdrop-blur-sm px-3 py-1 lg:px-4 lg:py-1.5 rounded-full\">\n                      <span className=\"text-xs lg:text-sm font-medium text-gray-700 capitalize\">{product.category}</span>\n                    </div>\n\n                    {/* Seller Profile Badge */}\n                    {seller && (\n                      <div className=\"absolute bottom-3 left-3 flex items-center space-x-2 bg-white/95 backdrop-blur-sm px-3 py-1.5 lg:px-4 lg:py-2 rounded-full\">\n                        {seller.avatar_url ? (\n                          <img\n                            src={seller.avatar_url}\n                            alt={seller.full_name}\n                            className=\"w-5 h-5 lg:w-6 lg:h-6 rounded-full object-cover border border-blue-500\"\n                            loading=\"lazy\"\n                          />\n                        ) : (\n                          <div className=\"w-5 h-5 lg:w-6 lg:h-6 bg-gradient-to-br from-blue-500 to-yellow-400 rounded-full flex items-center justify-center\">\n                            <span className=\"text-white font-bold text-xs\">\n                              {seller.full_name?.charAt(0).toUpperCase()}\n                            </span>\n                          </div>\n                        )}\n                        <span className=\"text-xs lg:text-sm font-medium text-gray-700\">{seller.full_name}</span>\n                      </div>\n                    )}\n                  </div>\n\n                  {/* Product Info */}\n                  <div className=\"p-4 lg:p-5 xl:p-6\">\n                    <h3 className=\"font-semibold text-gray-800 mb-2 line-clamp-2 text-sm md:text-base lg:text-lg group-hover:text-blue-600 transition-colors\">\n                      {product.name}\n                    </h3>\n                    <p className=\"text-gray-600 text-xs md:text-sm lg:text-base mb-3 line-clamp-2\">{product.description}</p>\n                    \n                    <div className=\"flex items-center justify-between\">\n                      {product.price_type === 'fixed' && product.price ? (\n                        <span className=\"text-xl md:text-2xl lg:text-3xl font-bold text-blue-600\">\n                          GH₵ {product.price.toFixed(2)}\n                        </span>\n                      ) : (\n                        <span className=\"text-sm md:text-base lg:text-lg font-semibold text-blue-600\">\n                          Contact for Price\n                        </span>\n                      )}\n                      <button\n                        onClick={(e) => {\n                          e.stopPropagation();\n                          navigate(`/product/${product.id}`);\n                        }}\n                        className=\"px-4 py-2 lg:px-5 lg:py-2.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm lg:text-base font-medium whitespace-nowrap cursor-pointer\"\n                      >\n                        View Details\n                      </button>\n                    </div>\n                  </div>\n                </div>\n              );\n            })}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n\nexport default Marketplace;\n"],"names":["Marketplace","navigate","useNavigate","user","useAuth","products","productsLoading","productsError","useProducts","selectedCategory","setSelectedCategory","useState","searchQuery","setSearchQuery","priceRange","setPriceRange","sortBy","setSortBy","favorites","setFavorites","isLoadingFavorites","setIsLoadingFavorites","sellerProfiles","setSellerProfiles","loadFavorites","data","error","supabase","f","useEffect","profilesMap","product","categories","filteredProducts","useMemo","matchesCategory","matchesSearch","matchesPrice","a","b","jsxs","jsx","Navbar","toggleFavorite","productId","id","e","category","seller","getOptimizedImageUrl"],"mappings":"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"}
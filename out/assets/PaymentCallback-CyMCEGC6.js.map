{"version":3,"file":"PaymentCallback-CyMCEGC6.js","sources":["../../src/pages/payment/PaymentCallback.tsx"],"sourcesContent":["import { useEffect, useState } from 'react';\nimport { useNavigate, useSearchParams } from 'react-router-dom';\nimport { useAuth } from '../../contexts/AuthContext';\nimport { supabase } from '../../lib/supabase';\nimport Navbar from '../../components/feature/Navbar';\n\nexport default function PaymentCallback() {\n  const [searchParams] = useSearchParams();\n  const navigate = useNavigate();\n  const { user } = useAuth();\n  const [status, setStatus] = useState<'verifying' | 'success' | 'failed'>('verifying');\n  const [message, setMessage] = useState('Verifying your payment...');\n\n  useEffect(() => {\n    const reference = searchParams.get('reference');\n    \n    if (!reference || !user) {\n      setStatus('failed');\n      setMessage('Invalid payment reference');\n      return;\n    }\n\n    verifyPayment(reference);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [searchParams, user]);\n\n  const verifyPayment = async (reference: string) => {\n    try {\n      const { data, error } = await supabase.functions.invoke('verify-paystack-payment', {\n        body: {\n          reference,\n          seller_id: user?.id,\n        },\n      });\n\n      if (error) throw error;\n\n      if (data.success) {\n        setStatus('success');\n        setMessage('Payment successful! Your seller account is now active.');\n        \n        // Update local profile\n        setTimeout(() => {\n          window.location.href = '/seller/dashboard';\n        }, 3000);\n      } else {\n        setStatus('failed');\n        setMessage('Payment verification failed. Please contact support.');\n      }\n    } catch (err: any) {\n      console.error('Verification error:', err);\n      setStatus('failed');\n      setMessage('Failed to verify payment. Please contact support with your payment reference.');\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gray-50\">\n      <Navbar />\n      \n      <div className=\"max-w-2xl mx-auto px-4 py-16\">\n        <div className=\"bg-white rounded-2xl shadow-lg p-8 text-center\">\n          {status === 'verifying' && (\n            <>\n              <div className=\"w-20 h-20 bg-sky-100 rounded-full flex items-center justify-center mx-auto mb-6\">\n                <i className=\"ri-loader-4-line text-4xl text-sky-600 animate-spin\"></i>\n              </div>\n              <h2 className=\"text-2xl font-bold text-gray-900 mb-4\">Verifying Payment</h2>\n              <p className=\"text-gray-600\">{message}</p>\n            </>\n          )}\n\n          {status === 'success' && (\n            <>\n              <div className=\"w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-6\">\n                <i className=\"ri-check-line text-4xl text-green-600\"></i>\n              </div>\n              <h2 className=\"text-2xl font-bold text-gray-900 mb-4\">Payment Successful!</h2>\n              <p className=\"text-gray-600 mb-6\">{message}</p>\n              <div className=\"inline-flex items-center gap-2 text-sm text-gray-500\">\n                <i className=\"ri-time-line\"></i>\n                <span>Redirecting to your dashboard...</span>\n              </div>\n            </>\n          )}\n\n          {status === 'failed' && (\n            <>\n              <div className=\"w-20 h-20 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-6\">\n                <i className=\"ri-close-line text-4xl text-red-600\"></i>\n              </div>\n              <h2 className=\"text-2xl font-bold text-gray-900 mb-4\">Payment Failed</h2>\n              <p className=\"text-gray-600 mb-6\">{message}</p>\n              <button\n                onClick={() => navigate('/seller/become')}\n                className=\"px-6 py-3 bg-sky-600 text-white font-medium rounded-lg hover:bg-sky-700 transition-colors whitespace-nowrap cursor-pointer\"\n              >\n                Try Again\n              </button>\n            </>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":["PaymentCallback","searchParams","useSearchParams","navigate","useNavigate","user","useAuth","status","setStatus","useState","message","setMessage","useEffect","reference","verifyPayment","data","error","supabase","err","jsxs","jsx","Navbar","Fragment"],"mappings":"0OAMA,SAAwBA,GAAkB,CACxC,KAAM,CAACC,CAAY,EAAIC,EAAA,EACjBC,EAAWC,EAAA,EACX,CAAE,KAAAC,CAAA,EAASC,EAAA,EACX,CAACC,EAAQC,CAAS,EAAIC,EAAAA,SAA6C,WAAW,EAC9E,CAACC,EAASC,CAAU,EAAIF,EAAAA,SAAS,2BAA2B,EAElEG,EAAAA,UAAU,IAAM,CACd,MAAMC,EAAYZ,EAAa,IAAI,WAAW,EAE9C,GAAI,CAACY,GAAa,CAACR,EAAM,CACvBG,EAAU,QAAQ,EAClBG,EAAW,2BAA2B,EACtC,MACF,CAEAG,EAAcD,CAAS,CAEzB,EAAG,CAACZ,EAAcI,CAAI,CAAC,EAEvB,MAAMS,EAAgB,MAAOD,GAAsB,CACjD,GAAI,CACF,KAAM,CAAE,KAAAE,EAAM,MAAAC,CAAA,EAAU,MAAMC,EAAS,UAAU,OAAO,0BAA2B,CACjF,KAAM,CACJ,UAAAJ,EACA,UAAWR,GAAM,EAAA,CACnB,CACD,EAED,GAAIW,EAAO,MAAMA,EAEbD,EAAK,SACPP,EAAU,SAAS,EACnBG,EAAW,wDAAwD,EAGnE,WAAW,IAAM,CACf,OAAO,SAAS,KAAO,mBACzB,EAAG,GAAI,IAEPH,EAAU,QAAQ,EAClBG,EAAW,sDAAsD,EAErE,OAASO,EAAU,CACjB,QAAQ,MAAM,sBAAuBA,CAAG,EACxCV,EAAU,QAAQ,EAClBG,EAAW,+EAA+E,CAC5F,CACF,EAEA,OACEQ,EAAAA,KAAC,MAAA,CAAI,UAAU,0BACb,SAAA,CAAAC,EAAAA,IAACC,EAAA,EAAO,QAEP,MAAA,CAAI,UAAU,+BACb,SAAAF,EAAAA,KAAC,MAAA,CAAI,UAAU,iDACZ,SAAA,CAAAZ,IAAW,aACVY,EAAAA,KAAAG,EAAAA,SAAA,CACE,SAAA,CAAAF,EAAAA,IAAC,OAAI,UAAU,kFACb,eAAC,IAAA,CAAE,UAAU,sDAAsD,CAAA,CACrE,EACAA,EAAAA,IAAC,KAAA,CAAG,UAAU,wCAAwC,SAAA,oBAAiB,EACvEA,EAAAA,IAAC,IAAA,CAAE,UAAU,gBAAiB,SAAAV,CAAA,CAAQ,CAAA,EACxC,EAGDH,IAAW,WACVY,EAAAA,KAAAG,EAAAA,SAAA,CACE,SAAA,CAAAF,EAAAA,IAAC,OAAI,UAAU,oFACb,eAAC,IAAA,CAAE,UAAU,wCAAwC,CAAA,CACvD,EACAA,EAAAA,IAAC,KAAA,CAAG,UAAU,wCAAwC,SAAA,sBAAmB,EACzEA,EAAAA,IAAC,IAAA,CAAE,UAAU,qBAAsB,SAAAV,EAAQ,EAC3CS,EAAAA,KAAC,MAAA,CAAI,UAAU,uDACb,SAAA,CAAAC,EAAAA,IAAC,IAAA,CAAE,UAAU,cAAA,CAAe,EAC5BA,EAAAA,IAAC,QAAK,SAAA,kCAAA,CAAgC,CAAA,CAAA,CACxC,CAAA,EACF,EAGDb,IAAW,UACVY,EAAAA,KAAAG,EAAAA,SAAA,CACE,SAAA,CAAAF,EAAAA,IAAC,OAAI,UAAU,kFACb,eAAC,IAAA,CAAE,UAAU,sCAAsC,CAAA,CACrD,EACAA,EAAAA,IAAC,KAAA,CAAG,UAAU,wCAAwC,SAAA,iBAAc,EACpEA,EAAAA,IAAC,IAAA,CAAE,UAAU,qBAAsB,SAAAV,EAAQ,EAC3CU,EAAAA,IAAC,SAAA,CACC,QAAS,IAAMjB,EAAS,gBAAgB,EACxC,UAAU,6HACX,SAAA,WAAA,CAAA,CAED,CAAA,CACF,CAAA,CAAA,CAEJ,CAAA,CACF,CAAA,EACF,CAEJ"}
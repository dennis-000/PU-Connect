import{j as e}from"./query-vendor-C4XoQ8tj.js";import{u as w,e as S,r as o}from"./react-vendor-BpnWQj_L.js";import{u as C,s as h,N as k,I as _}from"./index-BvprY0-k.js";import"./i18n-vendor-BT3zpxCT.js";import"./supabase-vendor-NSJvwn9b.js";const F=["Electronics","Books & Stationery","Fashion & Accessories","Food & Beverages","Sports & Fitness","Home & Living","Services","Other"];function D(){const l=w(),{id:i}=S(),{user:c,profile:n}=C(),[b,p]=o.useState(!0),[x,u]=o.useState(!1),[g,d]=o.useState(null),[s,t]=o.useState({name:"",description:"",category:"",price:"",priceType:"fixed",images:[],whatsapp_number:""});o.useEffect(()=>{if(!c||n?.role!=="seller"&&n?.role!=="admin"){l("/marketplace");return}i&&f()},[i,c,n,l]);const f=async()=>{if(i){p(!0);try{const{data:r,error:a}=await h.from("products").select("*").eq("id",i).single();if(a)throw a;if(r){if(r.seller_id!==c?.id&&n?.role!=="admin"){l("/seller/dashboard");return}t({name:r.name||"",description:r.description||"",category:r.category||"",price:r.price?.toString()||"",priceType:r.price_type||"fixed",images:r.images||[],whatsapp_number:r.whatsapp_number||""})}}catch(r){console.error("Error fetching product:",r),d("Failed to load product")}finally{p(!1)}}},y=async r=>{r.preventDefault(),u(!0),d(null);try{const a={name:s.name,description:s.description,category:s.category,price:s.priceType==="fixed"?parseFloat(s.price):null,price_type:s.priceType,images:s.images.length>0?s.images:null,whatsapp_number:s.whatsapp_number||null,updated_at:new Date().toISOString()},{error:m}=await h.from("products").update(a).eq("id",i);if(m)throw m;l("/seller/dashboard")}catch(a){d(a.message||"Failed to update product")}finally{u(!1)}},j=r=>{t(a=>({...a,images:[...a.images,r]}))},N=r=>{t(a=>({...a,images:a.images.filter((m,v)=>v!==r)}))};return b?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-teal-50 via-white to-blue-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("i",{className:"ri-loader-4-line text-4xl text-teal-600 animate-spin"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Loading product..."})]})}):e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-teal-50 via-white to-blue-50",children:[e.jsx(k,{}),e.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-6 sm:py-8 lg:py-12",children:[e.jsxs("div",{className:"mb-6 sm:mb-8",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl lg:text-4xl font-bold text-gray-900",children:"Edit Product"}),e.jsx("p",{className:"mt-2 text-sm sm:text-base text-gray-600",children:"Update your product information"})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6 sm:p-8",children:[g&&e.jsxs("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg flex items-start",children:[e.jsx("i",{className:"ri-error-warning-line text-red-600 text-xl mr-3 mt-0.5"}),e.jsx("p",{className:"text-sm text-red-600",children:g})]}),e.jsxs("form",{onSubmit:y,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"sm:col-span-2",children:[e.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:["Product Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:s.name,onChange:r=>t({...s,name:r.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-teal-500 focus:border-transparent text-sm transition-all",placeholder:"Enter product name",required:!0})]}),e.jsxs("div",{className:"sm:col-span-2",children:[e.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:["Category ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:s.category,onChange:r=>t({...s,category:r.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-teal-500 focus:border-transparent text-sm transition-all",required:!0,children:[e.jsx("option",{value:"",children:"Select a category"}),F.map(r=>e.jsx("option",{value:r,children:r},r))]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Description"}),e.jsx("textarea",{value:s.description,onChange:r=>t({...s,description:r.target.value}),rows:4,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-teal-500 focus:border-transparent text-sm transition-all resize-none",placeholder:"Describe your product..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Price Type"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsxs("label",{className:"flex items-center cursor-pointer bg-gray-50 px-4 py-3 rounded-xl border-2 border-gray-200 hover:border-teal-500 transition-all flex-1",children:[e.jsx("input",{type:"radio",value:"fixed",checked:s.priceType==="fixed",onChange:r=>t({...s,priceType:r.target.value}),className:"mr-3 w-4 h-4 text-teal-600"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-900",children:"Fixed Price"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Set a specific price"})]})]}),e.jsxs("label",{className:"flex items-center cursor-pointer bg-gray-50 px-4 py-3 rounded-xl border-2 border-gray-200 hover:border-teal-500 transition-all flex-1",children:[e.jsx("input",{type:"radio",value:"contact",checked:s.priceType==="contact",onChange:r=>t({...s,priceType:r.target.value}),className:"mr-3 w-4 h-4 text-teal-600"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-900",children:"Contact for Price"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Negotiate with buyers"})]})]})]})]}),s.priceType==="fixed"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Price (GHS)"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-500 font-medium",children:"â‚µ"}),e.jsx("input",{type:"number",step:"0.01",value:s.price,onChange:r=>t({...s,price:r.target.value}),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-teal-500 focus:border-transparent text-sm transition-all",placeholder:"0.00"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"WhatsApp Number (Optional)"}),e.jsx("input",{type:"tel",value:s.whatsapp_number,onChange:r=>t({...s,whatsapp_number:r.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-teal-500 focus:border-transparent text-sm transition-all",placeholder:"+233 XX XXX XXXX"}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Buyers can contact you directly on WhatsApp"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-4",children:"Product Images"}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4 mb-4",children:[s.images.map((r,a)=>e.jsxs("div",{className:"relative group",children:[e.jsx("div",{className:"aspect-square rounded-xl overflow-hidden bg-gray-100 border-2 border-gray-200",children:e.jsx("img",{src:r,alt:`Product ${a+1}`,className:"w-full h-full object-cover",loading:"lazy"})}),e.jsx("button",{type:"button",onClick:()=>N(a),className:"absolute -top-2 -right-2 w-8 h-8 bg-red-500 text-white rounded-full hover:bg-red-600 transition-all shadow-lg opacity-0 group-hover:opacity-100 cursor-pointer flex items-center justify-center",children:e.jsx("i",{className:"ri-close-line text-lg"})})]},a)),s.images.length<8&&e.jsx("div",{className:"aspect-square",children:e.jsx(_,{onImageUploaded:j,folder:"products",shape:"square",size:"medium",className:"w-full h-full"})})]}),e.jsxs("p",{className:"text-xs text-gray-500 flex items-center",children:[e.jsx("i",{className:"ri-information-line mr-1"}),"You can upload up to 8 images. First image will be the main product image."]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 pt-6 border-t border-gray-200",children:[e.jsxs("button",{type:"button",onClick:()=>l("/seller/dashboard"),className:"flex-1 px-6 py-3 border-2 border-gray-300 text-gray-700 rounded-xl hover:bg-gray-50 transition-all font-medium whitespace-nowrap cursor-pointer",children:[e.jsx("i",{className:"ri-close-line mr-2"}),"Cancel"]}),e.jsx("button",{type:"submit",disabled:x,className:"flex-1 px-6 py-3 bg-teal-600 text-white rounded-xl hover:bg-teal-700 transition-all disabled:opacity-50 disabled:cursor-not-allowed font-medium whitespace-nowrap cursor-pointer shadow-md hover:shadow-lg",children:x?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"ri-loader-4-line animate-spin mr-2"}),"Saving Changes..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"ri-save-line mr-2"}),"Save Changes"]})})]})]})]})]})]})}export{D as default};
//# sourceMappingURL=EditProduct-_BBb2fNS.js.map

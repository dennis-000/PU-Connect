import{j as e}from"./query-vendor-C4XoQ8tj.js";import{u as y,r as i}from"./react-vendor-BpnWQj_L.js";import{u as _,s as l,N as A}from"./index-BvprY0-k.js";import"./i18n-vendor-BT3zpxCT.js";import"./supabase-vendor-NSJvwn9b.js";function q(){const{profile:n}=_(),x=y(),[d,b]=i.useState([]),[u,o]=i.useState(!0),[c,p]=i.useState(""),[f,h]=i.useState(""),[g,j]=i.useState("success");i.useEffect(()=>{if(n?.role!=="super_admin"){x("/admin/dashboard");return}m()},[n,x]);const m=async()=>{try{const{data:s,error:t}=await l.from("system_admins").select(`
          *,
          profile:profiles!system_admins_user_id_fkey(full_name, email, avatar_url)
        `).order("granted_at",{ascending:!1});if(t)throw t;b(s||[])}catch(s){console.error("Error fetching admins:",s),r("Failed to load admins","error")}finally{o(!1)}},r=(s,t)=>{h(s),j(t),setTimeout(()=>h(""),5e3)},N=async()=>{if(!c.trim()){r("Please enter an email address","error");return}o(!0);try{const{data:s,error:t}=await l.from("profiles").select("id, email, full_name, role").eq("email",c.trim()).single();if(t||!s){r("User not found with this email","error"),o(!1);return}const{error:a}=await l.from("profiles").update({role:"super_admin"}).eq("id",s.id);if(a)throw a;const{error:v}=await l.from("system_admins").insert({user_id:s.id,granted_by:n?.id,is_active:!0});if(v)throw v;r(`Successfully granted super admin access to ${s.full_name}`,"success"),p(""),m()}catch(s){console.error("Error granting super admin:",s),r(s.message||"Failed to grant super admin access","error")}finally{o(!1)}},w=async(s,t)=>{try{const{error:a}=await l.from("system_admins").update({is_active:!t}).eq("id",s);if(a)throw a;r(`Admin status ${t?"deactivated":"activated"} successfully`,"success"),m()}catch(a){console.error("Error updating admin status:",a),r("Failed to update admin status","error")}};return n?.role!=="super_admin"?null:e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-white to-slate-50",children:[e.jsx(A,{}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-purple-600 to-pink-600 rounded-xl flex items-center justify-center",children:e.jsx("i",{className:"ri-shield-star-line text-white text-2xl"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-slate-900",children:"Super Admin Management"}),e.jsx("p",{className:"text-slate-600 text-sm",children:"Manage system administrators with full access"})]})]})}),f&&e.jsx("div",{className:`mb-6 p-4 rounded-xl border ${g==="success"?"bg-green-50 border-green-200 text-green-800":"bg-red-50 border-red-200 text-red-800"}`,children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("i",{className:`${g==="success"?"ri-check-line":"ri-error-warning-line"} text-lg`}),e.jsx("p",{className:"text-sm font-medium",children:f})]})}),e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-6 mb-8 shadow-sm",children:[e.jsxs("h2",{className:"text-lg font-bold text-slate-900 mb-4 flex items-center",children:[e.jsx("i",{className:"ri-user-add-line mr-2 text-purple-600"}),"Grant Super Admin Access"]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("input",{type:"email",value:c,onChange:s=>p(s.target.value),placeholder:"Enter user email address",className:"flex-1 px-4 py-3 border border-slate-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-purple-500 text-sm"}),e.jsxs("button",{onClick:N,disabled:u||!c.trim(),className:"px-6 py-3 bg-gradient-to-r from-purple-600 to-pink-600 text-white rounded-xl hover:from-purple-700 hover:to-pink-700 transition-all font-medium text-sm whitespace-nowrap disabled:opacity-50 disabled:cursor-not-allowed cursor-pointer",children:[e.jsx("i",{className:"ri-shield-check-line mr-2"}),"Grant Access"]})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-sm overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b border-slate-200",children:e.jsxs("h2",{className:"text-lg font-bold text-slate-900 flex items-center",children:[e.jsx("i",{className:"ri-shield-user-line mr-2 text-purple-600"}),"System Administrators (",d.length,")"]})}),u?e.jsxs("div",{className:"p-12 text-center",children:[e.jsx("i",{className:"ri-loader-4-line text-4xl text-slate-400 animate-spin"}),e.jsx("p",{className:"text-slate-600 mt-4",children:"Loading administrators..."})]}):d.length===0?e.jsxs("div",{className:"p-12 text-center",children:[e.jsx("i",{className:"ri-shield-user-line text-6xl text-slate-300"}),e.jsx("p",{className:"text-slate-600 mt-4",children:"No super admins found"})]}):e.jsx("div",{className:"divide-y divide-slate-200",children:d.map(s=>e.jsx("div",{className:"p-6 hover:bg-slate-50 transition-colors",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-purple-500 to-pink-500 rounded-full flex items-center justify-center",children:s.profile?.avatar_url?e.jsx("img",{src:s.profile.avatar_url,alt:s.profile.full_name,className:"w-full h-full rounded-full object-cover"}):e.jsx("span",{className:"text-white font-bold text-lg",children:s.profile?.full_name?.charAt(0)||"A"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-slate-900",children:s.profile?.full_name||"Unknown"}),e.jsx("p",{className:"text-sm text-slate-600",children:s.profile?.email||"No email"}),e.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["Granted: ",new Date(s.granted_at).toLocaleDateString()]})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:`px-3 py-1 text-xs font-medium rounded-full ${s.is_active?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:s.is_active?"Active":"Inactive"}),e.jsx("button",{onClick:()=>w(s.id,s.is_active),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors whitespace-nowrap cursor-pointer ${s.is_active?"bg-red-100 text-red-700 hover:bg-red-200":"bg-green-100 text-green-700 hover:bg-green-200"}`,children:s.is_active?"Deactivate":"Activate"})]})]})},s.id))})]})]})]})}export{q as default};
//# sourceMappingURL=SuperAdminManagement-B-O5dGiv.js.map

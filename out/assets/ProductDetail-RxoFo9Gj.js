import{j as e}from"./query-vendor-C4XoQ8tj.js";import{e as b,u as f,r as n,L as m}from"./react-vendor-BpnWQj_L.js";import{u as j,s as o,N as c}from"./index-BvprY0-k.js";import{g as y}from"./imageOptimization-D09L3Qvw.js";import"./i18n-vendor-BT3zpxCT.js";import"./supabase-vendor-NSJvwn9b.js";function q(){const{id:a}=b(),{user:l}=j(),i=f(),[s,x]=n.useState(null),[p,d]=n.useState(!0);n.useEffect(()=>{a&&u()},[a]);const u=async()=>{d(!0);const{data:t,error:r}=await o.from("products").select("*, seller:profiles!seller_id(*)").eq("id",a).single();!r&&t&&x(t),d(!1)},g=()=>{if(!s?.whatsapp_number){alert("WhatsApp number not available");return}const t=encodeURIComponent(`Hi! I'm interested in your product: ${s.name}`),r=`https://wa.me/${s.whatsapp_number.replace(/[^0-9]/g,"")}?text=${t}`;window.open(r,"_blank")},h=async()=>{if(!l){i("/login");return}if(!s)return;const{data:t}=await o.from("conversations").select("id").eq("buyer_id",l.id).eq("seller_id",s.seller_id).eq("product_id",s.id).single();if(t){i("/messages");return}const{error:r}=await o.from("conversations").insert({buyer_id:l.id,seller_id:s.seller_id,product_id:s.id,last_message:"Conversation started",last_message_at:new Date().toISOString()});r?(console.error("Error creating conversation:",r),alert("Failed to start conversation. Please try again.")):i("/messages")};return p?e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(c,{}),e.jsxs("div",{className:"text-center py-20",children:[e.jsx("div",{className:"inline-block w-10 h-10 border-4 border-gray-200 border-t-blue-600 rounded-full animate-spin"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Loading product..."})]})]}):s?e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(c,{}),e.jsxs("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs(m,{to:"/marketplace",className:"inline-flex items-center text-blue-600 hover:text-blue-700 mb-6 cursor-pointer",children:[e.jsx("i",{className:"ri-arrow-left-line mr-2"}),"Back to marketplace"]}),e.jsx("div",{className:"bg-white rounded-2xl border border-gray-200 overflow-hidden",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 p-8",children:[e.jsx("div",{className:"aspect-square bg-gray-100 rounded-xl overflow-hidden",children:s.images&&s.images.length>0?e.jsx("img",{src:y(s.images[0],800,85),alt:s.name,className:"w-full h-full object-cover",loading:"eager",decoding:"async",onError:t=>{t.currentTarget.src="https://readdy.ai/api/search-image?query=product%20placeholder&width=800&height=800&seq=product-detail-placeholder&orientation=squarish"}}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx("i",{className:"ri-image-line text-6xl text-gray-300"})})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("div",{className:"mb-4",children:e.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-700 text-sm font-medium rounded-full",children:s.category})}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-4",children:s.name}),e.jsx("div",{className:"mb-6",children:s.price_type==="fixed"?e.jsxs("p",{className:"text-3xl font-bold text-blue-600",children:["GHâ‚µ ",s.price?.toFixed(2)]}):e.jsx("p",{className:"text-xl font-semibold text-gray-600",children:"Contact for price"})}),e.jsxs("div",{className:"mb-6 pb-6 border-b border-gray-200",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-2",children:"Description"}),e.jsx("p",{className:"text-gray-700 leading-relaxed",children:s.description||"No description available"})]}),e.jsxs("div",{className:"mb-6 pb-6 border-b border-gray-200",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-3",children:"Seller Information"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[s.seller?.avatar_url?e.jsx("img",{src:s.seller.avatar_url,alt:s.seller.full_name,className:"w-12 h-12 rounded-full object-cover border-2 border-blue-500"}):e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500 to-yellow-400 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white font-bold text-lg",children:s.seller?.full_name?.charAt(0).toUpperCase()||"S"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-900",children:s.seller?.full_name||"Unknown Seller"}),e.jsx("p",{className:"text-sm text-gray-600",children:s.seller?.department||"Department not specified"})]})]})]}),e.jsxs("div",{className:"space-y-3 mt-auto",children:[e.jsxs("button",{onClick:g,className:"w-full px-6 py-4 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 transition-colors flex items-center justify-center space-x-2 whitespace-nowrap cursor-pointer",disabled:!s?.whatsapp_number,children:[e.jsx("i",{className:"ri-whatsapp-line text-xl"}),e.jsx("span",{children:"Contact on WhatsApp"})]}),e.jsxs("button",{onClick:h,className:"w-full px-6 py-4 bg-gray-900 text-white font-semibold rounded-lg hover:bg-gray-800 transition-colors flex items-center justify-center space-x-2 whitespace-nowrap cursor-pointer",children:[e.jsx("i",{className:"ri-message-line text-xl"}),e.jsx("span",{children:"Send Message"})]})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-4 text-center",children:"No payment on platform - contact seller directly to arrange payment"})]})]})})]})]}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(c,{}),e.jsxs("div",{className:"text-center py-20",children:[e.jsx("i",{className:"ri-shopping-bag-line text-5xl text-gray-300 mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Product not found"}),e.jsx(m,{to:"/marketplace",className:"text-blue-600 hover:text-blue-700",children:"Back to marketplace"})]})]})}export{q as default};
//# sourceMappingURL=ProductDetail-RxoFo9Gj.js.map

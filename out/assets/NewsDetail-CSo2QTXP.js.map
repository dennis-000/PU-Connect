{"version":3,"file":"NewsDetail-CSo2QTXP.js","sources":["../../src/pages/news/NewsDetail.tsx"],"sourcesContent":["import { useState, useEffect } from 'react';\nimport { useParams, Link } from 'react-router-dom';\nimport { supabase } from '../../lib/supabase';\nimport Navbar from '../../components/feature/Navbar';\n\ntype NewsArticle = {\n  id: string;\n  title: string;\n  content: string;\n  category: string;\n  image_url?: string;\n  views_count: number;\n  created_at: string;\n};\n\nexport default function NewsDetail() {\n  const { id } = useParams();\n  const [article, setArticle] = useState<NewsArticle | null>(null);\n  const [relatedNews, setRelatedNews] = useState<NewsArticle[]>([]);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    if (id) {\n      fetchArticle();\n      incrementViews();\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [id]);\n\n  const fetchArticle = async () => {\n    if (!id) return;\n    \n    setLoading(true);\n    try {\n      const { data, error } = await supabase\n        .from('campus_news')\n        .select('*')\n        .eq('id', id)\n        .single<NewsArticle>();\n\n      if (error) {\n        console.error('Error fetching article:', error);\n        setArticle(null);\n      } else if (data) {\n        setArticle(data);\n        fetchRelatedNews(data.category);\n      }\n    } catch (err) {\n      console.error('Unexpected error:', err);\n      setArticle(null);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const fetchRelatedNews = async (category: string) => {\n    if (!id) return;\n    \n    try {\n      const { data, error } = await supabase\n        .from('campus_news')\n        .select('*')\n        .eq('category', category)\n        .neq('id', id)\n        .eq('status', 'published')\n        .order('created_at', { ascending: false })\n        .limit(3);\n\n      if (error) {\n        console.error('Error fetching related news:', error);\n      } else if (data) {\n        setRelatedNews(data);\n      }\n    } catch (err) {\n      console.error('Unexpected error fetching related news:', err);\n    }\n  };\n\n  const incrementViews = async () => {\n    if (!id) return;\n    \n    try {\n      await supabase.rpc('increment_news_views', { news_id: id });\n    } catch (err) {\n      console.error('Error incrementing views:', err);\n    }\n  };\n\n  const formatDate = (dateString: string) => {\n    const date = new Date(dateString);\n    return date.toLocaleDateString('en-US', { \n      year: 'numeric', \n      month: 'long', \n      day: 'numeric',\n      hour: '2-digit',\n      minute: '2-digit'\n    });\n  };\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-gray-50\">\n        <Navbar />\n        <div className=\"text-center py-20\">\n          <div className=\"inline-block w-10 h-10 border-4 border-gray-200 border-t-emerald-600 rounded-full animate-spin\"></div>\n          <p className=\"mt-4 text-gray-600\">Loading article...</p>\n        </div>\n      </div>\n    );\n  }\n\n  if (!article) {\n    return (\n      <div className=\"min-h-screen bg-gray-50\">\n        <Navbar />\n        <div className=\"text-center py-20\">\n          <i className=\"ri-file-damage-line text-5xl text-gray-300 mb-4\"></i>\n          <h3 className=\"text-lg font-semibold text-gray-900 mb-2\">Article not found</h3>\n          <Link to=\"/news\" className=\"text-emerald-600 hover:text-emerald-700\">\n            Back to news\n          </Link>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gray-50\">\n      <Navbar />\n\n      <div className=\"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\n        <div className=\"mb-6\">\n          <Link\n            to=\"/news\"\n            className=\"inline-flex items-center text-blue-600 hover:text-blue-700 font-semibold cursor-pointer\"\n          >\n            <i className=\"ri-arrow-left-line mr-2\"></i>\n            Back to News\n          </Link>\n        </div>\n\n        <article className=\"bg-white rounded-xl shadow-lg overflow-hidden\">\n          {article.image_url && (\n            <div className=\"relative h-96 w-full overflow-hidden\">\n              <img\n                src={article.image_url}\n                alt={article.title}\n                className=\"w-full h-full object-cover object-center\"\n              />\n            </div>\n          )}\n\n          <div className=\"p-8 md:p-12\">\n            <div className=\"flex items-center space-x-3 mb-6\">\n              <span className=\"px-4 py-2 bg-blue-100 text-blue-700 text-sm font-medium rounded-full\">\n                {article.category}\n              </span>\n              <span className=\"text-gray-500\">\n                {formatDate(article.created_at)}\n              </span>\n            </div>\n\n            <h1 className=\"text-3xl font-bold text-gray-900 mb-6\">\n              {article.title}\n            </h1>\n\n            <div className=\"prose prose-lg max-w-none\">\n              <p className=\"text-gray-700 leading-relaxed whitespace-pre-line\">\n                {article.content}\n              </p>\n            </div>\n\n            <div className=\"mt-8 pt-6 border-t border-gray-200\">\n              <div className=\"flex items-center justify-between\">\n                <div className=\"flex items-center space-x-4\">\n                  <button className=\"flex items-center space-x-2 text-gray-600 hover:text-emerald-600 transition-colors cursor-pointer\">\n                    <i className=\"ri-share-line text-lg\"></i>\n                    <span className=\"text-sm font-medium\">Share</span>\n                  </button>\n                </div>\n              </div>\n            </div>\n          </div>\n        </article>\n\n        {relatedNews.length > 0 && (\n          <div className=\"mt-12\">\n            <h2 className=\"text-2xl font-bold text-gray-900 mb-6\">Related News</h2>\n            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n              {relatedNews.map((news) => (\n                <Link\n                  key={news.id}\n                  to={`/news/${news.id}`}\n                  className=\"bg-white rounded-xl border border-gray-200 hover:border-emerald-300 hover:shadow-lg transition-all overflow-hidden\"\n                >\n                  <div className=\"h-40 bg-gray-100 relative overflow-hidden\">\n                    {news.image_url ? (\n                      <img\n                        src={news.image_url}\n                        alt={news.title}\n                        className=\"w-full h-full object-cover object-top\"\n                      />\n                    ) : (\n                      <div className=\"w-full h-full flex items-center justify-center\">\n                        <i className=\"ri-newspaper-line text-4xl text-gray-300\"></i>\n                      </div>\n                    )}\n                  </div>\n\n                  <div className=\"p-4\">\n                    <span className=\"px-2 py-1 bg-emerald-100 text-emerald-700 text-xs font-medium rounded-full\">\n                      {news.category}\n                    </span>\n                    <h3 className=\"text-base font-semibold text-gray-900 mt-3 line-clamp-2\">\n                      {news.title}\n                    </h3>\n                  </div>\n                </Link>\n              ))}\n            </div>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n"],"names":["NewsDetail","id","useParams","article","setArticle","useState","relatedNews","setRelatedNews","loading","setLoading","useEffect","fetchArticle","incrementViews","data","error","supabase","fetchRelatedNews","err","category","formatDate","dateString","jsxs","jsx","Navbar","Link","news"],"mappings":"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"}
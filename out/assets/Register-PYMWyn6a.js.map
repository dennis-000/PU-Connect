{"version":3,"file":"Register-PYMWyn6a.js","sources":["../../src/pages/auth/Register.tsx"],"sourcesContent":["import { useState } from 'react';\nimport { Link, useNavigate } from 'react-router-dom';\n\nexport default function Register() {\n  const navigate = useNavigate();\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState('');\n  const [formData, setFormData] = useState({\n    email: '',\n    password: '',\n    confirmPassword: '',\n    fullName: '',\n    studentId: '',\n    department: '',\n    faculty: '',\n    phone: '',\n  });\n  const [validationErrors, setValidationErrors] = useState({\n    email: '',\n    phone: '',\n  });\n\n  // Email validation function\n  const validateEmail = (email: string): boolean => {\n    const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n    if (!email) {\n      setValidationErrors(prev => ({ ...prev, email: '' }));\n      return true;\n    }\n    if (!emailRegex.test(email)) {\n      setValidationErrors(prev => ({ ...prev, email: 'Please enter a valid email address' }));\n      return false;\n    }\n    // Check for university email domain (optional - remove if not needed)\n    const universityDomains = ['pentu.edu.gh', 'pentvars.edu.gh'];\n    const domain = email.split('@')[1]?.toLowerCase();\n    if (domain && !universityDomains.includes(domain)) {\n      setValidationErrors(prev => ({ \n        ...prev, \n        email: 'Please use your university email address (@pentu.edu.gh or @pentvars.edu.gh)' \n      }));\n      return false;\n    }\n    setValidationErrors(prev => ({ ...prev, email: '' }));\n    return true;\n  };\n\n  // Phone number validation function\n  const validatePhone = (phone: string): boolean => {\n    if (!phone) {\n      setValidationErrors(prev => ({ ...prev, phone: '' }));\n      return true;\n    }\n    \n    // Remove all spaces, dashes, and parentheses\n    const cleanPhone = phone.replace(/[\\s\\-()]/g, '');\n    \n    // Ghana phone number validation\n    // Accepts: +233XXXXXXXXX, 233XXXXXXXXX, 0XXXXXXXXX (10 digits after 0)\n    const ghanaPhoneRegex = /^(\\+233|233|0)(2[0-9]|5[0-9]|3[0-9])[0-9]{7}$/;\n    \n    if (!ghanaPhoneRegex.test(cleanPhone)) {\n      setValidationErrors(prev => ({ \n        ...prev, \n        phone: 'Please enter a valid Ghana phone number (e.g., +233 XX XXX XXXX or 0XX XXX XXXX)' \n      }));\n      return false;\n    }\n    \n    setValidationErrors(prev => ({ ...prev, phone: '' }));\n    return true;\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setError('');\n\n    // Validate email and phone before submission\n    const isEmailValid = validateEmail(formData.email);\n    const isPhoneValid = validatePhone(formData.phone);\n\n    if (!isEmailValid || !isPhoneValid) {\n      setError('Please fix the validation errors before submitting');\n      return;\n    }\n\n    // Validation\n    if (formData.password !== formData.confirmPassword) {\n      setError('Passwords do not match');\n      return;\n    }\n\n    if (formData.password.length < 6) {\n      setError('Password must be at least 6 characters');\n      return;\n    }\n\n    // Validate full name\n    if (formData.fullName.trim().length < 3) {\n      setError('Please enter your full name (at least 3 characters)');\n      return;\n    }\n\n    setLoading(true);\n\n    try {\n      // Call the Edge Function to create user and profile\n      const anonKey = import.meta.env.VITE_PUBLIC_SUPABASE_ANON_KEY;\n      \n      const response = await fetch(\n        `${import.meta.env.VITE_PUBLIC_SUPABASE_URL}/functions/v1/register-user`,\n        {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json',\n            'Authorization': `Bearer ${anonKey}`,\n          },\n          body: JSON.stringify({\n            email: formData.email,\n            password: formData.password,\n            fullName: formData.fullName,\n            studentId: formData.studentId,\n            department: formData.department,\n            faculty: formData.faculty,\n            phone: formData.phone,\n          }),\n        }\n      );\n\n      const result = await response.json();\n\n      if (!result.success) {\n        throw new Error(result.error || 'Failed to create account');\n      }\n\n      // Success - navigate to login\n      alert('Account created successfully! Please log in with your credentials.');\n      navigate('/login');\n\n    } catch (err: any) {\n      console.error('Registration error:', err);\n      setError(err.message || 'Failed to create account. Please try again.');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-slate-50 via-gray-50 to-slate-100 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8\">\n      <div className=\"max-w-md w-full\">\n        <div className=\"text-center mb-8\">\n          <Link to=\"/\" className=\"inline-flex items-center space-x-2 mb-6\">\n            <div className=\"w-12 h-12 bg-gradient-to-br from-slate-700 to-slate-900 rounded-lg flex items-center justify-center\">\n              <i className=\"ri-store-3-line text-white text-2xl\"></i>\n            </div>\n            <span className=\"text-2xl font-bold text-slate-900\">PentU Market</span>\n          </Link>\n          <h2 className=\"text-3xl font-bold text-slate-900\">Create Account</h2>\n          <p className=\"mt-2 text-slate-600\">Join the campus marketplace</p>\n        </div>\n\n        <div className=\"bg-white rounded-2xl shadow-sm border border-slate-200 p-8\">\n          {error && (\n            <div className=\"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg flex items-start\">\n              <i className=\"ri-error-warning-line text-red-600 text-xl mr-3 mt-0.5\"></i>\n              <p className=\"text-sm text-red-600\">{error}</p>\n            </div>\n          )}\n\n          <form onSubmit={handleSubmit} className=\"space-y-6\">\n            <div>\n              <label htmlFor=\"fullName\" className=\"block text-sm font-medium text-slate-700 mb-2\">\n                Full Name\n              </label>\n              <input\n                id=\"fullName\"\n                type=\"text\"\n                required\n                value={formData.fullName}\n                onChange={(e) => setFormData({ ...formData, fullName: e.target.value })}\n                className=\"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-transparent transition-all\"\n                placeholder=\"John Doe\"\n              />\n            </div>\n\n            <div>\n              <label htmlFor=\"email\" className=\"block text-sm font-medium text-slate-700 mb-2\">\n                University Email\n              </label>\n              <input\n                id=\"email\"\n                type=\"email\"\n                required\n                value={formData.email}\n                onChange={(e) => setFormData({ ...formData, email: e.target.value })}\n                className={`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-transparent transition-all ${\n                  validationErrors.email ? 'border-red-500' : 'border-slate-300'\n                }`}\n                placeholder=\"your.email@pentu.edu\"\n              />\n              {validationErrors.email && (\n                <div className=\"mt-1 flex items-start space-x-1\">\n                  <i className=\"ri-error-warning-line text-red-500 text-sm mt-0.5\"></i>\n                  <p className=\"text-xs text-red-500\">{validationErrors.email}</p>\n                </div>\n              )}\n            </div>\n\n            <div>\n              <label htmlFor=\"phone\" className=\"block text-sm font-medium text-slate-700 mb-2\">\n                Phone Number\n              </label>\n              <input\n                id=\"phone\"\n                type=\"tel\"\n                required\n                value={formData.phone}\n                onChange={(e) => setFormData({ ...formData, phone: e.target.value })}\n                className={`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-transparent transition-all ${\n                  validationErrors.phone ? 'border-red-500' : 'border-slate-300'\n                }`}\n                placeholder=\"+233 XX XXX XXXX\"\n              />\n              {validationErrors.phone && (\n                <div className=\"mt-1 flex items-start space-x-1\">\n                  <i className=\"ri-error-warning-line text-red-500 text-sm mt-0.5\"></i>\n                  <p className=\"text-xs text-red-500\">{validationErrors.phone}</p>\n                </div>\n              )}\n            </div>\n\n            <div>\n              <label htmlFor=\"password\" className=\"block text-sm font-medium text-slate-700 mb-2\">\n                Password\n              </label>\n              <input\n                id=\"password\"\n                type=\"password\"\n                required\n                value={formData.password}\n                onChange={(e) => setFormData({ ...formData, password: e.target.value })}\n                className=\"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-transparent transition-all\"\n                placeholder=\"Create a strong password\"\n              />\n            </div>\n\n            <div>\n              <label htmlFor=\"confirmPassword\" className=\"block text-sm font-medium text-slate-700 mb-2\">\n                Confirm Password\n              </label>\n              <input\n                id=\"confirmPassword\"\n                type=\"password\"\n                required\n                value={formData.confirmPassword}\n                onChange={(e) => setFormData({ ...formData, confirmPassword: e.target.value })}\n                className=\"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-transparent transition-all\"\n                placeholder=\"Confirm your password\"\n              />\n            </div>\n\n            <button\n              type=\"submit\"\n              disabled={loading || !!validationErrors.email || !!validationErrors.phone}\n              className=\"w-full py-3 bg-slate-900 text-white rounded-lg hover:bg-slate-800 transition-all font-semibold disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center whitespace-nowrap\"\n            >\n              {loading ? (\n                <>\n                  <i className=\"ri-loader-4-line animate-spin mr-2\"></i>\n                  Creating account...\n                </>\n              ) : (\n                'Create Account'\n              )}\n            </button>\n          </form>\n\n          <div className=\"mt-6 text-center\">\n            <p className=\"text-sm text-slate-600\">\n              Already have an account?{' '}\n              <Link to=\"/login\" className=\"text-slate-900 hover:text-slate-700 font-semibold cursor-pointer\">\n                Sign in\n              </Link>\n            </p>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}"],"names":["Register","navigate","useNavigate","loading","setLoading","useState","error","setError","formData","setFormData","validationErrors","setValidationErrors","validateEmail","email","emailRegex","prev","universityDomains","domain","validatePhone","phone","cleanPhone","handleSubmit","e","isEmailValid","isPhoneValid","result","err","jsxs","Link","jsx","Fragment"],"mappings":"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"}